(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{1:function(e,t,n){"use strict";function r(e,t){return e+t}var a={}.hasOwnProperty;function i(e,t){return a.call(t,e)}function o(){return(o=Object.assign||function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return n.forEach(function(t){for(var n in t)i(n,t)&&(e[n]=t[n])}),e}).apply(void 0,arguments)}function c(e,t){var n;return(n=[]).concat.apply(n,t.map(e))}var s=Array.isArray;function u(e){return"object"===typeof e&&null!==e&&!s(e)}function d(e,t){return Object.keys(t).reduce(function(n,r){return n[r]=e(t[r]),n},{})}function l(e){return s(e)?e.map(l):u(e)?d(l,e):e}var p=function(e){for(var t=e,n=!1,r=!1,a=!1,i=0;i<t.length;i++){var o=t[i];n&&/[a-zA-Z]/.test(o)&&o.toUpperCase()===o?(t=t.slice(0,i)+"-"+t.slice(i),n=!1,a=r,r=!0,i++):r&&a&&/[a-zA-Z]/.test(o)&&o.toLowerCase()===o?(t=t.slice(0,i-1)+"-"+t.slice(i-1),a=r,r=!1,n=!0):(n=o.toLowerCase()===o,a=r,r=o.toUpperCase()===o)}return t};function f(e){var t=e.trim();return 0===t.length?"":1===t.length?t.toLowerCase():/^[a-z\d]+$/.test(t)?t:(t!==t.toLowerCase()&&(t=p(t)),t=t.replace(/^[_.\- ]+/,"").toLowerCase().replace(/[_.\- ]+(\w|$)/g,function(e,t){return t.toUpperCase()}))}function m(e){return s(e)?e.filter(function(e){return null!==e&&void 0!==e}):Object.keys(e).reduce(function(t,n){var r=e[n];return null!==r&&void 0!==r&&(t[n]=r),t},{})}function h(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce(function(e,t){return function(){return e(t.apply(void 0,arguments))}})}function v(e,t){var n;return function(){clearTimeout(n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];n=setTimeout.apply(void 0,[t,e].concat(a))}}function b(e){return null===e||void 0===e}function g(e){return function(t){return b(t)?e:t}}function _(e,t){return t.slice(0,-e)}function y(e){return s(e)?e:[e]}function j(e,t){for(var n=0;n<t.length;n++){var r=t[n];if(e(r))return r}}function O(e,t){for(var n=0;n<t.length;n++)if(e(t[n]))return n;return-1}function w(e,t){return j(function(n){return e(t[n])},Object.keys(t))}function x(e,t){for(var n=t.length-1;n>=0;n--)if(e(t[n]))return t[n]}function C(e,t,n){for(var r=t;r>=0;r--)if(e(n[r]))return r;return-1}function E(e,t){return C(e,t.length-1,t)}function I(e,t){for(var n=[];e--;)n.push(t);return n}function S(e){return e}function T(e,t){return Object.keys(t).forEach(function(n){e(t[n],n)})}function k(e){return e.reduce(function(e,t){var n=t[0],r=t[1];return e[n]=r,e},{})}function P(){return Math.random().toString(36).substring(2)}function A(e){var t=P();return i(t,e)?A(e):t}function N(e,t){for(var n="string"===typeof e?e.split("."):e,r=0,a=t;a&&r<n.length;)a=a[n[r++]];return a}function V(e,t,n){var r=N(t,n);return void 0!==r&&null!==r?r:e}function M(e,t){return Object.keys(t).reduce(function(n,r){var a=e(r);return n[a]=n[a]||{},n[a][r]=t[r],n},{})}function z(e,t){return-1!==t.indexOf(e)}function R(e){return 0===(s(e)?e:Object.keys(e)).length}function D(e,t){return t.reduce(function(t,n){return t[n[e]]=n,t},{})}function q(e){return e.length>0?e[e.length-1]:null}function L(e,t){return Object.keys(t).reduce(function(n,r){return n[e(r)]=t[r],n},{})}function F(e,t){return Object.keys(t).reduce(function(n,r){return n[r]=e(t[r],r),n},{})}function U(e,t){if(R(t))return e;var n={};return T(function(r,a){i(a,t)?u(e[a])&&u(t[a])?n[a]=U(e[a],t[a]):n[a]=t[a]:n[a]=e[a]},e),T(function(e,r){i(r,n)||(n[r]=t[r])},t),n}function B(e){if(0===e.length)return{};var t=e[0];return e.slice(1).reduce(function(e,t){return U(e,t)},t)}function G(e){return function(e,t){var n={};return function(){var r=e.apply(void 0,arguments);if(i(r,n))return n[r];var a=t.apply(void 0,arguments);return n[r]=a,a}}(S,e)}function H(e){var t,n,r=!1;return function(){return r&&(arguments.length<=0?void 0:arguments[0])===n?t:(r=!0,n=arguments.length<=0?void 0:arguments[0],t=e.apply(void 0,arguments))}}function W(){}function Y(e){return Object.keys(e).map(function(t){return e[t]})}function J(e,t){var n="function"===typeof e?e:function(t){return N(e,t)};return(s(t)?[].concat(t):Y(t)).sort(function(e,t){return n(e)-n(t)})}function Q(e,t){return Object.keys(t).reduce(function(n,r){return e(t[r],r)||(n[r]=t[r]),n},{})}function K(e,t){return Q(function(t,n){return-1!==e.indexOf(n)},t)}function X(e,t){return Object.keys(t).reduce(function(n,r){return e(t[r])||(n[r]=t[r]),n},{})}function Z(e){var t,n=!1;return function(){return n?t:(n=!0,t=e.apply(void 0,arguments))}}function $(e,t){return e.reduce(function(e,n){return e[n]=t[n],e},{})}function ee(e,t){return Object.keys(t).reduce(function(n,r){return e(t[r])&&(n[r]=t[r]),n},{})}function te(e,t){return Object.keys(t).reduce(function(n,r){return e(t[r],r)&&(n[r]=t[r]),n},{})}function ne(e,t){return e.reduce(function(e,n){return i(n,t)&&(e[n]=t[n]),e},{})}function re(e){for(var t=[],n=0;n<=e;)t.push(n++);return t}function ae(e,t){return t.filter(function(t){return!e(t)})}function ie(e,t){var n=[].concat(t);return n.splice(e,1),n}var oe=n(3);function ce(e,t,n){var r,a=e.split?e.split("."):e,o=a[0],c=t;if(a.length>1){var s=null!=n&&i(o,n)?n[o]:{};c=ce(a.slice(1),t,s)}return Object(oe.a)({},n,((r={})[o]=c,r))}function se(e,t){return e===t?0!==e||0!==t||1/e===1/t:e!==e&&t!==t}function ue(e,t){if(se(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(var a=0;a<n.length;a++)if(!i(n[a],t)||!se(e[n[a]],t[n[a]]))return!1;return!0}function de(e,t){return[t.slice(0,e),t.slice(e,t.length)]}function le(e,t,n){for(var r=!1,a=n.length;a>0;a--){var i=e(n[a-1],t);if(r=i[0],t=i[1],r)return de(a-1,n)}return[[],n]}function pe(e){return e.reduce(r,0)}function fe(e,t,n){var r=C(function(t){return!e(t)},t,n);return r===t?[]:n.slice(r+1,t+1)}function me(e,t){var n,r=Date.now()-2*e,a=function(){r=Date.now(),t.apply(void 0,arguments)};return function(){for(var t=Date.now(),i=arguments.length,o=new Array(i),c=0;c<i;c++)o[c]=arguments[c];t-r>=e?a.apply(void 0,o):(clearTimeout(n),n=setTimeout.apply(void 0,[a,r-t+e].concat(o)))}}function he(e){return Object.keys(e).map(function(t){return[t,e[t]]})}function ve(e,t){var n,r=Date.now()-2*e,a=function(){return r=Date.now(),t.apply(void 0,arguments)};return function(){var t=Date.now();t-r>=e&&(r=Date.now()),clearTimeout(n);for(var i=arguments.length,o=new Array(i),c=0;c<i;c++)o[c]=arguments[c];n=setTimeout.apply(void 0,[a,r-t+e].concat(o))}}var be=/^\s+/;function ge(e){return e.replace(be,"")}var _e=/\s+$/;function ye(e){return e.replace(_e,"")}function je(e,t){var n=[];return t.filter(function(t){var r=e(t);return-1===n.indexOf(r)&&(n.push(r),!0)})}function Oe(e,t,n){return[].concat(n.slice(0,e),[t],n.slice(e+1,n.length))}function we(e,t,n){return t.map(function(t,r){return e(t,n[r])})}n.d(t,"a",function(){return o}),n.d(t,"c",function(){return l}),n.d(t,"b",function(){return f}),n.d(t,"d",function(){return m}),n.d(t,"e",function(){return h}),n.d(t,"f",function(){return v}),n.d(t,"g",function(){return g}),n.d(t,"h",function(){return _}),n.d(t,"i",function(){return y}),n.d(t,"k",function(){return j}),n.d(t,"l",function(){return O}),n.d(t,"m",function(){return w}),n.d(t,"n",function(){return x}),n.d(t,"o",function(){return E}),n.d(t,"j",function(){return I}),n.d(t,"p",function(){return c}),n.d(t,"q",function(){return T}),n.d(t,"r",function(){return k}),n.d(t,"s",function(){return P}),n.d(t,"t",function(){return A}),n.d(t,"u",function(){return N}),n.d(t,"v",function(){return V}),n.d(t,"w",function(){return M}),n.d(t,"x",function(){return i}),n.d(t,"y",function(){return S}),n.d(t,"z",function(){return z}),n.d(t,"A",function(){return s}),n.d(t,"B",function(){return R}),n.d(t,"C",function(){return b}),n.d(t,"D",function(){return u}),n.d(t,"E",function(){return D}),n.d(t,"F",function(){return q}),n.d(t,"G",function(){return L}),n.d(t,"H",function(){return d}),n.d(t,"I",function(){return F}),n.d(t,"L",function(){return U}),n.d(t,"M",function(){return B}),n.d(t,"J",function(){return G}),n.d(t,"K",function(){return H}),n.d(t,"N",function(){return W}),n.d(t,"O",function(){return J}),n.d(t,"P",function(){return K}),n.d(t,"Q",function(){return X}),n.d(t,"R",function(){return Q}),n.d(t,"S",function(){return Z}),n.d(t,"T",function(){return $}),n.d(t,"U",function(){return ee}),n.d(t,"V",function(){return te}),n.d(t,"W",function(){return ne}),n.d(t,"X",function(){return re}),n.d(t,"Y",function(){return ae}),n.d(t,"Z",function(){return ie}),n.d(t,"ab",function(){return ce}),n.d(t,"bb",function(){return ue}),n.d(t,"cb",function(){return de}),n.d(t,"db",function(){return le}),n.d(t,"eb",function(){return pe}),n.d(t,"fb",function(){return fe}),n.d(t,"gb",function(){return me}),n.d(t,"hb",function(){return he}),n.d(t,"ib",function(){return ve}),n.d(t,"kb",function(){return ge}),n.d(t,"jb",function(){return ye}),n.d(t,"lb",function(){return je}),n.d(t,"mb",function(){return Oe}),n.d(t,"nb",function(){return Y}),n.d(t,"ob",function(){return we})},117:function(e,t,n){e.exports=n.p+"static/media/1520_avatars.20ae5805.png"},185:function(e,t,n){e.exports=n.p+"static/media/new_message.f7609395.mp3"},186:function(e,t,n){e.exports=n.p+"static/media/new_message.c002eb29.ogg"},191:function(e,t,n){e.exports=n.p+"static/media/1520_avatars@2x.056f0352.png"},277:function(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"getView",function(){return Y}),n.d(r,"getDefaultView",function(){return J}),n.d(r,"getCurrentView",function(){return Q}),n.d(r,"getConnectionState",function(){return K}),n.d(r,"getEvent",function(){return $}),n.d(r,"getEventByServerId",function(){return ee}),n.d(r,"hasEvent",function(){return te}),n.d(r,"hasEventByServerId",function(){return ne}),n.d(r,"getIndexedEvents",function(){return re}),n.d(r,"getEvents",function(){return ae}),n.d(r,"getChat",function(){return ie}),n.d(r,"getChatByServerId",function(){return oe}),n.d(r,"hasChat",function(){return ce}),n.d(r,"getChats",function(){return se}),n.d(r,"getUsers",function(){return ue}),n.d(r,"getSessionId",function(){return de}),n.d(r,"getSessionUser",function(){return le}),n.d(r,"getUser",function(){return pe}),n.d(r,"hasUser",function(){return fe}),n.d(r,"getTimeline",function(){return me}),n.d(r,"getChatList",function(){return he}),n.d(r,"getSessionUserId",function(){return ve}),n.d(r,"getLastDeliveredEvent",function(){return be}),n.d(r,"getLastSeenEvent",function(){return ge}),n.d(r,"getLastEvent",function(){return _e}),n.d(r,"getUnseenCount",function(){return ye}),n.d(r,"getParticipants",function(){return je}),n.d(r,"localize",function(){return Oe}),n.d(r,"getApplicationState",function(){return we});var a={};n.r(a),n.d(a,"CONNECTED",function(){return xe}),n.d(a,"DISCONNECTED",function(){return Ce}),n.d(a,"NOT_CONNECTED",function(){return Ee}),n.d(a,"RECONNECTING",function(){return Ie});var i={};n.r(i),n.d(i,"addView",function(){return Pe}),n.d(i,"setCurrentView",function(){return Ae}),n.d(i,"updateView",function(){return Ne}),n.d(i,"setDefaultView",function(){return Ve}),n.d(i,"addChat",function(){return Me}),n.d(i,"addEvent",function(){return ze}),n.d(i,"addParticipant",function(){return Re}),n.d(i,"addUser",function(){return De}),n.d(i,"flushChat",function(){return qe}),n.d(i,"recalculateTimeline",function(){return Le}),n.d(i,"removeParticipant",function(){return Fe}),n.d(i,"sendEvent",function(){return Ue}),n.d(i,"setApplicationState",function(){return Be}),n.d(i,"updateFeature",function(){return Ge}),n.d(i,"setConnectionState",function(){return He}),n.d(i,"setChatServerId",function(){return We}),n.d(i,"setEventData",function(){return Ye}),n.d(i,"setEventServerId",function(){return Je}),n.d(i,"setLocalization",function(){return Qe}),n.d(i,"setSessionUserId",function(){return Ke}),n.d(i,"setUserProperties",function(){return Ze}),n.d(i,"requestSetUserProperties",function(){return $e}),n.d(i,"updateChat",function(){return tt}),n.d(i,"requestUpdateChat",function(){return nt}),n.d(i,"updateEvent",function(){return at}),n.d(i,"requestUpdateEvent",function(){return it}),n.d(i,"updateUser",function(){return ct}),n.d(i,"requestUpdateUser",function(){return st});var o={};n.r(o),n.d(o,"chatStarted",function(){return Aa}),n.d(o,"newMessage",function(){return Na}),n.d(o,"chatEnded",function(){return Va}),n.d(o,"newAgent",function(){return Ma}),n.d(o,"visitorDataSet",function(){return za}),n.d(o,"visitorDataSetError",function(){return Ra}),n.d(o,"newFile",function(){return Da}),n.d(o,"visitorQueued",function(){return qa}),n.d(o,"typingIndicator",function(){return La}),n.d(o,"rateChat",function(){return Fa}),n.d(o,"setVisitorData",function(){return Ua}),n.d(o,"sendFile",function(){return Ba}),n.d(o,"requestFileToken",function(){return Ga}),n.d(o,"fileTokenReceived",function(){return Ha}),n.d(o,"newInvitation",function(){return Wa}),n.d(o,"messageSeen",function(){return Ya}),n.d(o,"protocolUpgraded",function(){return Ja}),n.d(o,"integrationData",function(){return Qa});var c=function(){window.performance&&"function"===typeof window.performance.mark&&window.performance.mark("lc_js_loaded")};c();var s=n(115),u=n.n(s);/native code/.test(window.Promise)||(window.Promise=u.a),"function"!==typeof window.Promise.prototype.finally&&(window.Promise.prototype.finally=u.a.prototype.finally);var d=n(3),l=n(8),p=n(42),f=n(1),m=function(e){return Object(f.hb)(e).map(function(e){return e.map(encodeURIComponent).join("=")}).join("&")},h=function(e){return Object(f.r)(e.split("&").map(function(e){return e.split("=").map(decodeURIComponent)}))};var v=/[^:]+:\/\/[^(\/|\?)\s]+/,b=function(e){var t=e.match(v);return t&&t[0]},g=/.*\?(.+)/,_=function(e){var t=function(e){return e.replace(/^\?/,"")}(function(e){var t=e.match(g);return t?"?"+t[1]:""}(e));return h(t||e)},y=function(e,t){return _(t)[e]},j=/^((http(s)?\:)?\/\/)/,O=function(e){return e.replace(j,"")},w=/sendURLToGuardwareProxy/i;var x=function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];return function(e,t){var n=JSON.stringify(t);if(!w.test(n)){var r={licence_id:y("license",window.location.search),event_id:e,message:n};return Object(p.a)("https://queue.livechatinc.com/logs",{method:"POST",mode:"no-cors",headers:{Accept:"*/*","Content-Type":"application/x-www-form-urlencoded"},body:m(r)}).catch(f.N)}}("chat_widget_"+e,(t instanceof Error?["err",t.message,"stack",t.stack]:["err",JSON.stringify(t)]).concat("ua: "+navigator.userAgent,r).join("\n"))};window.addEventListener("error",function(e){var t=e.error;t&&x("onerror",t)}),window.addEventListener("unhandledrejection",function(e){null!=e&&null!=e.reason&&x("unhandledrejection",e.reason)});n(194),n(212),n(214),n(219),n(225);var C=n(73),E=n.n(C);Object.assign=E.a,"function"!==typeof Array.prototype.find&&(Array.prototype.find=function(e){return Object(f.k)(e,this)});var I=n(21),S=n(180),T=function(){var e={},t=Object(S.a)(e);return Object(d.a)({},t,{off:function(n,r){n?t.off(n,r):Object.keys(e).forEach(function(t){delete e[t]})},once:function(e,n){t.on(e,function r(a,i){t.off(e,r),n(a,i)})}})},k=n(13),P=function(e,t){var n=function n(){var r=t.apply(void 0,arguments);return"function"===typeof r?n:{type:e,payload:r}};return n.getActionName=function(){return e},n.toString=function(){return e},n},A=function(e,t){var n=function(n){var r=Object.create(n);r.action=function(t,r){var a={type:e,payload:t};r&&(a.meta=r),n.dispatch(a)};for(var a=arguments.length,i=new Array(a>1?a-1:0),o=1;o<a;o++)i[o-1]=arguments[o];return t.apply(void 0,[r].concat(i))};return n.toString=function(){return e},n},N=function(e,t){var n="REQUEST_"+e,r=A(e,t),a=function(e){for(var a=arguments.length,i=new Array(a>1?a-1:0),o=1;o<a;o++)i[o-1]=arguments[o];var c,s=Object.create(e);if(s.action=function(t){var a=Object(k.a)(),o=a.promise,s=a.resolve,u=a.reject;e.dispatch({type:n,payload:Object(d.a)({},t,{resolve:s,reject:u})}),c=o.then(function(){r.apply(void 0,[e].concat(i))})},t.apply(void 0,[s].concat(i)),"undefined"===typeof c)throw new Error("You forgot to call `action` handler in "+n+" creator.");return c};return a.toString=function(){return n},{actionMethod:r,requestActionMethod:a}},V=function(e,t){if("object"!==typeof e||null===e||Array.isArray(e))throw new Error("bindActionMethods expects a plain object with actionMethods as values.");return Object(f.H)(function(e){return function(e,t){return function(){for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return e.apply(void 0,[t].concat(r))}}(e,t)},e)},M=function(e,t){return t[void 0]&&console.warn(["Reducer contains an 'undefined' action type.","Have you misspelled a constant?"].join("\n")),function(n,r){return void 0===n&&(n=e),t.hasOwnProperty(r.type)?t[r.type](n,r.payload):n}};var z=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},R=function(e){var t;return(t={})["SET_PROPERTY_"+e.toUpperCase()]=function(t,n){var r;return Object(d.a)({},t,((r={})[e]=n.data,r))},t["REMOVE_PROPERTY_"+e.toUpperCase()]=function(t){return Object(d.a)({},Object(f.P)([e],t))},t},D=function(e){var t;return(t={})["getProperty"+z(e)]=function(t){return t[e]},t},q=function(e){var t;return(t={})["setProperty"+z(e)]=P("SET_PROPERTY_"+e.toUpperCase(),function(e){return{data:e}}),t["removeProperty"+z(e)]=P("REMOVE_PROPERTY_"+e.toUpperCase(),function(){return{propName:e}}),t},L=function(e,t){if("object"!==typeof e||null===e||Array.isArray(e))throw new Error("bindSelectors expects a plain object with selectors as values.");return Object(f.H)(function(e){return function(e,t){return function(){for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return e.apply(void 0,[t()].concat(r))}}(e,t)},e)},F=function(){var e=[],t=function(t){return function(n){return function(r){var a=n(r);return e.forEach(function(e){e(r,t)}),a}}};return t.add=function(t){e.push(t)},t},U=function(e){var t=e.id,n=e.serverId,r=void 0===n?null:n,a=e.active,i=void 0===a||a,o=e.participants,c=void 0===o?[]:o,s=e.properties,u=void 0===s?{}:s;if("string"!==typeof t)throw new Error("Chat ID has to be a string.");if(null!==r&&t!==r)throw new Error('If serverId is given ("'+r+'") it should match id ("'+t+'").');return{id:t,serverId:r,active:i,participants:c,properties:u}},B=function(e){var t=e.id,n=e.serverId,r=void 0===n?null:n,a=e.type,i=e.author,o=e.timestamp,c=e.own,s=e.delivered,u=void 0===s||s,d=e.seen,l=void 0!==d&&d,p=e.failed,f=void 0!==p&&p,m=e.properties,h=void 0===m?{}:m;if("string"!==typeof t)throw new Error("Event ID has to be a string.");if("string"!==typeof a)throw new Error("Event has to have string `type` property.");if(null!==r&&t!==r)throw new Error('If serverId is given ("'+r+'") it should match id ("'+t+'").');return{id:t,serverId:r,type:a,author:i,own:c,timestamp:o,delivered:u,seen:l,failed:f,properties:h}},G=function(e){var t=e.id,n=e.type,r=void 0===n?null:n,a=e.name,i=void 0===a?null:a,o=e.email,c=void 0===o?null:o,s=e.avatar,u=void 0===s?null:s,d=e.properties,l=void 0===d?{}:d;if("string"!==typeof t)throw new Error("User ID has to be a string.");return{id:t,type:r,name:i,email:c,avatar:u,properties:l}},H=n(44),W=function(e,t){return t},Y=function(e,t){var n=t.replace(/\//gi,".");return Object(f.u)(n,e.views)},J=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return Object(f.u)(n+"._default",e.views)},Q=function(e){return e.views.current},K=function(e){return e.session.connectionState},X=function(e){return e.entities.chats.byIds},Z=function(e,t){return X(e)[t]},$=function(e,t,n){return Z(e,t).events.byIds[n]},ee=function(e,t,n){return $(e,t,Z(e,t).events.serverIdsMapping[n])},te=function(e,t,n){return!!$(e,t,n)},ne=function(e,t,n){return!!ee(e,t,n)},re=function(e,t){return Z(e,t).events.byIds},ae=Object(H.a)([function(e,t){return Z(e,t).events.orderedIds},re],function(e,t){return e.map(function(e){return t[e]})})(W),ie=Object(H.a)([Z,ae],function(e,t){return Object(d.a)({},e,{events:t})})(W),oe=function(e,t){return ie(e,e.entities.chats.serverIdsMapping[t])},ce=function(e,t){return!!Z(e,t)},se=function(e){return Object(f.H)(function(t){var n=t.id;return ie(e,n)},X(e))},ue=function(e){return e.entities.users.byIds},de=function(e){return e.session.id},le=function(e){return ue(e)[de(e)]},pe=function(e,t){return t===e.session.user?le(e):ue(e)[t]},fe=function(e,t){return!!pe(e,t)},me=function(e,t){return e.views.Chat[t].timeline},he=function(e){return e.views.ChatList},ve=function(e){return le(e).id},be=Object(H.a)([ae,ve],function(e,t){return Object(f.n)(function(e){var n=e.delivered,r=e.author;return n&&r===t},e)})(W),ge=Object(H.a)([ae,ve],function(e,t){return Object(f.n)(function(e){var n=e.seen,r=e.author;return n&&r===t},e)})(W),_e=function(e,t){return Object(f.F)(ae(e,t))},ye=function(e,t){var n=ae(e,t),r=le(e).id,a=Object(f.o)(function(e){return e.author===r||!0===e.seen},n);return n.length-(a+1)},je=Object(H.a)([function(e,t){return Z(e,t).participants},ue],function(e,t){return e.map(function(e){return t[e]})})(W),Oe=function(e,t,n){var r=e.localization[t];return n?Object.keys(n).reduce(function(e,t){return e.replace(new RegExp("%"+t+"%","g"),n[t])},r):r},we=function(e,t){return void 0===t?e.application:e.application[t]},xe="connected",Ce="disconnected",Ee="not_connected",Ie="reconnecting",Se=function(e){if(!Object(f.z)(e,Object(f.nb)(a)))throw new Error(['"'+e+'" is not a valid connection state.',"Please use on of the following: "+Object(f.nb)(a).join(", ")+"."].join(" "))},Te=["delivered","seen","failed","properties"],ke=function(e,t){return e.forEach(function(e){if(Object(f.x)(e,t))throw new Error("Updating `"+e+"` property is not possible.")})},Pe=A("ADD_VIEW",function(e,t,n){var r=e.action,a=e.getState;if(void 0===n&&(n={}),Y(a(),t))throw new Error('There is already the "'+t+'" view. It has to be unique.');return r({name:t,data:n}),Y(a(),t)}),Ae=A("SET_CURRENT_VIEW",function(e,t){var n=e.action,r=e.getState;if(!Y(r(),t))throw new Error('Given view "'+t+"\" doesn't exist.");return n({name:t}),Q(r())}),Ne=A("UPDATE_VIEW",function(e,t,n){var r=e.action,a=e.getState;if(!Y(a(),t))throw new Error('There is no "'+t+'" view. You should add it first.');return r({name:t,data:n}),Y(a(),t)}),Ve=A("SET_DEFAULT_VIEW",function(e,t,n){var r=e.action,a=e.getState;return r({name:n,path:t}),Y(a(),t+"/"+n)}),Me=A("ADD_CHAT",function(e,t){var n=e.action,r=e.getState,a=void 0===t?{}:t,i=a.events,o=void 0===i?[]:i,c=Object(l.a)(a,["events"]);if(ce(r(),c.id))throw new Error('There is already a chat with "'+c.id+'" ID. It has to be unique.');var s=Object(f.k)(function(e){return!fe(r(),e)},o.map(function(e){return e.author}).concat(c.participants||[]));if(s)throw new Error('Given user ("'+s+"\") doesn't exist. You should add it first.");var u=c.id||Object(f.t)(se(r()));return n({id:u,chat:U(Object(d.a)({},c,{id:u})),events:o.map(B)}),ie(r(),u)}),ze=A("ADD_EVENT",function(e,t,n){var r=e.action,a=e.getState,i=n.id,o=a();if(!ce(o,t))throw new Error('There is no chat with "'+t+'" ID. You should add it first.');if(te(o,t,i))throw new Error('There is already an event with "'+i+'" ID in this chat ("'+t+'"). It has to be unique.');if(!fe(o,n.author))throw new Error('Specified author ("'+n.author+"\") doesn't exist. You should add it first.");return r({id:i,chat:t,event:B(Object(d.a)({timestamp:Date.now()},n,{serverId:i,own:n.author===ve(o)}))}),$(a(),t,i)}),Re=A("ADD_PARTICIPANT",function(e,t,n){var r=e.action,a=e.getState;if(!ce(a(),t))throw new Error('There is no chat with "'+t+'" ID. You should add it first.');if(!fe(a(),n))throw new Error('Given user ("'+n+"\") doesn't exist. You should add it first.");return r({chat:t,user:n}),je(a(),t)}),De=A("ADD_USER",function(e,t){var n=e.action,r=e.getState,a=t.id;if(fe(r(),a))throw new Error('There is already a user with "'+a+'" ID. It has to be unique.');return n({id:a,user:G(t)}),pe(r(),a)}),qe=A("FLUSH_CHAT",function(e,t){var n=e.action,r=e.getState;if(!ce(r(),t))throw new Error('There is no chat with "'+t+'" ID. You should add it first.');return n({id:t}),ie(r(),t)}),Le=A("RECALCULATE_TIMELINE",function(e,t){var n=e.action,r=e.getState;if(!ce(r(),t))throw new Error('There is no chat with "'+t+'" ID. You should add it first.');return n({id:t}),me(r(),t)}),Fe=A("REMOVE_PARTICIPANT",function(e,t,n){var r=e.action,a=e.getState;if(!ce(a(),t))throw new Error('There is no chat with "'+t+'" ID. You should add it first.');if(!fe(a(),n))throw new Error('Given user ("'+n+"\") doesn't exist. You should add it first.");return r({chat:t,user:n}),je(a(),t)}),Ue=A("SEND_EVENT",function(e,t,n,r){var a=e.action,i=e.getState;if(!ce(i(),t))throw new Error('There is no chat with "'+t+'" ID. You should add it first.');if(te(i(),t,n.id))throw new Error('There is already an event with "'+n.id+'" ID in this chat ("'+t+'"). It has to be unique.');var o=n.id||Object(f.t)(re(i(),t));return a({id:o,chat:t,event:B(Object(d.a)({},n,{author:le(i()).id,own:!0,id:o,timestamp:Date.now(),delivered:!1}))},r),$(i(),t,o)}),Be=A("SET_APPLICATION_STATE",function(e,t){var n=e.action,r=e.getApplicationState;if(!t||Object(f.B)(t))throw new Error("Given data object is empty.");return n(t),r()}),Ge=A("UPDATE_FEATURE",function(e,t,n){var r=e.action,a=e.getApplicationState;if(!n||!t||Object(f.B)(n))throw new Error("Given data object is empty.");return r({feature:t,data:n}),a()}),He=A("SET_CONNECTION_STATE",function(e,t){var n=e.action,r=e.getState;return Se(t),n({connectionState:t}),K(r())}),We=A("SET_CHAT_SERVER_ID",function(e,t,n){var r=e.action,a=e.getState;if(!ce(a(),t))throw new Error('There is no chat with "'+t+'" ID. You should add it first.');if(null!==ie(a(),t).serverId)throw new Error('Chat with "'+t+'" ID has already serverId.');return r({id:t,serverId:n}),ie(a(),t)}),Ye=A("SET_EVENT_DATA",function(e,t,n,r){var a=e.action,i=e.getState;if(!ce(i(),t))throw new Error('There is no chat with "'+t+'" ID. You should add it first.');if(!te(i(),t,n))throw new Error('There is no "'+n+'" event in "'+t+'" chat. You should add it first.');return ke(["id","type","own"],r),a({chat:t,id:n,data:Object(d.a)({},Object(f.W)(Te.concat("author","serverId","timestamp"),r),{own:r.author===ve(i())})}),$(i(),t,n)}),Je=A("SET_EVENT_SERVER_ID",function(e,t,n,r){var a=e.action,i=e.getState;if(!ce(i(),t))throw new Error('There is no chat with "'+t+'" ID. You should add it first.');if(!te(i(),t,n))throw new Error('There is no "'+n+'" event in "'+t+'" chat. You should add it first.');if(null!==$(i(),t,n).serverId)throw new Error('Event with "'+n+'" ID has already serverId.');return a({chat:t,id:n,serverId:r}),$(i(),t,n)}),Qe=A("SET_LOCALIZATION",function(e,t){(0,e.action)(t)}),Ke=A("SET_SESSION_USER_ID",function(e,t){var n=e.action,r=e.getState;if(fe(r(),t))throw new Error('There is already a user with "'+t+'" ID. It has to be unique.');return n({id:t,session:de(r())}),le(r())}),Xe=N("SET_USER_PROPERTIES",function(e,t,n){var r=e.action,a=e.getState;if(!fe(a(),t))throw new Error('There is no user with "'+t+'" ID. You should add it first.');return r({id:a().session.user===t?de(a()):t,properties:n}),pe(a(),t)}),Ze=Xe.actionMethod,$e=Xe.requestActionMethod,et=N("UPDATE_CHAT",function(e,t,n){var r=e.action,a=e.getState;if(!ce(a(),t))throw new Error('There is no chat with "'+t+'" ID. You should add it first.');return ke(["id","participants","events"],n),r({id:t,data:Object(f.W)(["active","properties"],n)}),ie(a(),t)}),tt=et.actionMethod,nt=et.requestActionMethod,rt=N("UPDATE_EVENT",function(e,t,n,r){var a=e.action,i=e.getState;if(!ce(i(),t))throw new Error('There is no chat with "'+t+'" ID. You should add it first.');if(!te(i(),t,n))throw new Error('There is no "'+n+'" event in "'+t+'" chat. You should add it first.');return ke(["id","type","author","own","timestamp"],r),a({chat:t,id:n,data:Object(f.W)(Te,r)}),$(i(),t,n)}),at=rt.actionMethod,it=rt.requestActionMethod,ot=N("UPDATE_USER",function(e,t,n){var r=e.action,a=e.getState;if(!fe(a(),t))throw new Error('There is no user with "'+t+'" ID. You should add it first.');return ke(["id","type"],n),r({id:a().session.user===t?de(a()):t,data:Object(f.W)(["name","email","avatar","properties"],n)}),pe(a(),t)}),ct=ot.actionMethod,st=ot.requestActionMethod,ut=function(e){var t;return void 0===e&&(e={}),M(e,((t={})[Ge]=function(e,t){var n,r=t.feature,a=t.data;return Object(d.a)({},e,{config:Object(d.a)({},e.config,{features:Object(d.a)({},e.config.features,(n={},n[r]=Object(d.a)({},e.config.features[r],a),n))})})},t[Be]=function(e,t){return Object(d.a)({},e,t)},t))},dt=function(e,t){var n;return null!==t.serverId?Object(d.a)({},e,((n={})[t.serverId]=t.id,n)):e},lt=function(e,t){var n,r,a=t.id,i=t.chat,o=t.event;return Object(d.a)({},e,{chats:Object(d.a)({},e.chats,{byIds:Object(d.a)({},e.chats.byIds,(r={},r[i]=Object(d.a)({},e.chats.byIds[i],{events:{byIds:Object(d.a)({},e.chats.byIds[i].events.byIds,(n={},n[a]=o,n)),orderedIds:e.chats.byIds[i].events.orderedIds.concat(a),serverIdsMapping:dt(e.chats.byIds[i].events.serverIdsMapping,o)}}),r))})})},pt=function(e,t,n){var r,a=n.properties,i=Object(l.a)(n,["properties"]),o=e.byIds[t];return Object(d.a)({},e,{byIds:Object(d.a)({},e.byIds,(r={},r[t]=Object(d.a)({},o,i,{properties:a?Object(d.a)({},o.properties,a):o.properties}),r))})},ft=function(e,t,n){var r,a,i=e.byIds[t],o={byIds:Object(d.a)({},e.byIds,(r={},r[t]=Object(d.a)({},i,n),r))};n.serverId&&Object(f.x)("serverIdsMapping",e)&&(o.serverIdsMapping=Object(d.a)({},e.serverIdsMapping,((a={})[n.serverId]=t,a)));return Object(d.a)({},e,o)},mt=function(e){var t,n=(void 0===e?{}:e).users,r=void 0===n?[]:n;return M({users:{byIds:Object(f.E)("id",[{id:"system",type:"system"}].concat(r.map(G)))},chats:{byIds:{},serverIdsMapping:{}}},((t={})[Me]=function(e,t){var n,r,a=t.id,i=t.chat,o=t.events;return Object(d.a)({},e,{chats:Object(d.a)({},e.chats,{byIds:Object(d.a)({},e.chats.byIds,(n={},n[a]=Object(d.a)({},i,{events:{byIds:Object(f.E)("id",o),orderedIds:o.map(function(e){return e.id}),serverIdsMapping:(r=o,Object(f.nb)(r).reduce(function(e,t){var n=t.serverId,r=t.id;return null===n?e:(e[n]=r,e)},{}))}}),n)),serverIdsMapping:dt(e.chats.serverIdsMapping,i)})})},t[ze]=lt,t[Re]=function(e,t){var n,r=t.chat,a=t.user,i=e.chats.byIds[r].participants;return Object(f.l)(function(e){return a===e},i)>-1?e:Object(d.a)({},e,{chats:Object(d.a)({},e.chats,{byIds:Object(d.a)({},e.chats.byIds,(n={},n[r]=Object(d.a)({},e.chats.byIds[r],{participants:[].concat(i,[a])}),n))})})},t[De]=function(e,t){var n,r=t.id,a=t.user;return Object(d.a)({},e,{users:Object(d.a)({},e.users,{byIds:Object(d.a)({},e.users.byIds,(n={},n[r]=a,n))})})},t[qe]=function(e,t){var n,r=t.id;return Object(d.a)({},e,{chats:Object(d.a)({},e.chats,{byIds:Object(d.a)({},e.chats.byIds,(n={},n[r]=Object(d.a)({},e.chats.byIds[r],{serverId:null,events:{byIds:{},orderedIds:[],serverIdsMapping:{}},properties:{}}),n))})})},t[Fe]=function(e,t){var n,r=t.chat,a=t.user,i=e.chats.byIds[r].participants,o=Object(f.l)(function(e){return a===e},i);return-1===o?e:Object(d.a)({},e,{chats:Object(d.a)({},e.chats,{byIds:Object(d.a)({},e.chats.byIds,(n={},n[r]=Object(d.a)({},e.chats.byIds[r],{participants:Object(f.Z)(o,i)}),n))})})},t[Ue]=lt,t[We]=function(e,t){var n,r=t.id,a=t.serverId;return Object(d.a)({},e,{chats:Object(d.a)({},pt(e.chats,r,{serverId:a}),{serverIdsMapping:Object(d.a)({},e.chats.serverIdsMapping,(n={},n[a]=r,n))})})},t[Je]=function(e,t){var n,r,a=t.id,i=t.chat,o=t.serverId;return Object(d.a)({},e,{chats:Object(d.a)({},e.chats,{byIds:Object(d.a)({},e.chats.byIds,(r={},r[i]=Object(d.a)({},e.chats.byIds[i],{events:Object(d.a)({},pt(e.chats.byIds[i].events,a,{serverId:o}),{serverIdsMapping:Object(d.a)({},e.chats.byIds[i].events.serverIdsMapping,(n={},n[o]=a,n))})}),r))})})},t[Ye]=function(e,t){var n,r=t.id,a=t.chat,i=t.data;return Object(d.a)({},e,{chats:Object(d.a)({},e.chats,{byIds:Object(d.a)({},e.chats.byIds,(n={},n[a]=Object(d.a)({},e.chats.byIds[a],{events:ft(e.chats.byIds[a].events,r,i)}),n))})})},t[Ke]=function(e,t){var n,r=t.id,a=t.session;return Object(d.a)({},e,{users:Object(d.a)({},e.users,{byIds:Object(d.a)({},e.users.byIds,(n={},n[a]=Object(d.a)({},e.users.byIds[a],{id:r}),n))})})},t[Ze]=function(e,t){var n=t.id,r=t.properties;return Object(d.a)({},e,{users:ft(e.users,n,{properties:r})})},t[tt]=function(e,t){var n=t.id,r=t.data;return Object(d.a)({},e,{chats:pt(e.chats,n,r)})},t[at]=function(e,t){var n,r=t.id,a=t.chat,i=t.data;return Object(d.a)({},e,{chats:Object(d.a)({},e.chats,{byIds:Object(d.a)({},e.chats.byIds,(n={},n[a]=Object(d.a)({},e.chats.byIds[a],{events:pt(e.chats.byIds[a].events,r,i)}),n))})})},t[ct]=function(e,t){var n=t.id,r=t.data;return Object(d.a)({},e,{users:pt(e.users,n,r)})},t))},ht=function(e){return void 0===e&&(e={}),function(t,n){return void 0===t&&(t=e),n.type!==String(Qe)?t:Object(d.a)({},t,n.payload)}},vt=function(e){var t;return M(function(e){var t=e.id,n=e.connectionState,r=void 0===n?Ee:n;return Se(r),{id:t,user:t,connectionState:r}}(e),((t={})[Ke]=function(e,t){var n=t.id;return Object(d.a)({},e,{user:n})},t[He]=function(e,t){var n=t.connectionState;return Object(d.a)({},e,{connectionState:n})},t))},bt=function(e){return+new Date(e).setHours(0,0,0,0)},gt=function(e){var t=e.sessionUserId,n=e.event,r=e.showDate,a=void 0!==r&&r,i=e.time,o=void 0!==i&&i,c={own:n.author===t,author:n.author,events:[{id:n.id,type:n.type}],type:n.type};return a&&(c.showDate=!0),(a||o)&&(c.time=n.timestamp),c},_t=function(e,t){return gt({sessionUserId:le(e).id,event:t,showDate:!0})},yt=function(e){return Object(f.O)(function(e){return-1*Object(f.v)(0,"timestamp",Object(f.F)(e.events))},e).map(function(e){return{id:e.id}})},jt=function(e,t){var n,r=t.id;return Object(d.a)({},e,{Chat:Object(d.a)({},e.Chat,(n={},n[r]=Object(d.a)({},e.Chat[r],{timeline:[]}),n))})},Ot=function(){return!1},wt=function(){return!0},xt=function(e){var t=e.shouldAddToTimeline,n=void 0===t?wt:t,r=e.shouldCreateNewGroup,a=void 0===r?Ot:r,i=function(e,t){var n=le(e).id;return function(r,i){var o,c,s=Object(f.F)(r),u=$(e,t,Object(f.F)(s.events).id);if(o=u.timestamp,c=i.timestamp,bt(o)!==bt(c))return[].concat(r,[gt({sessionUserId:n,event:i,showDate:!0})]);var l=Object(f.n)(function(e){return e.time},r).time;return i.timestamp>=l+3e5?[].concat(r,[gt({sessionUserId:n,event:i,time:!0})]):s.author!==i.author||a(i)?[].concat(r,[gt({sessionUserId:n,event:i})]):[].concat(Object(f.h)(1,r),[Object(d.a)({},s,{events:[].concat(s.events,[{id:i.id,type:i.type}])})])}},o=function(e,t){return{timeline:0===t.events.length?[]:function(){var r=t.events.filter(n),a=r[0],o=r.slice(1),c=_t(e,a);return o.reduce(i(e,t.id),[c])}()}},c=function(e,t,n){var r=se(n);return{Chat:Object(f.H)(function(e){return o(n,e)},r),ChatList:yt(r),current:null}},s=function(e,t,n){var r,a=t.id;return Object(d.a)({},e,{Chat:Object(d.a)({},e.Chat,(r={},r[a]=o(n,ie(n,a)),r)),ChatList:yt(se(n))})},u=function(e,t,r){var a,o=t.chat,c=t.id,s=me(r,o),u=$(r,o,c);return n(u)?Object(d.a)({},e,{Chat:Object(d.a)({},e.Chat,(a={},a[o]=Object(d.a)({},e.Chat[o],{timeline:s.length>0?i(r,o)(s,u):[_t(r,u)]}),a)),ChatList:yt(se(r))}):e},l=function(e,t,n){var r,a=t.id;return Object(d.a)({},e,{Chat:Object(d.a)({},e.Chat,(r={},r[a]=o(n,ie(n,a)),r))})};return function(e,t){var n=t.type,r=t.payload;if(Object(f.B)(e.views))return Object(d.a)({},e,{views:c(e.views,0,e)});switch(n){case String(Me):return Object(d.a)({},e,{views:s(e.views,r,e)});case String(ze):case String(Ue):return Object(d.a)({},e,{views:u(e.views,r,e)});case String(Pe):var a=r.name.replace(/\//gi,".");return Object(d.a)({},e,{views:Object(f.ab)(a,r.data,e.views)});case String(qe):return Object(d.a)({},e,{views:jt(e.views,r)});case String(Ve):var i=r.path.replace(/\//gi,".")+"._default";return Object(d.a)({},e,{views:Object(f.ab)(i,r.name,e.views)});case String(Le):return Object(d.a)({},e,{views:l(e.views,r,e)});case String(Ae):return Object(d.a)({},e,{views:Object(d.a)({},e.views,{current:r.name})});case String(Ne):var o=r.name.replace(/\//gi,"."),p=Object(f.u)(o,e.views);return Object(d.a)({},e,{views:Object(f.ab)(o,Object(d.a)({},p,r.data),e.views)});default:return e}}},Ct=function(){return function(e){return void 0===e&&(e={}),e}},Et=function(e,t){return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e,n){return t.reduce(function(e,t){return t(e,n)},e)}}(Object(I.c)(Object(f.I)(function(t,n){return t(e[n])},{application:ut,entities:mt,localization:ht,session:vt,views:Ct})),xt(t))},It=function(e,t){var n=e.id,r=t.getState;return ie(r(),n)},St=function(e,t){var n=e.id,r=e.chat,a=t.getState;return{chat:r,event:$(a(),r,n)}},Tt=function(e,t){var n=e.id,r=t.getState;return pe(r(),n)},kt=function(e){var t;return function(e,t){return function(n,r){if(e.hasOwnProperty(n.type)){var a=e[n.type](n.payload,r);n.meta&&(a.meta=n.meta),t(n.type.toLowerCase(),a)}}}(((t={})[Me]=It,t[ze]=St,t[De]=Tt,t[qe]=It,t[nt]=f.y,t[it]=f.y,t[Ue]=St,t[Be]=function(e,t){var n=t.getState;return we(n())},t[He]=function(e,t){var n=t.getState;return K(n())},t[Ae]=function(e,t){var n=e.name,r=t.getState;return{name:n,data:Y(r(),n)}},t[Ke]=function(e,t){var n=t.getState;return le(n())},t[tt]=It,t[at]=St,t[ct]=Tt,t[Ze]=Tt,t[st]=f.y,t[$e]=f.y,t[We]=f.y,t),e)},Pt=function(e){var t=e.entities,n=void 0===t?{}:t,r=e.session,a=void 0===r?{}:r,i=a.id,o=void 0===i?"session_"+Object(f.s)():i,c=n.users,s=void 0===c?[]:c,u=Object(f.k)(function(e){return e.id===o},s);return Object(d.a)({},e,{entities:Object(d.a)({},n,{users:u?s:[].concat(s,[{id:o}])}),session:Object(d.a)({},a,{id:o})})};var At=n(88),Nt={},Vt=function(){return Nt};function Mt(e,t){return void 0===t&&(t={}),Object(At.b)(e,Vt,void 0,Object(d.a)({areStatesEqual:function(e){return e.getState()===e.getPreviousState()}},t))}var zt=n(0),Rt=n(9),Dt=zt.createContext(),qt=Dt.Provider,Lt=Dt.Consumer,Ft=Mt(function(e){return{localization:e.getState().localization,localize:e.localize}})(function(e){function t(){return e.apply(this,arguments)||this}return Object(Rt.a)(t,e),t.prototype.render=function(){var e=this;return zt.createElement(qt,{value:function(t,n){return e.props.localize(t,n)}},this.props.children)},t}(zt.Component)),Ut=function(e){if("string"===typeof e.children){var t=e.children,n=Object(l.a)(e,["children"]);return zt.createElement(Lt,null,function(e){return e(t,n)})}return zt.createElement(Lt,e)};function Bt(e){var t=e.store,n=e.children,r=Object.create(t);return r.getState=function(){return t},zt.createElement(At.a,{store:r},zt.createElement(Ft,null,n))}function Gt(e,t){return"object"===typeof e&&"object"===typeof t?Ht(e,t):e}function Ht(e,t){var n;if(Array.isArray(e)){n=new Array(e.length);for(var r=0;r<e.length;r++)e[r]!==t[r]&&(n[r]=Gt(e[r],t[r]))}else n={},Object.keys(e).forEach(function(r){e[r]!==t[r]&&(n[r]=Gt(e[r],t[r]))});return n}var Wt=n(31),Yt=Object(Wt.b)()?window.localStorage:Wt.a,Jt=6e4;function Qt(e,t){var n,r=Object(f.H)(function(e){return e.defaultValue},t),a=Object.keys(t),i=Object(f.e)(function(e){return Object(d.a)({},r,e)},function(e){return Object(f.H)(function(e){return e.value},e)},function(e){var n=Date.now();return Object(f.R)(function(e,r){return e.expires<n||void 0===t[r]},e)},JSON.parse,Object(f.g)("{}"),function(){return Yt.getItem(e)}),o=Object(f.e)(JSON.stringify,function(e){var t=Date.now()+30*Jt;return Object(f.H)(function(e){return{value:e,expires:t}},e)});return{persist:function(r){return r.subscribe(function(){var c,s=(c=r.getState(),a.reduce(function(e,n){return e[n]=Object(f.u)(t[n].path,c),e},{})),u=Ht(s,n);Object(f.B)(u)||(Yt.setItem(e,o(Object(f.L)(i(),u))),n=s)}),r},rehydrate:function(){return n=i(),e=n,a.reduce(function(n,r){return Object(f.ab)(t[r].path,e[r],n)},{});var e}}}function Kt(){var e={};return e.promise=new Promise(function(t,n){e.resolve=t,e.reject=n}),e}var Xt=function(e){var t,n=[],r=Kt();return e.startStateSync=function(a){t=e.getState(),a.emit("state",t);var i=function(){n.forEach(function(e){a.emit("state_diff",e)}),n.length=0},o=function(e){1===n.push(e)&&setTimeout(i,0)};e.subscribe(function(){var n=e.getState();n!==t&&(o(Ht(n,t)),t=n)});var c=/^request_/;e.on("*",function(e,t){c.test(e)||a.emit("store_event",[e,t])}),r.resolve()},e.syncing=function(){return r.promise},e},Zt={application:{availability:null,clientLimitExceeded:!1,clientLimitExceededLifted:!1,config:{features:{agentAvatar:{enabled:!0},creditCardMasking:{enabled:!1},disableSounds:{enabled:!1},emailTranscript:{enabled:!0},facebookButton:{enabled:!1},fileSharing:{enabled:!0},googlePlusButton:{enabled:!1},homeScreen:{enabled:!1,iframePlugins:[]},hideOnInit:{enabled:!1},hideOnMobile:{enabled:!1},hideTrademark:{enabled:!1},linksPreview:{enabled:!0},logo:{enabled:!0,path:"https://cdn.livechatinc.com/cloud/?uri=http://livechat.s3.amazonaws.com/default/logo/c4bf6633aa89a76af7461279581d8bdb.png"},offlineForm:{enabled:!0},preChatAfterGreeting:{enabled:!0},preChatForm:{enabled:!1},rating:{enabled:!0},twitterButton:{enabled:!1}},minimizedType:"bar",screenPosition:"right",theme:{}},destroyed:!1,embedded:!0,focused:!0,invitation:{},hidden:!1,maximized:!1,mobile:/mobile/gi.test(navigator.userAgent),muted:!1,paused:!1,ready:!1}},$t={carousel:!0,message:!0,rich_message:!0,sticker:!0,system_message:!0,url_preview:!0},en=function(e){return function(e,t){void 0===e&&(e={}),void 0===t&&(t={});var n=T(),a=f.y,o=F(),c=Object(I.e)(Et(Pt(e),t),void 0,a(Object(I.a)(o)));o.add(kt(n.emit));var s=c.getState(),u=s,d=s;return c.subscribe(function(){var e=c.getState();if(d!==e){var t=[d,e];u=t[0],d=t[1]}}),Object(f.a)(c,V(i,c),L(r,c.getState),{getPreviousState:function(){return u},emit:n.emit,on:n.on,once:n.once,off:function(e,t){if(!e||!t)throw new Error(".off needs to be called with both type and handler arguments.");if("*"===e)throw new Error(".off('*', ...) is not supported.");n.off(e,t)}}),c}(e,{shouldAddToTimeline:function(e){return $t[e.type]},shouldCreateNewGroup:function(e){return"carousel"===e.type}})},tn=function(e,t){var n=e,r=e.application,a=r.license,i=r.group;Object(f.z)("production",["labs","staging"])&&(y("kb_demo",window.location.search)||function(e,t){return 1520===e&&123===t}(a,i))&&(n=Object(f.L)(e,{application:{config:{features:{homeScreen:{enabled:!0,title:"Hello!",header:"We are here 24/7. Don't hesitate to ask us anything!",iframePlugins:[{id:"iframekb",name:"Knowledge Base",url:"https://livechat.kb.help/",label:"Knowledge Base",color:"#4343c6",button:{type:"search",placeholder:"Search for answers..."}}]}}}}}));var o=function(e,t){var n=Qt((void 0===t?{}:t).persistKey,{clientLimitExceededLifted:{path:["application","clientLimitExceededLifted"],defaultValue:!1},eyeCatcherHidden:{path:["application","eyeCatcher","hidden"],defaultValue:!1},invitationHidden:{path:["application","invitation","hidden"],defaultValue:!1},maximized:{path:["application","maximized"],defaultValue:!1},muted:{path:["application","muted"],defaultValue:!1}}),r=Object(f.L)(Zt,Object(f.L)(e,n.rehydrate()));return Object(f.e)(n.persist,Xt,en)(r)}(n,t),c=o.getApplicationState("config").features.homeScreen;return c.enabled?(o.addView("homeScreen",{title:c.title}),c.iframePlugins.forEach(function(e){o.addView(e.id,Object(d.a)({},e,{titleBarColor:e.color,title:e.name})),function(e){var t=document.createElement("link");t.href=e,t.as="document",t.rel="preload",document.head.appendChild(t)}(e.url)}),o.setCurrentView("homeScreen")):o.setCurrentView("Chat"),o.addView("Chat/information"),o.addView("loader"),o.addView("Chat/postchat"),o.addView("Chat/prechat"),o.addView("Chat/queue"),o.addView("Chat/timeline"),o.addView("minimized",{text:"Chat"}),o.addView("Chat/offline"),o.addView("uploadList",{ids:[]}),o.addChat({id:"liveChatChatId",active:!1,properties:{queued:!1}}),o},nn=n(90),rn=nn.a.Model;nn.a.Model=function(){return function(e){var t=T(),n={};return e.resolveRemoteCall=function(e){var t=e.id,r=e.value,a=n[t];delete n[t],a(r)},e.emitEvent=function(e){var n=e.event,r=e.data;t.emit(n,r)},new rn(e).then(function(r){return r.call=function(e){for(var t=arguments.length,a=new Array(t>1?t-1:0),i=1;i<t;i++)a[i-1]=arguments[i];return new Promise(function(t){var i=Object(f.t)(n);n[i]=t,r.emit("remote-call",{id:i,method:e,args:a})})},e.remoteCall=function(t){var n=t.id,a=t.method,i=t.args,o="function"===typeof e[a]?e[a].apply(r,i):void 0;o&&"function"===typeof o.then?o.then(function(e){r.call("resolveRemoteCall",{id:n,value:e})}):r.call("resolveRemoteCall",{id:n,value:o})},r.on=t.on,r.off=t.off,r})}}();var an=nn.a,on={group_select:"select",name:"text",subject:"text"},cn={group_chooser:"select",header:"information",name:"text",question:"text",subject:"text",checkbox_for_email:"checkbox"},sn=function(e){return e.replace(/index[0-9]*_/gi,"")},un=function(e,t,n){var r=n.getView("Chat/"+e).fields,a=Object(f.k)(function(e){return"groupSelect"===e.meta},r);return Object.keys(t).reduce(function(e,n){var i=t[n];if("rateComment"===n)return e.rateComment=i,e;if("rating"===n)return e.rate=null===i?i:sn(i),e;var o=Object(f.k)(function(e){return e.name===n},r),c=o.serverName;return a&&c&&c===a.serverName&&(e.choosenGroupIndex=t[a.name].match(/index([0-9])*_/)[1],e.choosenGroup=parseInt(sn(i),10)),o.options?e.fields[c]=Object(f.A)(i)?i.map(sn):sn(i):e.fields[c]=i,e},{fields:{}})},dn=function(e){return Object(d.a)({},e,{fields:e.fields.reduce(function(e,t){var n=t.name,r=Object(l.a)(t,["name"]),a=Object(d.a)({},r,{type:on[r.type]||r.type});if(a.options){a.options=a.options.map(function(e,t){return Object(d.a)({},e,{value:"index"+t+"_"+e.value,originalValue:e.value})});var i=a.options.filter(function(e){return e.checked});i.length&&(a.defaultValue=i.map(function(e){return e.value}))}if("information"===r.type&&(a.value=a.value.replace(/<br(\s)?(\/)?>/gi,"\n")),"group_select"===r.type&&(a.meta="groupSelect",a.options=a.options.map(function(e){return Object(d.a)({},e,{groupNumber:parseInt(e.originalValue,10)})})),n&&(a.serverName=n),"name"===r.type)a.name="name";else if("email"===r.type)a.name="email";else{if("rating"===r.type)return a.name="rating",[].concat(e,[a,{name:"rateComment",type:"textarea",label:a.commentLabel,required:!1,dependOn:"rating"}]);n&&(a.name="name_"+n)}return[].concat(e,[a])},[])})},ln=function(e){return Object(d.a)({},e,{fields:e.fields.reduce(function(e,t){var n=t.id,r=Object(l.a)(t,["id"]),a=Object(d.a)({},r,{type:cn[r.type]||r.type,serverName:n});if("information"===r.type)a.value=a.label.replace(/<br(\s)?(\/)?>/gi,"\n");else if("checkbox_for_email"===r.type)a.meta="confirm_subscription",a.label="",a.options=[{label:r.label,checked:r.checked,value:"index0_0",originalValue:"0"}],r.checked&&(a.defaultValue=[a.options[0].value]);else if(r.options){var i="group_select"===r.type;i&&(a.meta="groupSelect"),a.options=a.options.map(function(e,t){var n=i?e.group:e.id,r=Object(d.a)({},Object(f.P)(["id","checked","group"],e),{value:"index"+t+"_"+n,originalValue:n});return i&&(r.groupNumber=e.group),r})}if("name"===r.type)a.name="name";else if("email"===r.type)a.name="email";else{if("rating"===r.type)return a.name="rating",[].concat(e,[a,{name:"rateComment",type:"textarea",label:a.commentLabel,required:!1,dependOn:"rating"}]);a.name="name_"+n}return[].concat(e,[a])},[])})},pn=function(e,t){var n=t.id,r=t.author,a=t.timestamp,i=t.seen,o=void 0!==i&&i,c=t.type,s=Object(l.a)(t,["id","author","timestamp","seen","type"]);return{id:n,type:e,author:r,timestamp:a,seen:o,properties:Object(d.a)({serverType:c},s)}},fn=function(e){return e.properties.url_details?function(e){var t=e.properties.url_details;return pn("url_preview",Object(d.a)({},e,{title:t.title,description:t.description,image:{url:t.image_url,link:t.url}}))}(e):pn("message",e)},mn=function(e){return{template:"default",elements:Object(f.W)(["title","subtitle","image","buttons"],e)}},hn=function(e){if("quick_replies"===e.template){var t=e.elements[0],n=t.title,r=t.buttons;return fn(Object(d.a)({},e,{text:n,quickReplies:r}))}return"sticker"===e.template?function(e){return pn("sticker",Object(d.a)({},e,{sticker:e.elements[0].image}))}(e):e.elements.length>1?pn("carousel",Object(d.a)({},e,{cards:e.elements.map(mn)})):pn("rich_message",Object(d.a)({},e,{card:mn(e.elements[0])}))},vn=function(e){var t=e.text,n=Object(l.a)(e,["text"]);return pn("system_message",Object(d.a)({},n,{seen:!0,defaultText:t}))},bn=n(85),gn=function(e,t){var n=t.getChat(e).properties.currentAgent;return n?t.getUser(n):null},_n=function(e,t){return t.getApplicationState("config").features[e]},yn=function(e,t,n){var r=t.authorPredicate,a=t.lastSeenPredicate,i=n.getEvents(e),o=Object(f.o)(a,i);return Object(f.e)(f.Y.bind(null,r),f.fb.bind(null,function(e){return r(e)||!e.seen},o))(i)},jn=function(e,t,n){var r=n.getSessionUserId();return yn(e,{authorPredicate:function(e){return e.author!==r},lastSeenPredicate:function(e){var n=e.properties.serverTimestamp;return(void 0!==n?n:e.timestamp)<=t}},n)},On=function(e,t,n){var r=n.getSessionUserId();return yn(e,{authorPredicate:function(e){return e.author===r},lastSeenPredicate:function(e){return e.timestamp<=t}},n)},wn=function(e,t,n){var r=e.getEvent(t,n);if(!r.own)return null;if(r.failed)return"Message not sent";if(r.seen){var a=e.getLastSeenEvent(t);return a&&n===a.id?e.localize("message_read"):null}var i=e.getLastDeliveredEvent(t);return i&&n===i.id?e.localize("message_delivered"):null},xn=function(e,t){var n=t.getEvents(e);return Object(f.k)(function(e){return"welcome_message"===e.id||"invitation"===e.id},n)},Cn=function(e){var t=e.getApplicationState("config");return!0===e.getApplicationState("mobile")?t.mobileMinimizedType:t.minimizedType},En=function(e){var t=e.getApplicationState("config");return!0===e.getApplicationState("mobile")?t.mobileScreenPosition:t.screenPosition},In=function(e,t){return!!xn(e,t)},Sn=function(e,t){return!In(e,t)&&!!t.getApplicationState("embedded")},Tn=function(e){return e.getConnectionState()===a.RECONNECTING},kn=function(e,t){var n=t.getEvents(e);return function e(t,n){if(n<0)return null;var r=t[n];return r.own&&"message"===r.type?null:"system_message"===r.type||"rich_message_postback"===r.type?e(t,n-1):r.properties.quickReplies?r:null}(n,n.length-1)},Pn=function(e,t){var n=t.getApplicationState(),r="online"===n.availability,a=n.invitation.hidden||!r,i=t.getChat(e).properties.invitationId,o=i?t.getEvent(e,i):null,c=t.getChat(e).active,s=_n("agentAvatar",t).enabled&&(r||c);return{invitationHidden:a,minimizedText:t.getView("minimized").text,invitationText:r&&o&&o.properties.text,unseenCount:c?t.getUnseenCount(e):0,avatar:!!s&&Object(f.v)(!1,"avatar",gn(e,t))}},An=function(e,t){var n=e.getSessionUser().name,r=n||e.localize("client"),a=gn("liveChatChatId",e);return t.replace(/%name%/g,r).replace(/%agent%/g,a.name)},Nn=function(e){return Object(bn.b)(e)>.179},Vn=function(e,t){var n=t.split(" "),r=0,a=!1,i=n.map(function(t){return!a&&t.length+r<e?(r+=t.length+1,t):(a=!0,null)}).filter(function(e){return"string"===typeof e}).join(" ");return a?i+"...":i},Mn=function(e){var t=e.customJson||{},n=Nn(e.agentbarBackgroundColor)?"rgba(0, 0, 0, 0.05)":"rgba(255, 255, 255, 0.3)";return Object(f.L)({name:e.name,iconTheme:e.name,showMessageAvatar:"modern"!==e.name,AgentBar:{css:{background:e.agentbarBackgroundColor,color:e.agentbarText},IconButton:{css:{background:{default:n}}}},Button:{css:{backgroundColor:{default:"modern"===e.name?"#aecf5f":e.ctaColor}}},ChatSummary:{Icon:{color:e.minimizedColorIcon}},Divider:{css:{borderColor:n}},Maximized:{css:{background:e.backgroundColor}},Message:{own:{Bubble:{css:{background:"modern"===e.name?"transparent":e.visitorMessageBackgroundColor,color:e.visitorMessageColorText}}},system:{Bubble:{css:{color:e.systemMessageColor}}},Bubble:{css:{background:"modern"===e.name?"transparent":e.agentMessageBackgroundColor,color:e.agentMessageColorText}},css:{color:e.systemMessageColor}},TypingIndicator:{css:{color:e.systemMessageColor}},Minimized:{MinimizedBubble:{css:{color:e.minimizedColorText,backgroundColor:e.minimizedColorBackground},Icon:{color:e.minimizedColorIcon}},MinimizedBar:{css:{color:e.minimizedColorText,backgroundColor:e.minimizedColorBackground},Icon:{color:e.minimizedColorIcon}}},TitleBar:{css:{color:e.titlebarText,backgroundColor:e.titlebarBackgroundColor}}},t)},zn=[0,2,4,6,8,1,3,5,7,9],Rn=function(e){return e.replace(/\b(?:\d[ -]*?){8,15}((?:\d[ -]*?){4})\b/g,function(e,t){var n=e.replace(/(-|\s)/g,"");return function(e){if(/[^0-9-\s]+/.test(e))return!1;for(var t,n=e.replace(/\D/g,""),r=n.length,a=1,i=0;r;)t=parseInt(n.charAt(--r),10),i+=(a^=1)?zn[t]:t;return i&&i%10===0}(n)?""+function(e){var t=e%4,n=t?4-t:0,r=Math.floor(e/4)+(t?1:0)-n-1,a=Object(f.j)(n,"XXX"),i=Object(f.j)(r,"XXXX");return a.concat(i).join("-").concat("-")}(n.length)+t:e})},Dn=n(183),qn=n.n(Dn),Ln=n(114),Fn=n.n(Ln),Un=new qn.a;Un.tlds(Fn.a);var Bn=function(e,t,n){var r=Object(f.l)(function(t){return t.name===e},n);return-1!==r?Object(f.mb)(r,Object(d.a)({},n[r],{defaultValue:t}),n):n},Gn=function(e,t){var n=e.getView("uploadList").ids;e.updateView("uploadList",{ids:[].concat(n,[t])})},Hn=function(e,t,n,r,a){e.addEvent("liveChatChatId",{id:n||Object(f.t)(e.getChat("liveChatChatId").events),type:"system_message",author:"system",seen:!0,properties:Object(f.d)({systemMessageType:r,textVariables:a})})},Wn=function(e,t){var n=e.getView("uploadList").ids;e.updateView("uploadList",{ids:n.filter(function(e){return e!==t})})},Yn=function(e){e.updateView("minimized",{text:e.localize("embedded_chat_ended")}),e.updateChat("liveChatChatId",{active:!1,properties:{ended:!0,queued:!1}}),e.updateView("Chat",{inputMode:"startChatAgain"})},Jn=function(e,t){var n=t.id,r=t.rate;e.updateChat("liveChatChatId",{properties:{rate:r}}),function(e,t){var n=t.id,r=t.rate;Hn(e,0,n,function(e){return"good"===e?"rate_me_confirmation_good":"bad"===e?"rate_me_confirmation_bad":"rate_me_cancel"}(r))}(e,{id:n,rate:r})},Qn=function(e,t){var n=t.id,r=t.comment;e.updateChat("liveChatChatId",{properties:{rateComment:r}}),function(e,t){var n=t.id,r=t.comment;Hn(e,0,n,"rate_me_comment_added",{comment:r})}(e,{id:n,comment:r})},Kn=function(e){e.setApplicationState({eyeCatcher:Object(d.a)({},e.getApplicationState().eyeCatcher,{hidden:!0})})},Xn=function(e){e.setApplicationState({invitation:Object(d.a)({},e.getApplicationState().invitation,{hidden:!0})})},Zn=function(e){e.setApplicationState({maximized:!0})},$n=function(e,t){var n=e.id,r=e.thread,a=gn("liveChatChatId",t);a&&t.updateView("minimized",{text:t.localize("embedded_chat_with",{operator:a.name})}),null===t.getChat("liveChatChatId").serverId&&t.setChatServerId("liveChatChatId",n);var i={ended:!1,queued:!1};void 0!==r&&(i.lastThread=r),Xn(t),Kn(t),t.updateChat("liveChatChatId",{active:!0,properties:i}),t.updateView("Chat",{inputMode:"text"}),t.setDefaultView("Chat","timeline"),t.setApplicationState({hidden:!1});var o=t.getApplicationState(),c=o.maximized,s=o.ready;t.setCurrentView("Chat"),s&&!c&&Zn(t)},er=/\s/,tr=function(e,t,n,r){var a=n.trim(),i=(!er.test(a)&&Un.match(a),n);_n("creditCardMasking",e).enabled&&(i=Rn(n)),e.sendEvent(t,{type:"message",properties:Object(f.d)({text:i,triggeredBy:r})})},nr=function(e,t){e.updateChat("liveChatChatId",{properties:{currentAgent:t}}),null!==t&&e.updateView("minimized",{text:e.localize("embedded_chat_with",{operator:e.getUser(t).name})})},rr=function(e,t){var n=t.getSessionUser(),r=n.name,a=n.email,i=t.getView("Chat/"+e).fields,o=i;r&&(o=Bn("name",r,o)),a&&(o=Bn("email",a,o)),o!==i&&t.updateView("Chat/"+e,{fields:o})},ar=function(e){rr("prechat",e),e.setDefaultView("Chat","prechat")},ir=function(e){var t=e.getView("Chat/postchat").fields,n=t,r=e.getChat("liveChatChatId").properties,a=r.rate,i=r.rateComment;a&&(n=Bn("rating",a,n)),i&&(n=Bn("rateComment",i,n)),n!==t&&e.updateView("Chat/postchat",{fields:n}),e.setDefaultView("Chat","postchat")},or=function(e,t){t.updateView("uploadList",{ids:[]}),t.flushChat(e)},cr=function(e,t){var n=t.getApplicationState("config");t.setApplicationState({config:Object(d.a)({},n,{features:Object(f.L)(n.features,e.features),minimizedType:e.theme.minimized,mobileMinimizedType:e.theme.mobileMinimized,theme:Object(f.L)(n.theme,Mn(e.newTheme)),screenPosition:e.screenPosition,mobileScreenPosition:e.mobileScreenPosition})}),e.features.disableSounds.enabled&&t.setApplicationState({muted:!0})},sr=function(e,t,n){var r,a=e.getApplicationState("config");e.setApplicationState({config:Object(d.a)({},a,{features:Object(f.L)(a.features,(r={},r[t]=n,r))})})},ur=function(e,t){sr(e,t,{enabled:!1})},dr=function(e,t){return e.addEvent("liveChatChatId",{id:String(t.id),type:"form",author:"system",seen:!0,properties:Object(d.a)({formType:"postchat"},t)}),e.updateView("Chat/postchat",t),t},lr=function(e,t){var n=dn(e);return t.addEvent("liveChatChatId",{id:String(e.id),type:"form",author:"system",seen:!0,properties:Object(d.a)({formType:"prechat"},n)}),t.updateView("Chat/prechat",n),n},pr=function(e,t){var n=t.authorId,r=t.text,a=t.receivedFirstTime,i=t.properties,o=void 0===i?{}:i,c=e.getApplicationState(),s=c.config,u=c.mobile,l=c.maximized,p=s.features,f=u||"bar"!==Cn(e),m=!e.getApplicationState("maximized")&&!f&&a;f||Xn(e),m||Kn(e);e.addEvent("liveChatChatId",{id:"invitation",type:"message",author:n,seen:!0,properties:Object(d.a)({text:An(e,r),originalText:r,invitation:!0,receivedFirstTime:a},o)}),e.updateChat("liveChatChatId",{properties:{invitationId:"invitation"}}),p.preChatForm.enabled&&p.preChatAfterGreeting.enabled&&e.updateView("Chat",{inputMode:"requestPrechat"}),e.setApplicationState({hidden:!1}),function(e){return"Chat"===e.getCurrentView()&&"prechat"===e.getDefaultView("Chat")}(e)||function(e){return"Chat"===e.getCurrentView()&&"offline"===e.getDefaultView("Chat")}(e)||e.setDefaultView("Chat","timeline"),l||e.setCurrentView("Chat"),m&&Zn(e)},fr=function(e,t){return e.hasEvent("liveChatChatId","offline_form")?e.updateEvent("liveChatChatId","offline_form",{properties:t}):e.addEvent("liveChatChatId",{id:"offline_form",type:"form",author:"system",seen:!0,properties:Object(d.a)({formType:"offline",id:"offline_form"},t)}),e.getEvent("liveChatChatId","offline_form")},mr=function(e,t){var n=fr(e,dn(t));e.updateView("Chat/offline",n.properties),rr("offline",e),e.setDefaultView("Chat","offline")};n(137);var hr=n(138),vr=n.n(hr),br=n(75),gr=(n(139),n(76)),_r=n.n(gr),yr=n(140),jr=n(141),Or=(n(142),n(77)),wr=n(143),xr=n(63),Cr=n.n(xr),Er=n(38),Ir=n(78),Sr=n.n(Ir),Tr=n(47),kr=n(39),Pr=n.n(kr);function Ar(e,t){return _r()(function(n){var r=function(e){n(1,e)};return e.on(t,r),function(){e.off(t,r)}})}var Nr=n(144),Vr=n.n(Nr),Mr=n(79),zr=n(40);var Rr=n(20),Dr=n.n(Rr);function qr(){var e=Object(zr.a)(function(){return!!document.hasFocus&&document.hasFocus()}),t=Dr()(function(){return!0})(Object(Tr.a)(window,"focus")),n=Dr()(function(){return!1})(Object(Tr.a)(window,"blur"));return Pr()(e,t,n)}n(145);var Lr,Fr=(Lr=function(){return Or.a},function(e){return function(t,n){if(0===t){var r,a=!1,i=function(e,t){r(e,t)};e(t,function e(t,o){if(0===t)return r=o,a?void i(1):void n(t,i);if(2===t&&o&&!a){a=!0;try{Lr(o)(0,e)}catch(c){n(2,c)}}else n(t,o)})}}}),Ur=(n(80),n(146)),Br=n(81),Gr=(n(147),n(148)),Hr=n(82),Wr=n.n(Hr),Yr=n(149),Jr=n(83),Qr=n(150),Kr=n.n(Qr),Xr=n(151),Zr=n.n(Xr);n(152),n(84);function $r(e){return function(t){return Object(Er.a)(Dr()(e)(t))}}var ea=n(153),ta=n.n(ea),na=n(154),ra=(n(155),n(156),n(157),n(158));n(159);function aa(){return new Promise(function(e){!function t(){document.body?e(document.body):setTimeout(t,100)}()})}var ia=!!document.documentElement.currentStyle,oa=function(e,t){var n=window.getComputedStyle(t),r="border-box"===n.boxSizing,a=Object(f.T)(e,n);if(ia&&r&&Object(f.x)("width",a)&&null!==a.width){var i=[a.width,n.paddingLeft,n.paddingRight,n.borderLeftWidth,n.borderRightWidth];a.width=Object(f.eb)(i.map(parseFloat))+"px"}if(ia&&r&&Object(f.x)("height",a)&&null!==a.height){var o=[a.height,n.paddingTop,n.paddingBottom,n.borderTopWidth,n.borderBottomWidth];a.height=Object(f.eb)(o.map(parseFloat))+"px"}return a};function ca(e,t){return Wr()(Vr()(e),Zr()(e.getState()),Dr()(t),Object(jr.a)(f.bb))}var sa,ua=function(e,t){return e.call("resize",t)},da=function(e){var t=e.minimizedRef;return t?oa(["width","height"],t):{width:"0px",height:"0px"}},la=function(e){var t=!1,n=null;return function(){for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];n=e.bind.apply(e,[null].concat(a)),function e(){if(n&&!t){var r=n;return n=null,t=!0,void r().then(function(){t=!1,e()})}}()}}(function(e,t,n){var r=sa,a=e.model,i=a.fullWidth,o=a.fullHeight;return sa=n,new Promise(function(a){r&&n?a():!r||n?r||!n?e.minimizedRef?ua(e,{width:i,height:o,maximized:n}).then(function(){var t=da(e);return ua(e,t)}).then(a):ua(e,{width:"0px",height:"0px",maximized:n}).then(a):ua(e,{width:i,height:o,maximized:n}).then(a):t.once("animation_end",function(){ua(e,Object(d.a)({},da(e),{maximized:n})).then(a)})})}),pa=function(e,t){sa=t.getApplicationState().maximized,Wr()(ca(t,function(e){return e.application.maximized}),Sr()(function(n){return la(e,t,n)}))},fa=function(e){return Object(f.z)(e.lang,["ar","he","fa"])},ma=function(e){return we(e,"hidden")||Y(e,"minimized").hidden&&!we(e,"maximized")};function ha(e,t){var n=t.license,r=t.group,a=t.uniqueGroups,i=function(e){var t=function(t,n){return(e.getApplicationState("hidden")?n.call("show").then(function(){e.setApplicationState({hidden:!1})}):Promise.resolve()).then(function(){t!==e.getApplicationState("maximized")&&e.setApplicationState({maximized:t})})};return{hide:function(){e.getApplicationState("hidden")||(Kn(e),t(!1,this).then(function(){e.setApplicationState({hidden:!0})}))},hideEyeCatcher:function(){Kn(e)},isFocused:function(){return!!document.hasFocus&&document.hasFocus()},maximize:function(){t(!0,this)},minimize:function(){t(!1,this)},startStateSync:function(){e.startStateSync(this)},storeMethod:function(t){var n=t[0],r=t.slice(1);e[n].apply(e,r)}}}(e);return new an.Model(i).then(function(t){return Promise.all([t,e.syncing()])}).then(function(t){var i=t[0];window.performance&&"function"===typeof window.performance.mark&&window.performance.mark("lc_postmate_ready");var o=i.model,c=o.clientLimitExceeded,s=o.customer,u=o.hidden,d=o.page,l=o.serverConfig,p=o.region,f=e.getApplicationState("mobile");return e.updateUser(e.getSessionUser().id,s),e.setApplicationState({clientLimitExceeded:!e.getApplicationState("clientLimitExceededLifted")&&c,hidden:u,page:d,maximized:!f&&e.getApplicationState("maximized"),rtl:fa(l)}),[{data:{license:n,group:r,region:p,uniqueGroups:a,mobile:f},props:{onAnimationEnd:function(){return e.emit("animation_end")},onError:function(){i.call("kill")},onMinimizedRef:function(e){i.minimizedRef=e},onMinimizedResize:function(){return la(i,e,!1)},showMinimizedButton:!0},onBootstrap:function(){pa(i,e),ma(e.getState())||i.call("show")}},l,i]})}var va=function(){return Boolean(Object(f.u)("webkit.messageHandlers.iosMobileWidget.postMessage",window))?"ios":!!Boolean(Object(f.u)("androidMobileWidget.postMessage",window))&&"android"},ba=function(e){return window.androidMobileWidget.postMessage(JSON.stringify(e))},ga=function(e){return window.webkit.messageHandlers.iosMobileWidget.postMessage(e)},_a=function(){var e=va();return"android"===e?ba:"ios"===e?ga:null}(),ya=function(){return Boolean(va())},ja=function(e){_a&&(_a({messageType:"uiReady"}),e.on("add_event",function(t){var n=t.event;if("message"===n.type){var r=e.getUser(n.author).name;_a({messageType:"newMessage",text:n.properties.text,id:n.id,timestamp:n.timestamp,author:{name:r}})}}),e.on("mobile_wrapper_minimize_intent",function(){_a({messageType:"hideChatWindow"})}))},Oa={},wa=function(e,t){var n=void 0===t?{}:t,r=n.query,a=void 0===r?{}:r,i=n.jsonpParam,o=void 0===i?"jsonp":i;return new Promise(function(t,n){aa().then(function(r){var i,c=document.createElement("script"),s=Object(f.t)(Oa);Oa[s]=!0;var u="__"+s;window[u]=function(e){delete Oa[s],delete window[u],function(e){var t=e.parentNode;t&&t.removeChild(e)}(c),t(e)},c.src=e+"?"+m(Object(d.a)({},a,((i={})[o]=u,i))),c.addEventListener("error",function(){return n(new Error("JSONP request failed."))}),r.appendChild(c)})})},xa=function e(t,n){var r=n.license,a=n.uniqueGroups,i=n.group,o=n.region,c=n.query,s=void 0===c?{}:c,u=function(e,t){return 1520===e?"https://secure-lc.livechatinc.com":function(e,t){if(!t)return e;var n=e.match(/secure(-(labs|lc))/i);return"https://secure-"+t+(null!==n&&n.length>0?n[1]:"")+".livechatinc.com"}("https://secure.livechatinc.com",t)}(r,o);return wa(u+"/"+function(e){var t=e.uniqueGroups,n=e.license,r=e.group;return"licence/"+(t?"g"+n+"_"+(void 0===r?0:r):n)}({uniqueGroups:a,license:r,group:i})+"/v2/"+t+".js",{query:Object(d.a)({referrer:document.referrer,url:String(document.location)},s)}).then(function(n){if(n.error&&"incorrect region"===n.error)return e(t,{license:r,uniqueGroups:a,group:i,region:n.region,query:s});if(n.error)throw new Error(n.error);return Object(d.a)({},n,{region:o})})},Ca=function(e){var t=e.license,n=e.group,r=e.uniqueGroups,a=void 0!==r&&r,i={t:Date.now()};return void 0!==n&&(i.groups=n),xa("get_dynamic_config",{license:t,query:i,uniqueGroups:a}).then(function(e){if(e.error)throw new Error(e.error);var r=e.visitor.groups;return Promise.all([a&&n!==r?xa("get_dynamic_config",{license:t,group:r,uniqueGroups:a}):e,xa("get_static_config."+r+"."+e.static_config_version,{license:t,group:r,uniqueGroups:a})])}).then(function(e){var t=e[0],n=e[1];return Object(d.a)({},t,n)})},Ea=function(){var e=_(window.location.search),t=Object(f.W)(["name","email"],e);return e.params&&(t.properties=h(e.params)),t};var Ia,Sa=n(26),Ta=n.n(Sa),ka={LICENSE:"license",GROUP:"group",SESSION_ID:"sessionId",SECURED_TOKEN:"securedToken",CHAT_ID:"chatId",CHAT_STATE:"chatState",CHAT_STATUS:"chatStatus",VISITOR_ID:"visitorId",CUSTOM_VISITOR_ID:"customVisitorId",LAST_MESSAGE_ID:"lastMessageId",CONNECTION_STATUS:"connectionStatus",SNEAK_PEEK:"sneakPeek",TICKET_FORM:"ticketForm",PRE_CHAT_FORM:"preChatForm",POST_CHAT_FORM:"postChatForm",STATIC_CONFIG_VERSION:"staticConfigVersion",TRANSLATIONS_VERSION:"translationsVersion",TRANSLATIONS:"translations",SECRET_ID:"secretId",REGION:"region",CONFIG_LOADED:"configLoaded",LAST_AGENT_ID:"lastAgentId",DYNAMIC_CONFIG:"dynamicConfig",CONFIG:"config",WELCOME_MESSAGE:"welcomeMessage",ACCEPTED_INVITATION:"acceptedInvitation",SERVER_IDS_MAP:"serverIdsMap",VISITOR_CUSTOM_ID_MAP:"visitorCustomIdMap",CLIENT_LIMIT_EXCEEDED:"clientLimitExceeded",PING_SENT:"pingSent",CHAT_BETWEEN_GROUPS:"chatBetweenGroups",HISTORY_LOADED:"historyLoaded",REQUEST_DISTRIBUTION:"requestDistribution",MOBILE:"mobile"},Pa=Object(d.a)({},q(ka.LICENSE),q(ka.GROUP),q(ka.SESSION_ID),q(ka.SECURED_TOKEN),q(ka.CHAT_ID),q(ka.CHAT_STATE),q(ka.VISITOR_ID),q(ka.CUSTOM_VISITOR_ID),q(ka.LAST_MESSAGE_ID),q(ka.CHAT_STATUS),q(ka.CONNECTION_STATUS),q(ka.SNEAK_PEEK),q(ka.TICKET_FORM),q(ka.STATIC_CONFIG_VERSION),q(ka.SECRET_ID),q(ka.REGION),q(ka.CONFIG_LOADED),q(ka.LAST_AGENT_ID),q(ka.PRE_CHAT_FORM),q(ka.TRANSLATIONS_VERSION),q(ka.TRANSLATIONS),q(ka.POST_CHAT_FORM),q(ka.CONFIG),q(ka.DYNAMIC_CONFIG),q(ka.WELCOME_MESSAGE),q(ka.ACCEPTED_INVITATION),q(ka.SERVER_IDS_MAP),q(ka.VISITOR_CUSTOM_ID_MAP),q(ka.CLIENT_LIMIT_EXCEEDED),q(ka.PING_SENT),q(ka.CHAT_BETWEEN_GROUPS),q(ka.HISTORY_LOADED),q(ka.REQUEST_DISTRIBUTION),q(ka.MOBILE)),Aa=P("CHAT_STARTED",function(e){return{securedToken:e.securedToken,welcomeMessage:e.welcomeMessage,visitorMessage:e.visitorMessage}}),Na=P("NEW_MESSAGE",function(e){return{id:e.id,timestamp:e.timestamp,authorType:e.authorType,authorId:e.authorId,text:e.text,chatId:e.chatId,isMobile:e.isMobile,customId:e.customId,serverId:e.serverId,json:e.json}}),Va=P("CHAT_ENDED",function(){return null}),Ma=P("NEW_AGENT",function(e){return{avatarUrl:e.avatarUrl,jobTitle:e.jobTitle,name:e.name,id:e.id}}),za=P("VISITOR_DATA_SET",function(e){return{visitorData:e.visitorData,requestId:e.requestId}}),Ra=P("VISITOR_DATA_SET_ERROR",function(e){return{error:e.error,requestId:e.requestId}}),Da=P("NEW_FILE",function(e){var t=e.id,n=e.timestamp,r=e.authorType,a=e.authorId,i=e.url,o=e.contentType;return{id:t,timestamp:n,authorType:r,authorId:a,url:i,size:e.size,contentType:o,attachmentToken:e.attachmentToken,thumbnail:e.thumbnail}}),qa=P("VISITOR_QUEUED",function(e){return{numberInQueue:e.numberInQueue,waitingTime:e.waitingTime}}),La=P("TYPING_INDICATOR",function(e){return{authorId:e.authorId,isTyping:e.isTyping}}),Fa=P("RATE_CHAT",function(e){return{rate:e.rate,comment:e.comment}}),Ua=P("SET_VISITOR_DATA",function(e){var t=e.visitorData,n=e.requestId,r=e.internal;return{visitorData:t,requestId:n,internal:void 0!==r&&r}}),Ba=P("SEND_FILE",function(e){return{file:e.file,customId:e.customId}}),Ga=P("REQUEST_FILE_TOKEN",function(e){return{customId:e.customId}}),Ha=P("FILE_TOKEN_RECEIVED",function(e){return{customId:e.customId,token:e.token}}),Wa=P("NEW_INVITATION",function(e){return{id:e.id,authorId:e.authorId,text:e.text,receivedFirstTime:e.receivedFirstTime}}),Ya=P("MESSAGE_SEEN",function(e){return{id:e.id,customId:e.customId,type:e.type}}),Ja=P("PROTOCOL_UPGRADED",function(){}),Qa=P("INTEGRATION_DATA",function(e){return{id:e.id,timestamp:e.timestamp,integrationName:e.integrationName,data:e.data}}),Ka=Object(f.e)(f.M,function(e){return e.map(R)},f.nb)(ka),Xa=Object(f.e)(f.M,function(e){return e.map(D)},f.nb)(ka),Za=function(e){return e.environment},$a=((Ia={})[Ua.getActionName()]=function(e,t){return Object(d.a)({},e,{visitorData:t.visitorData})},Ia),ei=function(e){return e.visitorData},ti=M({},Object(d.a)({},$a,Ka)),ni=n(15),ri=function(e,t){var n=t.external,r=Object(ni.c)({context:{external:n}}),a=Object(I.d)(Object(I.a)(r),window.devToolsExtension?window.devToolsExtension():function(e){return e})(I.e)(ti,e);return a.runSaga=r.run,a},ai=n(5),ii=n.n(ai),oi=n(2),ci=P("PUBLIC_SEND_MESSAGE",function(e){var t=e.customId,n=e.text,r=e.json,a=e.promise;return{customId:String(t),text:n,json:r,promise:a}}),si=(P("PUBLIC_INIT",function(e){return{license:e.license,group:e.group}}),P("PUBLIC_SET_VISITOR_DATA",function(e){var t=e.name,n=e.email,r=e.pageUrl,a=e.pageTitle,i=e.customProperties,o=e.promise,c=e.update;return{name:t,email:n,customProperties:i,pageUrl:r,pageTitle:a,promise:o,update:void 0===c||c}})),ui=P("GET_VISITOR_DATA",function(e){return{promise:e.promise}}),di=(P("PUBLIC_CALLBACK_ERROR",function(e){return{errorMessage:e.errorMessage}}),P("PUBLIC_RATE_CHAT",function(e){return{rate:e.rate,comment:e.comment,promise:e.promise}})),li=P("PUBLIC_SET_SNEAK_PEEK",function(e){return{text:e.text,promise:e.promise}}),pi=P("PUBLIC_FORWARD_CHAT_TRANSCRIPT",function(e){return{email:e.email,promise:e.promise}}),fi=P("PUBLIC_CLOSE_CHAT",function(e){return{promise:e.promise}}),mi=P("PUBLIC_DISCONNECT",function(e){return{promise:e.promise}}),hi=P("PUBLIC_GET_TICKET_FORM",function(e){return{promise:e.promise,group:e.group}}),vi=P("PUBLIC_SEND_TICKET_FORM",function(e){return{answers:e.answers,promise:e.promise}}),bi=P("PUBLIC_SEND_FILE",function(e){return{file:e.file,customId:e.customId,promise:e.promise,onProgress:e.onProgress}}),gi=P("PUBLIC_SEND_FILE",function(e){return{customId:e.customId}}),_i=P("PUBLIC_GET_PRECHAT_FORM",function(e){return{promise:e.promise}}),yi=P("PUBLIC_SEND_PRECHAT_FORM",function(e){return{promise:e.promise,answers:e.answers}}),ji=P("PUBLIC_GET_TRANSLATIONS",function(e){return{promise:e.promise}}),Oi=P("PUBLIC_GET_PREDICTED_AGENT",function(e){return{promise:e.promise}}),wi=P("PUBLIC_GET_POSTCHAT_FORM",function(e){return{promise:e.promise}}),xi=P("PUBLIC_SEND_POSTCHAT_FORM",function(e){return{promise:e.promise,answers:e.answers}}),Ci=P("PUBLIC_GET_CONFIG",function(e){return{promise:e.promise}}),Ei=P("PUBLIC_ACCEPT_INVITATION",function(e){return{promise:e.promise,id:e.id}}),Ii=P("PUBLIC_MESSAGE_AS_SEEN",function(e){return{promise:e.promise,messageId:e.messageId}}),Si=P("PUBLIC_START_CHAT",function(e){return{promise:e.promise}}),Ti=P("PUBLIC_CHECK_GROUP_STATUS",function(e){return{group:e.group,promise:e.promise}}),ki=P("PUBLIC_SET_VISITOR_GROUP",function(e){return{group:e.group}}),Pi=P("PUBLIC_GET_QUEUE_FORM",function(e){return{promise:e.promise}}),Ai=n(51),Ni=n.n(Ai),Vi=ii.a.mark(Mi);function Mi(e){var t,n,r,a,i=arguments;return ii.a.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:for(t=i.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=i[r];case 1:return o.next=3,oi.j.apply(void 0,[e].concat(n));case 3:if("undefined"===typeof(a=o.sent)){o.next=6;break}return o.abrupt("return",a);case 6:return o.next=8,Object(oi.l)("*");case 8:o.next=1;break;case 9:case"end":return o.stop()}},Vi,this)}var zi=function(e){return Object(oi.e)(ii.a.mark(function t(){return ii.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e;case 3:return t.abrupt("return",t.sent);case 6:return t.prev=6,t.t0=t.catch(0),t.abrupt("return",null);case 9:case"end":return t.stop()}},t,this,[[0,6]])}))},Ri="",Di=Object(Wt.b)()?window.localStorage:Wt.a,qi={setItem:function(e,t){Di.setItem(Ri+e,t)},getItem:function(e){return Di.getItem(Ri+e)},removeItem:function(e){Di.removeItem(Ri+e)},setPrefix:function(e){Ri=e},removeOldSecretTokenCookie:function(e){document.cookie="secret_token_"+e+"=; expires=Thu, 01 Jan 1970 00:00:01 GMT;path=/licence/"+e+"/v2;domain=.livechatinc.com",document.cookie="secret_token_"+e+"=; expires=Thu, 01 Jan 1970 00:00:01 GMT;path=/licence/"+e+";domain=.livechatinc.com"}};function Li(e){return-1!==e.indexOf("cdn.livechatinc.com/cloud/?uri")?"https://"+O(e):"https://cdn.livechatinc.com/cloud/?uri=http://"+encodeURI(O(e))}function Fi(e){var t=e.agent;return{invitation:{id:e.unique_id,authorId:t.login,text:e.greeting_message.text,receivedFirstTime:e.displayed_first_time},agent:{avatarUrl:Li(t.avatar_url),jobTitle:t.job_title,name:t.name,id:t.login}}}var Ui,Bi,Gi=function(e,t){return e.order-t.order},Hi={question:{type:"text"},checkbox_for_email:{type:"checkbox",meta:"confirm_subscription"},header:{type:"information"},skill:{type:"group_select"}},Wi=function(e){return e.map(function(e,t){var n={};return Object(f.x)("label",e)&&(n.label=e.label),Object(f.x)("checked",e)&&(n.checked=e.checked),n.value=String(t),Object(f.x)("skill_id",e)&&(n.value=String(e.skill_id)),Object(f.x)("embedded_chat_hide_when_offline",e)&&(n.ticketFormDisabled=Boolean(e.embedded_chat_hide_when_offline)),n})},Yi=function(e){var t=!1,n={fields:e.fields.sort(Gi).map(function(e,n){var r={};if("facebookConnect"===e.type)return t=!0,!1;e.id?r.name=e.id:-1===["header","information"].indexOf(e.type)&&(r.name=String(n)),e.value&&(r.value=e.value),Object(f.x)("label",e)&&(r.label=e.label),Object(f.x)("required",e)&&(r.required=e.required),"rating"===e.type&&(r.commentLabel=e.options[0]),e.skills&&e.skills.length>0?r.options=Wi(e.skills):e.options&&e.options.length>0&&(e.options_data?r.options=Wi(e.options_data):Object(f.D)(e.options[0])?r.options=e.options.map(function(e,t){return{label:e.label,value:String(t)}}):r.options=e.options.map(function(e,t){return{label:e,value:String(t)}}));var a=function(e){return{type:Hi[e]&&Hi[e].type||e,meta:Hi[e]&&Hi[e].meta||!1}}(e.type),i=a.type,o=a.meta;return r.type=i,o&&(r.meta=o),r}).filter(Boolean)};return e.id&&(n.id=e.id),t&&(n.facebookConnect=!0),n},Ji=function(e){return Object(d.a)({},e,{fields:e.fields.map(function(e){return"email"===e.type||"textarea"===e.type?Object(d.a)({},e,{required:!0}):e})})},Qi=function(e,t,n){var r={survey_id:t.id},a=["name","question","email","checkbox","checkbox_for_email","radio","skill","select","textarea"],i=t.fields.map(function(r,a){var i,o,c={id:r.name,order:t.facebookConnect?a+1:a,type:(i=r.type,o=r.meta,void 0===o&&(o=!1),Object(f.m)(function(e){var t=e.type,n=e.meta;return t===i&&(!n||o===n)},Hi)||i)};return Object(f.x)("label",r)&&(c.label=r.label),Object(f.x)("options",r)?c.answers=r.options.map(function(t,a){var i={index:a};return Object(f.x)("label",t)&&(i.label=t.label),"skill"===c.type&&(i.group_id=parseInt(t.value,10)),"group_select"===r.type?i.chosen=parseInt(n,10)===a:i.chosen=e[r.name]&&(Array.isArray(e[r.name])&&-1!==e[r.name].indexOf(t.value)||"string"===typeof e[r.name]&&e[r.name]===t.value)||!1,i}):c.answer=e[r.name]||"",c}).filter(function(e){return-1!==a.indexOf(e.type)});return r.fields=i,r},Ki=function(e,t,n){void 0===n&&(n={});var r=new XMLHttpRequest,a=new Promise(function(a,i){var o=n,c=o.headers,s=o.method,u=void 0===s?"POST":s,d=o.onProgress,l=o.withCredentials,p=void 0!==l&&l;"function"===typeof d&&(r.upload.onprogress=function(e){d(e.loaded/e.total)}),r.onload=function(){var e;try{e=JSON.parse(r.response)}catch(t){e=r.response}r.status>=200&&r.status<300?a(e):i(new Error(e))},r.onerror=function(e){i(e)},r.onabort=function(){i(new Error("Upload cancelled."))},r.open(u,e),r.withCredentials=p,c&&Object.keys(c).forEach(function(e){return r.setRequestHeader(e,c[e])}),r.send(function(e){var t=new FormData;return Object.keys(e).forEach(function(n){return t.append(n,e[n])}),t}(t))});return{then:function(e,t){return a.then(e,t)},catch:function(e){return a.catch(e)},cancel:function(){r.abort()}}},Xi=((Ui={}).labs="-labs.",Ui.staging="-lc.",Ui.production=".",Ui),Zi=((Bi={}).labs="labs.",Bi.staging="staging.",Bi.production="",Bi),$i=function(e,t,n){var r=t;return 1520===n&&(r="staging"),"https://secure"+(e?"-"+e:"")+Xi[r]+"livechatinc.com"},eo=function(e,t,n){var r=t;return 1520===n&&(r="staging"),"https://api"+(e?"-"+e:"")+"."+Zi[r]+"livechatinc.com"},to=function(e,t,n){void 0===n&&(n={});var r=n.attempts||3,a=n.retryDelay||1e3;return new Promise(function(n,i){!function o(){var c;Object(p.a)(e,t).then(function(e){return n(e)}).catch(function(e){return r?(--r,setTimeout(function(){o()},a)):i(e)}),(c=15e3,new Promise(function(e){setTimeout(e,c)})).then(function(){i({type:"connection",reason:"Request timeout"})})}()})},no=function(e){var t=e.environment,n=e.region,r=e.license,a=e.token,i=e.file,o=e.chatId,c=e.onProgress,s=eo(n,t,r)+"/v2/chats/"+o+"/attachment",u=Ki(s,{"author[type]":"visitor",license_id:r,files:i,token:a},{onProgress:c});return u[ni.a]=u.cancel,u},ro=function(e,t,n){var r=t.environment,a=t.region,i=t.license,o=t.body,c=eo(a,r,i)+"/"+e;return to(c,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(o)},n).then(function(e){return e.json()})},ao=function(e,t){var n=t.environment,r=t.license,a=t.region,i=""+$i(a,n,r)+e;return to(i,{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"}).then(function(e){return e.json()})},io=function(e,t,n,r){return!1===t?"licence/g"+e+"_"+r:n?"licence/external/"+e:"licence/"+e},oo=function(e,t,n){var r=t.environment,a=t.license,i=t.body,o=void 0===i?{}:i,c=t.securedToken,s=t.secretId,u=t.region,l=t.queryStringData,p=void 0===l?{}:l,h=t.external,v=t.chatBetweenGroups,b=t.group,g=t.requestDistribution,_=!0===Object(f.u)(e,g)||-1!==e.indexOf("get_static_config")?"v2/":"",y={};c&&(y.secret_token=c),s&&(y.secret_id=s);var j=$i(u,r,a)+"/"+io(a,v,h,b)+"/"+_+e+"?"+m(Object(d.a)({},p,y));return to(j,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(o)},n).then(function(e){return e.text()}).then(function(e){return JSON.parse(e.replace(/[\x01-\x08\x0B\x0C\x0E-\x1F\x7F]/g,""))})},co=function(e,t){var n=t.environment,r=t.license,a=t.securedToken,i=t.secretId,o=t.region,c=t.external,s=t.group,u=t.chatBetweenGroups,d=$i(o,n,r)+"/"+io(r,u,c,s)+"/tunnel_callback.cgi?"+function(e){for(var t="",n="0123456789abcdefghijklmnopqurstuvwxyzABCDEFGHIJKLMNOPQURSTUVWXYZ",r=0;r<e;r++)t+=n.substr(Math.floor(Math.random()*n.length),1);return t}(20);return a&&(d+="&secret_token="+a),i&&(d+="&secret_id="+i),d+="&command="+encodeURI(e),to(d,{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"}).then(function(e){return e.text()}).then(function(e){return e.split("^")})},so=ii.a.mark(lo),uo=ii.a.mark(po);function lo(e,t){var n,r,a,i,o;return ii.a.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,Object(oi.j)(Xa.getPropertyChatBetweenGroups);case 2:return n=c.sent,c.next=5,Object(oi.j)(Xa.getPropertyGroup);case 5:return r=c.sent,"get_dynamic_config.js",c.t0=oi.c,c.t1=oo,c.t2="get_dynamic_config.js",c.t3=d.a,c.t4={},c.t5=e,c.t6=t,c.next=16,Object(oi.f)("external");case 16:return c.t7=c.sent,c.t8={queryStringData:c.t6,external:c.t7},c.t9=(0,c.t3)(c.t4,c.t5,c.t8),c.next=21,(0,c.t0)(c.t1,c.t2,c.t9);case 21:if(!(a=c.sent).error||"incorrect region"!==a.error){c.next=40;break}return c.next=25,Object(oi.h)(Pa.setPropertyRegion(a.region));case 25:return c.t10=oi.c,c.t11=lo,c.t12=d.a,c.t13={},c.t14=e,c.t15=a.region,c.next=33,Object(oi.f)("external");case 33:return c.t16=c.sent,c.t17={region:c.t15,external:c.t16},c.t18=(0,c.t12)(c.t13,c.t14,c.t17),c.next=38,(0,c.t10)(c.t11,c.t18);case 38:return i=c.sent,c.abrupt("return",i);case 40:if(!1!==n||a.visitor.groups===r){c.next=57;break}return c.next=43,Object(oi.h)(Pa.setPropertyGroup(a.visitor.groups));case 43:return c.t19=oi.c,c.t20=lo,c.t21=d.a,c.t22={},c.t23=e,c.next=50,Object(oi.f)("external");case 50:return c.t24=c.sent,c.t25={external:c.t24},c.t26=(0,c.t21)(c.t22,c.t23,c.t25),c.next=55,(0,c.t19)(c.t20,c.t26);case 55:return o=c.sent,c.abrupt("return",o);case 57:return c.abrupt("return",a);case 58:case"end":return c.stop()}},so,this)}function po(){var e,t,n,r,a,i,o;return ii.a.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,Object(oi.j)(Xa.getPropertyLicense);case 2:return e=c.sent,c.next=5,Object(oi.j)(Xa.getPropertyGroup);case 5:return t=c.sent,c.next=8,Object(oi.j)(Za);case 8:return n=c.sent,c.next=11,Object(oi.j)(Xa.getPropertyRegion);case 11:return r=c.sent,c.next=14,Object(oi.j)(ei);case 14:return a=c.sent,c.next=17,Object(oi.j)(Xa.getPropertyChatBetweenGroups);case 17:return i=c.sent,o={},a.pageUrl&&(o.url=a.pageUrl),"undefined"!==typeof t&&(o.groups=t),c.next=23,Object(oi.c)(lo,{environment:n,license:e,group:t,region:r,chatBetweenGroups:i},o);case 23:return c.abrupt("return",c.sent);case 24:case"end":return c.stop()}},uo,this)}var fo,mo=function(e){return"1"===e},ho=function(e){return e.replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&#94;/g,"^").replace(/&#45;/g,"-").replace(/&amp;/g,"&").replace(/<BR>/g,"\n")},vo=ho,bo=function(e){return JSON.parse(ho(e))},go=((fo={}).none="0",fo.bad="1",fo.good="2",fo),_o={NEW_AGENT:"newAgent",NEW_AGENT_MESSAGE:"newAgentMessage",CHAT_ENDED:"chatEnded",VISITOR_QUEUED:"visitorQueued",TYPING_INDICATOR:"typingIndicator",RATE_CHAT:"rateChat",FORWARD_CHAT_TRANSCRIPT:"forwardChatTranscript",AGENTS_OFFLINE:"agentsOffline",GET_FORM:"getForm",GET_CUSTOM_FORM:"getCustomForm",JSON:"JSON",INTEGRATION_DATA:"integrationData"},yo={IWCS5012F:[_o.AGENTS_OFFLINE,{}],IWCS5011F:[_o.AGENTS_OFFLINE,{}],IWCS0002R:[_o.NEW_AGENT,{1:["id"],2:["name",ho],12:["chatId"],23:["avatarUrl",ho],25:["jobTitle",ho]}],IWCS0006R:[_o.NEW_AGENT_MESSAGE,{1:["authorId"],2:["message",vo],9:["isMobile",mo],10:["id"],11:["json",function(e){if(!e)return null;try{return bo(e)}catch(t){return null}}]}],IWCS1007S:[_o.CHAT_ENDED,null],IWCS1002S:[_o.VISITOR_QUEUED,{2:["numberInQueue",parseInt],3:["waitingTime",parseInt]}],IWCS0002P:[_o.TYPING_INDICATOR,{2:["realCommand",function(e){var t=e.split("&#45;");return{authorId:t[1],isTyping:mo(t[2])}}]}],IWCS0113C:[_o.RATE_CHAT,{1:["visitorId"],2:["chatId"],3:["rate",function(e){return Object(f.k)(function(t){return go[t]===e},Object.keys(go))},function(e){return go[e]}]}],IWCS0069C:[_o.FORWARD_CHAT_TRANSCRIPT,{1:["visitorId"],2:["email"],5:["chatId"]}],IWCS0121C:[_o.GET_FORM,{1:["type",null,function(){return"1"}],2:["license"],4:["group"]}],IWCS0122C:[_o.GET_CUSTOM_FORM,{1:["license"],2:["type"],3:["group"]}],IWCSJSON:[_o.JSON,{1:["json",bo]}],IWCS0109R:[_o.INTEGRATION_DATA,{1:["integrationName"],2:["data",bo]}]},jo=function(e){var t=e.split("^"),n=t[0],r=t.slice(1),a=yo[n];if(!a)return null;var i=a[0],o=a[1];return{name:i,data:r.reduce(function(e,t,n){if(!o||!o[n+1])return e;var r=o[n+1],a=r[0],i=r[1],c=void 0===i?f.y:i;return"realCommand"===a?Object(d.a)({},e,c(t)):(e[a]=c(t),e)},{})}},Oo=function(e,t){for(var n,r=Object(f.m)(function(t){return t[0]===e},yo),a=yo[r][1],i=Math.max.apply(Math,Object.keys(a)),o=[r];o.length<i+1;){var c=a[o.length];if(c){var s=c[0],u=(n=String(t[s]),n.replace(/[\x01-\x08\x0B\x0C\x0E-\x1F\x7F]/g,"")).replace(/\^/g,"&#94;");c[2]?o.push(c[2](u)):o.push(u)}else o.push("")}return o.join("^")+"^"},wo=ii.a.mark(So),xo=ii.a.mark(To),Co=ii.a.mark(ko),Eo=ii.a.mark(Po),Io=ii.a.mark(Ao);function So(){var e;return ii.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(oi.b)({license:Object(oi.j)(Xa.getPropertyLicense),securedToken:Object(oi.j)(Xa.getPropertySecuredToken),secretId:Object(oi.j)(Xa.getPropertySecretId),environment:Object(oi.j)(Za),region:Object(oi.j)(Xa.getPropertyRegion),external:Object(oi.f)("external"),group:Object(oi.j)(Xa.getPropertyGroup),chatBetweenGroups:Object(oi.j)(Xa.getPropertyChatBetweenGroups),requestDistribution:Object(oi.j)(Xa.getPropertyRequestDistribution)});case 2:return e=t.sent,t.abrupt("return",e);case 4:case"end":return t.stop()}},wo,this)}function To(e,t,n){var r;return ii.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return void 0===n&&(n={}),a.next=3,Object(oi.c)(So);case 3:return r=a.sent,a.next=6,Object(oi.c)(oo,e,Object(d.a)({},r,{body:t}),n);case 6:return a.abrupt("return",a.sent);case 7:case"end":return a.stop()}},xo,this)}function ko(e){var t,n;return ii.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Object(oi.c)(So);case 2:return t=r.sent,r.next=5,Object(oi.c)(ao,e,t);case 5:return n=r.sent,r.abrupt("return",n);case 7:case"end":return r.stop()}},Co,this)}function Po(e,t){var n,r;return ii.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return n=Oo(e,t),a.next=3,Object(oi.c)(So);case 3:return r=a.sent,a.next=6,Object(oi.c)(co,n,r);case 6:return a.abrupt("return",a.sent);case 7:case"end":return a.stop()}},Eo,this)}function Ao(e,t){var n,r,a,i;return ii.a.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,Object(oi.c)(So);case 2:return n=o.sent,r=n.license,a=n.environment,i=n.region,o.next=6,Object(oi.c)(ro,e,{environment:a,region:i,license:r,body:t});case 6:return o.abrupt("return",o.sent);case 7:case"end":return o.stop()}},Io,this)}var No=ii.a.mark(Vo);function Vo(e,t){var n;return ii.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return n={},r.next=3,Object(oi.c)(To,"get_static_config."+e+"."+t+".js",n);case 3:return r.abrupt("return",r.sent);case 4:case"end":return r.stop()}},No,this)}var Mo=ii.a.mark(Ho),zo=ii.a.mark(Jo),Ro=ii.a.mark(Qo),Do=ii.a.mark(Ko),qo=ii.a.mark(Xo),Lo=ii.a.mark(Zo),Fo=ii.a.mark($o),Uo=ii.a.mark(ec),Bo=function(e){var t={};try{t=JSON.parse(e)}catch(n){}return t},Go=function(e){var t,n,r="1"===e.group_properties.chat_window.custom_mobile_settings,a={visitorData:Object(f.G)(f.b,e.visitor),features:{fileSharing:{enabled:e.attachments.enable_for_visitors},agentAvatar:{enabled:e.chat_window.display_avatar,showWithMessage:e.chat_window.display_avatar&&"modern"!==Object(f.u)("group_properties.chat_window.new_theme.name",e)},rating:{enabled:e.chat_window.display_rating,position:"modern"===Object(f.u)("group_properties.chat_window.new_theme.name",e)?"bottom":"right"},emailTranscript:{enabled:e.chat_window.display_transcript_button},logo:{enabled:e.chat_window.logo.display,path:Li(e.chat_window.logo.path)},facebookButton:{enabled:Boolean(e.chat_window.social.facebook)},twitterButton:{enabled:Boolean(e.chat_window.social.twitter)},googlePlusButton:{enabled:Boolean(e.chat_window.social.plusone)},offlineForm:{enabled:!e.embedded_chat.hide_when_offline},linksPreview:{enabled:"1"===e.group_properties.links_unfurling},preChatForm:{enabled:e.pre_chat_survey&&e.pre_chat_survey.enabled||!1},preChatAfterGreeting:{enabled:"1"===e.group_properties.pre_chat_survey_after_greeting},creditCardMasking:{enabled:e.mask_credit_cards},hideTrademark:{enabled:"1"===e.group_properties.chat_window.hide_trademark},hideOnMobile:{enabled:"1"===e.group_properties.chat_window.hide_on_mobile},hideOnInit:{enabled:"1"===e.group_properties.chat_window.hide_on_init},disableSounds:{enabled:"1"===e.group_properties.chat_window.disable_sounds},minimized:{enabled:"0"===e.group_properties.chat_window.disable_minimized},mobileMinimized:{enabled:r?"0"===e.group_properties.chat_window.mobile_disable_minimized:"0"===e.group_properties.chat_window.disable_minimized}},buttons:e.buttons.map(function(e){return{id:e.id,type:e.type,onlineImage:Li(e.online_value),offlineImage:Li(e.offline_value)}}),theme:{color:e.chat_window.theme.color,name:e.chat_window.theme.name,minimized:e.group_properties.chat_window.theme.minimized,mobileMinimized:r?e.group_properties.chat_window.mobile_minimized_theme:e.group_properties.chat_window.theme.minimized},newTheme:{name:e.group_properties.chat_window.new_theme.name,iconTheme:"modern"===e.group_properties.chat_window.new_theme.name?"modern":"smooth",agentMessageBackgroundColor:Object(f.v)("#fffff","group_properties.chat_window.new_theme.agent_message_color_background",e),agentMessageColorText:Object(f.v)("#424d57","group_properties.chat_window.new_theme.agent_message_color_text",e),backgroundColor:Object(f.v)("#e9eef4","group_properties.chat_window.new_theme.background_color",e),minimizedColorBackground:Object(f.v)("#ffffff","group_properties.chat_window.new_theme.minimized_color_background",e),minimizedColorIcon:Object(f.v)("#4384F5","group_properties.chat_window.new_theme.minimized_color_icon",e),minimizedColorText:Object(f.v)("#000000","group_properties.chat_window.new_theme.minimized_color_text",e),visitorMessageBackgroundColor:Object(f.v)("#4384f5","group_properties.chat_window.new_theme.visitor_message_color_background",e),visitorMessageColorText:Object(f.v)("#ffffff","group_properties.chat_window.new_theme.visitor_message_color_text",e),titlebarBackgroundColor:Object(f.v)("#ffffff","group_properties.chat_window.new_theme.titlebar_background_color",e),titlebarText:Object(f.v)("#424d57","group_properties.chat_window.new_theme.titlebar_text",e),systemMessageColor:Object(f.v)("#424d57","group_properties.chat_window.new_theme.system_message_color",e),agentbarBackgroundColor:Object(f.v)("#ffffff","group_properties.chat_window.new_theme.agentbar_background_color",e),agentbarText:Object(f.v)("#424d57","group_properties.chat_window.new_theme.agentbar_text",e),ctaColor:Object(f.v)("#427fe1","group_properties.chat_window.new_theme.cta_color",e),customJson:Bo(Object(f.u)("group_properties.chat_window.new_theme.custom_json",e))},domainWhitelist:e.domain_whitelist,widgetType:e.embedded_chat.enabled?"embedded":"popup",integrations:e.integrations,language:e.lang,groups:(t=e.skills,n=e.skills_online,Object(f.E)("id",t.map(function(e){return{id:e.id,status:-1!==n.indexOf(e.id)?"online":"offline",oldButtons:{onlineImage:Li(e.chat_button.online_url),offlineImage:Li(e.chat_button.offline_url)}}}))),clientLimitExceeded:e.client_limit_exceeded,screenPosition:e.group_properties.chat_window.screen_position,mobileScreenPosition:r?e.group_properties.chat_window.mobile_screen_position:e.group_properties.chat_window.screen_position};return a.features.facebookButton.enabled&&(a.features.facebookButton.path=e.chat_window.social.facebook),a.features.twitterButton.enabled&&(a.features.facebookButton.path=e.chat_window.social.twitter),a.features.googlePlusButton.enabled&&(a.features.facebookButton.path=e.chat_window.social.plusone),a};function Ho(e){var t,n,r;return ii.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Object(oi.h)(Pa.setPropertyTicketForm(Ji(Yi(e.offline_form))));case 2:return a.next=4,Object(oi.f)("external");case 4:if(t=a.sent,!e.pre_chat_survey){a.next=9;break}return n=Yi(e.pre_chat_survey),a.next=9,Object(oi.h)(Pa.setPropertyPreChatForm(n));case 9:return r=t?e.localization_url.replace("/licence/","/licence/external/"):e.localization_url,a.next=12,Object(oi.h)(Pa.setPropertyTranslationsVersion(r));case 12:return a.next=14,Object(oi.h)(Pa.setPropertyConfigLoaded(!0));case 14:case"end":return a.stop()}},Mo,this)}var Wo={labs:"labs",staging:"staging",production:"prod"},Yo=function(e,t){var n=t.split(",").map(function(e){return e.split(":")}),r=Object(f.r)(n);return Object(f.H)(function(t){if(!t)return!1;var n=parseFloat(t);return!(n<1&&e)&&n>Math.random()},r)};function Jo(e){var t,n,r,a,i,o,c;return ii.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,Object(oi.j)(Za);case 2:return t=s.sent,n=Wo[t],r=e.global_properties[n].requests_distribution,a=!1===e.t,i=Yo(a,r),s.next=9,Object(oi.h)(Pa.setPropertyRequestDistribution(i));case 9:return o=Go(e),s.next=12,Object(oi.j)(Xa.getPropertyGroup);case 12:if(c=s.sent,-1===e.skills_online.indexOf(c)){s.next=18;break}return s.next=16,Object(oi.h)(Pa.setPropertyChatStatus("ONLINE"));case 16:s.next=20;break;case 18:return s.next=20,Object(oi.h)(Pa.setPropertyChatStatus("OFFLINE"));case 20:return s.next=22,Object(oi.h)(Pa.setPropertyConfig(o));case 22:case"end":return s.stop()}},zo,this)}function Qo(){var e,t,n,r,a;return ii.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,Object(oi.c)(Mi,Xa.getPropertyStaticConfigVersion);case 2:return e=i.sent,i.next=5,Object(oi.j)(Xa.getPropertyGroup);case 5:return t=i.sent,i.next=8,Object(oi.c)(Vo,t,e);case 8:return n=i.sent,i.next=11,Object(oi.c)(Ho,n);case 11:return i.next=13,Object(oi.j)(Xa.getPropertyDynamicConfig);case 13:return r=i.sent,a=Object(d.a)({},r,n),i.next=17,Object(oi.c)(Jo,a);case 17:case"end":return i.stop()}},Ro,this)}function Ko(){var e,t,n;return ii.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Object(oi.c)(Mi,Xa.getPropertyTranslationsVersion);case 2:return e=r.sent,r.next=5,Object(oi.c)(ko,e);case 5:return t=r.sent,n=Object(f.G)(function(e){return e.toLowerCase()},t.localization),r.next=9,Object(oi.h)(Pa.setPropertyTranslations(n));case 9:case"end":return r.stop()}},Do,this)}function Xo(e){var t,n,r,a;return ii.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,Object(oi.j)(ei);case 2:return t=i.sent,i.next=5,Object(oi.j)(Xa.getPropertyVisitorId);case 5:if(n=i.sent,r=Object(d.a)({},t),"undefined"===typeof e.visitor.groups){i.next=10;break}return i.next=10,Object(oi.h)(Pa.setPropertyGroup(e.visitor.groups));case 10:return i.next=12,Object(oi.h)(Pa.setPropertyStaticConfigVersion(e.static_config_version));case 12:if((t.name||e.visitor.nick)&&(r.name=t.name||e.visitor.nick),(a=r.customProperties||e.visitor.params&&h(e.visitor.params))&&(r.customProperties=a),!e.visitor.nick&&!e.visitor.params){i.next=18;break}return i.next=18,Object(oi.h)(Ua({visitorData:r}));case 18:if(n){i.next=22;break}return i.next=21,Object(oi.h)(Pa.setPropertyVisitorId(e.visitor.session));case 21:qi.setItem("visitorId",e.visitor.session);case 22:case"end":return i.stop()}},qo,this)}function Zo(e){var t,n,r;return ii.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Object(oi.c)(Xo,e);case 2:return a.next=4,Object(oi.h)(Pa.setPropertyDynamicConfig(e));case 4:return a.next=6,Object(oi.h)(Pa.setPropertyClientLimitExceeded(e.client_limit_exceeded));case 6:if(!e.automatic_greeting){a.next=12;break}return t=Fi(e.automatic_greeting),n=t.agent,r=t.invitation,a.next=10,Object(oi.h)(Ma(n));case 10:return a.next=12,Object(oi.h)(Wa(r));case 12:case"end":return a.stop()}},Lo,this)}function $o(){var e,t,n,r;return ii.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Object(oi.c)(po);case 2:return e=a.sent,t=e.static_config_version,n=e.visitor.groups,a.next=7,Object(oi.c)(Vo,n,t);case 7:if(r=a.sent,"3"!==r.license_properties.lc_version){a.next=12;break}return a.next=12,Object(oi.h)(Ja());case 12:case"end":return a.stop()}},Fo,this)}function ec(e){var t;return ii.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!e){n.next=8;break}return n.next=3,Object(oi.c)(Zo,e);case 3:return n.next=5,Object(oi.c)(Ho,e);case 5:return n.next=7,Object(oi.c)(Jo,e);case 7:return n.abrupt("return");case 8:return n.next=10,Object(oi.c)(po);case 10:return t=n.sent,n.next=13,Object(oi.c)(Zo,t);case 13:return n.next=15,Object(oi.c)(Qo);case 15:case"end":return n.stop()}},Uo,this)}var tc="CHATTING",nc="NOT_CHATTING",rc=ii.a.mark(ac);function ac(e){var t,n,r,a,i;return ii.a.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return t=e.customId,n=e.text,r=e.json,o.next=3,Object(oi.c)(Mi,Xa.getPropertyVisitorId);case 3:return a=o.sent,i={author:"visitor",message:n,message_id:t,random_id:t,visitor:{id:a}},r&&(i.message_json=JSON.stringify(r)),o.next=8,Object(oi.c)(To,"send_message",i);case 8:return o.next=10,Object(oi.h)({type:"PRIVATE_SEND_MESSAGE"});case 10:case"end":return o.stop()}},rc,this)}var ic=ii.a.mark(oc);function oc(){var e,t;return ii.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(oi.c)(Mi,Xa.getPropertyVisitorId);case 2:return e=n.sent,t={source:"visitor",random_id:String(Math.random()),visitor:{id:e}},n.next=6,Object(oi.c)(To,"close_chat",t);case 6:return n.abrupt("return",n.sent);case 7:case"end":return n.stop()}},ic,this)}var cc=ii.a.mark(sc);function sc(e){var t,n,r;return ii.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Object(oi.c)(Mi,Xa.getPropertyVisitorId);case 2:return t=a.sent,a.next=5,Object(oi.j)(Xa.getPropertyChatId);case 5:return n=a.sent,r={visitorId:t,chatId:n,email:e.payload.email},a.next=9,Object(oi.c)(Po,"forwardChatTranscript",r);case 9:return a.abrupt("return",a.sent);case 10:case"end":return a.stop()}},cc,this)}var uc=ii.a.mark(dc);function dc(e){var t,n,r;return ii.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Object(oi.c)(Mi,Xa.getPropertyVisitorId);case 2:return t=a.sent,a.next=5,Object(oi.j)(Xa.getPropertyChatId);case 5:return n=a.sent,r={visitorId:t,chatId:n,rate:e.payload.rate},a.next=9,Object(oi.c)(Po,"rateChat",r);case 9:return a.abrupt("return",a.sent);case 10:case"end":return a.stop()}},uc,this)}var lc=ii.a.mark(pc);function pc(e){var t,n;return ii.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Object(oi.j)(Xa.getPropertyLicense);case 2:return t=r.sent,n={license:t,type:"offline",group:e},r.next=6,Object(oi.c)(Po,"getCustomForm",n);case 6:return r.abrupt("return",r.sent);case 7:case"end":return r.stop()}},lc,this)}var fc=ii.a.mark(mc);function mc(){var e,t,n;return ii.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Object(oi.j)(Xa.getPropertyLicense);case 2:return e=r.sent,r.next=5,Object(oi.j)(Xa.getPropertyGroup);case 5:return t=r.sent,n={license:e,type:"queued",group:t},r.next=9,Object(oi.c)(Po,"getCustomForm",n);case 9:return r.abrupt("return",r.sent);case 10:case"end":return r.stop()}},fc,this)}var hc=ii.a.mark(vc);function vc(e){var t,n,r;return ii.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Object(oi.c)(Mi,Xa.getPropertyVisitorId);case 2:return t=a.sent,a.next=5,Object(oi.j)(Xa.getPropertyChatId);case 5:return n=a.sent,r={comment:e.payload.comment,conference_id:n,random_id:String(Math.random()),visitor:{id:t}},a.next=9,Object(oi.c)(To,"send_rating_comment",r);case 9:return a.abrupt("return",a.sent);case 10:case"end":return a.stop()}},hc,this)}var bc=ii.a.mark(yc),gc=function(e,t,n){var r=e.group,a=e.license,i=e.visitorId,o=e.visitorData,c=function(e,t){var n=Object(f.G)(function(e){return"message"===e?"textarea":e},e);return t.fields.map(function(e){if("information"===e.type)return null;var t={type:e.type,text:e.label};return(Object(f.x)(e.name,n)||Object(f.x)(e.type,n))&&(t.value=Object(f.x)("options",e)?Object(f.i)(n[e.name]).map(function(t){return Object(f.k)(function(e){return e.value===t},e.options).label}).join(", "):n[e.name]||n[e.type],t.text=t.text+" "+t.value),t}).filter(Boolean)}(n,t),s=Object(f.k)(function(e){return"email"===e.type},c);if(!s)throw{type:"missing argument",reason:"Missing email"};if(!Object(f.k)(function(e){return"textarea"===e.type},c))throw{type:"missing argument",reason:"Missing message"};var u=Object(f.k)(function(e){return"subject"===e.type},c),d=c.filter(function(e){var t=e.type;return-1===["name","email","subject"].indexOf(t)}).map(function(e){return e.text}).join("\n"),l={mail:s.value},p=Object(f.k)(function(e){return"name"===e.type},c);p&&(l.name=p.value);var m={group:r,licence_id:a,ticket_message:d,offline_message:c.map(function(e){return e.text}).join("\n"),requester:l,visitor_id:i};return u&&(m.subject=u.value),o.pageUrl&&(m.source={url:o.pageUrl}),m},_c=function(e,t){var n={id:e,text:t.ticket_message,visitor:{name:t.requester.name||null,email:t.requester.mail||null}};return t.subject&&(n.subject=t.subject),n};function yc(e){var t,n,r,a,i,o,c,s;return ii.a.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,Object(oi.j)(Xa.getPropertyGroup);case 2:return t=u.sent,u.next=5,Object(oi.j)(Xa.getPropertyLicense);case 5:return n=u.sent,u.next=8,Object(oi.c)(Mi,Xa.getPropertyVisitorId);case 8:return r=u.sent,u.next=11,Object(oi.j)(ei);case 11:return a=u.sent,u.next=14,Object(oi.j)(Xa.getPropertyTicketForm);case 14:return i=u.sent,o=gc({group:t,license:n,visitorId:r,visitorData:a},i,e.answers),u.next=18,Object(oi.c)(Ao,"v2/tickets/new",o);case 18:return c=u.sent,s=c.id,u.abrupt("return",_c(s,o));case 21:case"end":return u.stop()}},bc,this)}var jc=ii.a.mark(Oc);function Oc(e){var t,n,r,a;return ii.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,Object(oi.c)(Mi,Xa.getPropertyVisitorId);case 2:return t=i.sent,n=e.customId,i.next=6,Object(oi.c)(Mi,Xa.getPropertyChatId);case 6:return r=i.sent,a={random_id:n,conference_id:r,visitor:{id:t},valid_time_sec:60},i.next=10,Object(oi.c)(To,"attachment_token",a);case 10:return i.abrupt("return",i.sent);case 11:case"end":return i.stop()}},jc,this)}var wc=ii.a.mark(xc);function xc(){var e,t,n;return ii.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Object(oi.j)(Xa.getPropertyLicense);case 2:return e=r.sent,r.next=5,Object(oi.j)(Xa.getPropertyGroup);case 5:return t=r.sent,n={type:"postchat",license:e,group:t},r.next=9,Object(oi.c)(Po,"getForm",n);case 9:return r.abrupt("return",r.sent);case 10:case"end":return r.stop()}},wc,this)}var Cc=ii.a.mark(Ec);function Ec(e){var t,n,r,a;return ii.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return t=e.answers,i.next=3,Object(oi.j)(Xa.getPropertyVisitorId);case 3:return n=i.sent,i.next=6,Object(oi.j)(Xa.getPropertyChatId);case 6:return r=i.sent,a={conference_id:r,random_id:String(Math.random()),survey:t,visitor:{id:n}},i.next=10,Object(oi.c)(To,"post_chat_survey_data",a);case 10:return i.abrupt("return",i.sent);case 11:case"end":return i.stop()}},Cc,this)}var Ic=ii.a.mark(Sc);function Sc(){var e,t;return ii.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(oi.c)(Mi,Xa.getPropertyVisitorId);case 2:return e=n.sent,t={random_id:String(Math.random()),visitor:{id:e}},n.next=6,Object(oi.c)(To,"get_predicted_agent",t);case 6:return n.abrupt("return",n.sent);case 7:case"end":return n.stop()}},Ic,this)}var Tc=ii.a.mark(kc);function kc(e){var t,n,r,a,i,o,c;return ii.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return t=e.messageId,s.next=3,Object(oi.c)(Mi,Xa.getPropertyVisitorId);case 3:return n=s.sent,s.next=6,Object(oi.j)(Xa.getPropertyServerIdsMap);case 6:return r=s.sent,a=r[t],i=a.serverId,o=a.authorId,c={message:{id:i,agent_id:o},random_id:String(Math.random()),visitor:{id:n}},s.next=11,Object(oi.c)(To,"agent_message_seen",c);case 11:return s.abrupt("return",s.sent);case 12:case"end":return s.stop()}},Tc,this)}var Pc=ii.a.mark(Ac);function Ac(e){var t,n,r;return ii.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if("undefined"===typeof e){a.next=4;break}a.t0=e,a.next=7;break;case 4:return a.next=6,Object(oi.j)(Xa.getPropertyGroup);case 6:a.t0=a.sent;case 7:return t=a.t0,a.next=10,Object(oi.c)(Mi,Xa.getPropertyVisitorId);case 10:return n=a.sent,r={visitor:{id:n},skill:t,random_id:String(Math.random())},a.next=14,Object(oi.c)(To,"status_ping",r,{retry:10});case 14:return a.abrupt("return",a.sent);case 15:case"end":return a.stop()}},Pc,this)}var Nc=function(e){return{chatState:e.visitor_is_chatting?tc:nc,chatStatus:e.agent_available?"ONLINE":"OFFLINE"}},Vc=ii.a.mark(Ms),Mc=ii.a.mark(zs),zc=ii.a.mark(Rs),Rc=ii.a.mark(Ds),Dc=ii.a.mark(qs),qc=ii.a.mark(Ls),Lc=ii.a.mark(Fs),Fc=ii.a.mark(Us),Uc=ii.a.mark(Bs),Bc=ii.a.mark(Gs),Gc=ii.a.mark(Hs),Hc=ii.a.mark(Ws),Wc=ii.a.mark(Ys),Yc=ii.a.mark(Js),Jc=ii.a.mark(Qs),Qc=ii.a.mark(Ks),Kc=ii.a.mark(eu),Xc=ii.a.mark(tu),Zc=ii.a.mark(nu),$c=ii.a.mark(ru),es=ii.a.mark(au),ts=ii.a.mark(iu),ns=ii.a.mark(ou),rs=ii.a.mark(cu),as=ii.a.mark(su),is=ii.a.mark(uu),os=ii.a.mark(du),cs=ii.a.mark(lu),ss=ii.a.mark(pu),us=ii.a.mark(fu),ds=18e5,ls=ci,ps=si,fs=ui,ms=di,hs=li,vs=pi,bs=fi,gs=mi,_s=hi,ys=vi,js=bi,Os=_i,ws=yi,xs=ji,Cs=Oi,Es=wi,Is=xi,Ss=Ci,Ts=Ei,ks=Ii,Ps=Si,As=Ti,Ns=ki,Vs=Pi;function Ms(){var e;return ii.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(oi.j)(Xa.getPropertyTranslations);case 2:if(!(e=t.sent)){t.next=5;break}return t.abrupt("return",e);case 5:return t.next=7,Object(oi.c)(Ko);case 7:return t.next=9,Object(oi.j)(Xa.getPropertyTranslations);case 9:return t.abrupt("return",t.sent);case 10:case"end":return t.stop()}},Vc,this)}function zs(){var e;return ii.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(oi.j)(Xa.getPropertyWelcomeMessage);case 2:if(!(e=t.sent)){t.next=5;break}return t.abrupt("return",e);case 5:return t.next=7,Object(oi.c)(Ms);case 7:return t.abrupt("return",t.sent.welcome_to_chat);case 8:case"end":return t.stop()}},Mc,this)}function Rs(e){var t,n,r,a,i,o,c,s,u,d,l;return ii.a.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return u=function(){return ii.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(oi.l)(function(e){return e.type===Na.getActionName()&&Object(f.u)("payload.customId",e)===a});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},t,this)},t=ii.a.mark(u),p.next=4,Object(oi.c)(Mi,Xa.getPropertyChatState);case 4:return n=p.sent,r=e.payload,a=r.customId,i=r.text,o=r.json,c=n!==tc,p.next=9,Object(oi.j)(Xa.getPropertyAcceptedInvitation);case 9:return s=p.sent,p.next=12,Object(oi.e)(u);case 12:if(d=p.sent,p.prev=13,!c){p.next=28;break}return p.t0=oi.c,p.t1=hu,p.t2=a,p.t3=i,p.next=21,Object(oi.c)(zs);case 21:return p.t4=p.sent,p.t5=s,p.t6={customId:p.t2,text:p.t3,welcomeMessage:p.t4,acceptedInvitation:p.t5},p.next=26,(0,p.t0)(p.t1,p.t6);case 26:p.next=30;break;case 28:return p.next=30,Object(oi.c)(ac,{customId:a,text:i,json:o});case 30:p.next=38;break;case 32:return p.prev=32,p.t7=p.catch(13),e.payload.promise.reject({type:"connection",reason:"Request failed"}),p.next=37,Object(oi.d)(d);case 37:return p.abrupt("return");case 38:if(!c){p.next=45;break}return p.next=41,Object(oi.l)([Ma.getActionName(),Va.getActionName()]);case 41:if(p.sent.type!==Va.getActionName()){p.next=45;break}return e.payload.promise.reject({type:"state",reason:"Chat is offline"}),p.abrupt("return");case 45:return p.next=47,Object(oi.g)(d);case 47:l=p.sent,e.payload.promise.resolve({id:l.payload.id,timestamp:l.payload.timestamp});case 49:case"end":return p.stop()}},zc,this,[[13,32]])}function Ds(e){var t,n,r,a,i,o;return ii.a.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,Object(oi.c)(Mi,Xa.getPropertyClientLimitExceeded);case 2:return c.next=4,Object(oi.j)(ei);case 4:return t=c.sent,n=Object(f.P)(["customProperties"],t),r=Object(f.Q)(f.C,Object(f.T)(["name","email","pageUrl","pageTitle","customProperties"],e.payload)),a=String(Math.random()),i=e.payload.update?Object(f.L)(t,r):Object(f.L)(n,r),c.next=11,Object(oi.h)(Ua({requestId:a,visitorData:i}));case 11:return c.next=13,Object(oi.l)(function(e){return(e.type===za.getActionName()||e.type===Ra.getActionName())&&e.payload.requestId===a});case 13:if((o=c.sent).type!==za.getActionName()){c.next=16;break}return c.abrupt("return",e.payload.promise.resolve(o.payload.visitorData));case 16:return c.abrupt("return",e.payload.promise.reject({type:"connection",reason:"Request failed"}));case 17:case"end":return c.stop()}},Rc,this)}function qs(e){return ii.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(oi.h)(Pa.setPropertySneakPeek(e.payload.text));case 2:e.payload.promise.resolve({success:!0});case 3:case"end":return t.stop()}},Dc,this)}function Ls(e){return ii.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(oi.j)(Xa.getPropertyChatId);case 2:if(t.sent){t.next=6;break}return e.payload.promise.reject({type:"state",reason:"There is no chat to forward transcript"}),t.abrupt("return");case 6:return t.prev=6,t.next=9,Object(oi.c)(sc,e);case 9:t.next=15;break;case 11:return t.prev=11,t.t0=t.catch(6),e.payload.promise.reject({type:"connection",reason:"Request failed"}),t.abrupt("return");case 15:e.payload.promise.resolve({success:!0});case 16:case"end":return t.stop()}},qc,this,[[6,11]])}function Fs(e){return ii.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(oi.j)(Xa.getPropertyChatId);case 2:if(t.sent){t.next=6;break}return e.payload.promise.reject({type:"state",reason:"There is no chat to close"}),t.abrupt("return");case 6:return t.prev=6,t.next=9,Object(oi.c)(oc);case 9:t.next=15;break;case 11:return t.prev=11,t.t0=t.catch(6),e.payload.promise.reject({type:"connection",reason:"Request failed"}),t.abrupt("return");case 15:return t.next=17,Object(oi.l)(Va.getActionName());case 17:e.payload.promise.resolve({success:!0});case 18:case"end":return t.stop()}},Lc,this,[[6,11]])}function Us(e){return ii.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(oi.j)(Xa.getPropertyChatId);case 2:if(t.sent){t.next=6;break}return e.payload.promise.reject({type:"state",reason:"There is no chat to rate"}),t.abrupt("return");case 6:if(!e.payload.rate){t.next=16;break}return t.prev=7,t.next=10,Object(oi.c)(dc,e);case 10:t.next=16;break;case 12:return t.prev=12,t.t0=t.catch(7),e.payload.promise.reject({type:"connection",reason:"Request failed"}),t.abrupt("return");case 16:if(!e.payload.comment){t.next=26;break}return t.prev=17,t.next=20,Object(oi.c)(vc,e);case 20:t.next=26;break;case 22:return t.prev=22,t.t1=t.catch(17),e.payload.promise.reject({type:"connection",reason:"Rate Comment request failed"}),t.abrupt("return");case 26:e.payload.promise.resolve({success:!0});case 27:case"end":return t.stop()}},Fc,this,[[7,12],[17,22]])}function Bs(e){var t;return ii.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t=e.payload,n.next=3,Object(oi.j)(Xa.getPropertyChatState);case 3:if(n.sent!==tc){n.next=7;break}return t.promise.reject({type:"state",reason:"You can't disconnect during the chat"}),n.abrupt("return");case 7:t.promise.resolve({success:!0});case 8:case"end":return n.stop()}},Uc,this)}function Gs(e){var t,n,r,a,i,o;return ii.a.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(t=e.payload,n=t.promise,"undefined"===typeof(r=t.group)){c.next=15;break}return c.prev=3,c.next=6,Object(oi.c)(pc,r);case 6:a=c.sent,i=jo(a.join("^")),n.resolve(Ji(Yi(i.data.json))),c.next=14;break;case 11:c.prev=11,c.t0=c.catch(3),n.reject({type:"connection",reason:"Request failed"});case 14:return c.abrupt("return");case 15:return c.next=17,Object(oi.c)(Mi,Xa.getPropertyTicketForm);case 17:o=c.sent,n.resolve(o);case 19:case"end":return c.stop()}},Bc,this,[[3,11]])}function Hs(e){var t,n,r,a;return ii.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return t=e.payload,n=t.promise,i.prev=2,i.next=5,Object(oi.c)(mc);case 5:r=i.sent,a=jo(r.join("^")),n.resolve(Yi(a.data.json)),i.next=13;break;case 10:i.prev=10,i.t0=i.catch(2),n.reject({type:"connection",reason:"Request failed"});case 13:case"end":return i.stop()}},Gc,this,[[2,10]])}function Ws(e){var t,n;return ii.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return t=e.payload,r.prev=1,r.next=4,Object(oi.c)(Ms);case 4:return n=r.sent,r.abrupt("return",t.promise.resolve(n));case 8:return r.prev=8,r.t0=r.catch(1),r.abrupt("return",t.promise.reject({type:"connection",reason:"Request failed"}));case 11:case"end":return r.stop()}},Hc,this,[[1,8]])}function Ys(e){var t,n;return ii.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return t=e.payload,r.next=3,Object(oi.c)(Mi,Xa.getPropertyVisitorId);case 3:return r.next=5,Object(oi.j)(ei);case 5:return n=r.sent,r.abrupt("return",t.promise.resolve(n));case 7:case"end":return r.stop()}},Wc,this)}function Js(e){var t;return ii.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t=e.payload,n.next=3,Object(oi.c)(Mi,Xa.getPropertyTicketForm);case 3:return n.prev=3,n.t0=t.promise,n.next=7,Object(oi.c)(yc,t);case 7:n.t1=n.sent,n.t0.resolve.call(n.t0,n.t1),n.next=14;break;case 11:n.prev=11,n.t2=n.catch(3),t.promise.reject(n.t2.reason?n.t2:{type:"connection",reason:"Request failed"});case 14:case"end":return n.stop()}},Yc,this,[[3,11]])}function Qs(){var e,t,n;return ii.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Object(oi.c)(Mi,Xa.getPropertyConfigLoaded);case 2:return r.next=4,Object(oi.j)(Xa.getPropertyPreChatForm);case 4:return e=r.sent,r.next=7,Object(oi.j)(ei);case 7:if(t=r.sent,e){r.next=10;break}return r.abrupt("return",null);case 10:return(t.name||t.email)&&(n=e.fields.map(function(e){return"name"===e.type&&t.name&&(e.defaultValue=t.name),"email"===e.type&&t.email&&(e.defaultValue=t.email),e}),e.fields=n),r.abrupt("return",e);case 12:case"end":return r.stop()}},Jc,this)}function Ks(e){var t,n;return ii.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return t=e.payload,r.prev=1,r.next=4,Object(oi.c)(Qs);case 4:if(n=r.sent){r.next=7;break}return r.abrupt("return",t.promise.reject({type:"state",reason:"Pre-chat survey is turned off"}));case 7:return r.abrupt("return",t.promise.resolve(n));case 10:return r.prev=10,r.t0=r.catch(1),r.abrupt("return",t.promise.reject({type:"connection",reason:"Request failed"}));case 13:case"end":return r.stop()}},Qc,this,[[1,10]])}var Xs=["email","text","radio","select","group_select"],Zs=["checkbox"],$s=function(e,t){return e.map(function(e){var n=t[e.name],r=typeof t[e.name];return e.required&&!n?{reason:"Required field",description:"Pease fill in required field",field:e.name}:n&&-1!==Xs.indexOf(e.type)&&"string"!==r?{reason:"Wrong type",field:e.name}:!(!n||-1===Zs.indexOf(e.type)||Array.isArray(n))&&{reason:"Wrong type",field:e.name}}).filter(Boolean)};function eu(e){var t,n,r,a,i,o,c,s,u,p,f,m,h;return ii.a.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return t=e.payload,v.next=3,Object(oi.c)(Mi,Xa.getPropertyChatState);case 3:if(n=v.sent,v.prev=4,n!==tc){v.next=7;break}return v.abrupt("return",t.promise.reject({type:"state",reason:"You can't send prechat when chat is running"}));case 7:return v.next=9,Object(oi.j)(ei);case 9:return r=v.sent,v.next=12,Object(oi.c)(Qs);case 12:return a=v.sent,i=t.answers,o=t.promise,c=i.choosenGroupIndex,s=Object(l.a)(i,["choosenGroupIndex"]),v.next=17,Object(oi.j)(Xa.getPropertyAcceptedInvitation);case 17:if(u=v.sent,p=Qi(s,a,c),0===(f=$s(a.fields,s)).length){v.next=22;break}return v.abrupt("return",t.promise.reject({type:"wrong arguments",fields:f}));case 22:if(!(m=p.fields.filter(function(e){return"email"===e.type||"name"===e.type}))){v.next=27;break}return h=m.reduce(function(e,t){var n;return Object(d.a)({},e,((n={})[t.type]=t.answer,n))},r),v.next=27,Object(oi.h)(Ua({visitorData:h}));case 27:return v.t0=oi.c,v.t1=hu,v.t2=p,v.next=32,Object(oi.c)(zs);case 32:return v.t3=v.sent,v.t4=u,v.t5={customId:"prechat_startchat",answers:v.t2,welcomeMessage:v.t3,acceptedInvitation:v.t4},v.next=37,(0,v.t0)(v.t1,v.t5);case 37:return v.next=39,Object(oi.c)(Mi,Xa.getPropertyChatId);case 39:return v.abrupt("return",o.resolve({success:!0}));case 42:return v.prev=42,v.t6=v.catch(4),v.abrupt("return",t.promise.reject({type:"connection",reason:"Request failed"}));case 45:case"end":return v.stop()}},Kc,this,[[4,42]])}function tu(e){var t,n,r,a,i,o,c,s,u,d,l,p;return ii.a.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return t=e.payload,m.next=3,Object(oi.c)(Mi,Xa.getPropertyChatState);case 3:return n=m.sent,m.next=6,Object(oi.j)(Za);case 6:return r=m.sent,m.next=9,Object(oi.j)(Xa.getPropertyLicense);case 9:return a=m.sent,m.next=12,Object(oi.j)(Xa.getPropertyRegion);case 12:if(i=m.sent,o=t.customId,c=t.file,s=t.onProgress,m.prev=14,n===tc){m.next=18;break}return m.next=18,Object(oi.c)(hu,{customId:o+"_startchat",text:""});case 18:return m.next=20,Object(oi.c)(Mi,Xa.getPropertyChatId);case 20:return u=m.sent,m.next=23,Object(oi.c)(Oc,t);case 23:return d=m.sent,l=d.attachment_token,m.next=27,Object(oi.c)(no,{environment:r,region:i,license:a,token:l,file:c,chatId:u,onProgress:s});case 27:return m.next=29,Object(oi.l)(function(e){return e.type===Da.getActionName()&&e.payload.attachmentToken===l});case 29:return p=m.sent,m.abrupt("return",t.promise.resolve(Object(f.Q)(f.C,Object(f.T)(["id","timestamp","url","contentType","size","width","height"],p.payload))));case 33:return m.prev=33,m.t0=m.catch(14),m.abrupt("return",t.promise.reject({type:"connection",reason:"Request failed"}));case 36:case"end":return m.stop()}},Xc,this,[[14,33]])}function nu(e){var t,n,r,a,i,o,c,s,u,d;return ii.a.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return t=e.payload,l.prev=1,l.next=4,Object(oi.c)(Sc);case 4:if((n=l.sent).agent){l.next=7;break}return l.abrupt("return",t.promise.resolve({}));case 7:return l.next=9,Object(oi.c)(Ms);case 9:return r=l.sent,a=n.agent,i=a.avatar_url,o=a.job_title,c=a.login,s=a.name,u=r.welcome_to_chat,l.next=14,Object(oi.h)(Pa.setPropertyWelcomeMessage(u));case 14:return d={name:s,id:c,avatarUrl:Li(i),jobTitle:o,message:u},l.abrupt("return",t.promise.resolve(d));case 18:return l.prev=18,l.t0=l.catch(1),l.abrupt("return",t.promise.reject({type:"connection",reason:"Request failed"}));case 21:case"end":return l.stop()}},Zc,this,[[1,18]])}function ru(e){var t,n,r,a;return ii.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return t=e.payload,i.prev=1,i.next=4,Object(oi.c)(xc);case 4:if(n=i.sent,(r=bo(n[1])).survey){i.next=8;break}return i.abrupt("return",t.promise.reject({type:"state",reason:"Post-chat survey is turned off"}));case 8:return a=Yi(r.survey),i.next=11,Object(oi.h)(Pa.setPropertyPostChatForm(a));case 11:return i.abrupt("return",t.promise.resolve(a));case 14:return i.prev=14,i.t0=i.catch(1),i.abrupt("return",t.promise.reject({type:"connection",reason:"Request failed"}));case 17:case"end":return i.stop()}},$c,this,[[1,14]])}function au(e){var t,n,r,a;return ii.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return t=e.payload,i.prev=1,n=t.answers,i.next=5,Object(oi.j)(Xa.getPropertyPostChatForm);case 5:return r=i.sent,a=Qi(n,r),i.next=9,Object(oi.c)(Ec,{answers:a});case 9:return i.abrupt("return",t.promise.resolve({success:!0}));case 12:return i.prev=12,i.t0=i.catch(1),i.abrupt("return",t.promise.reject({type:"connection",reason:"Request failed"}));case 15:case"end":return i.stop()}},es,this,[[1,12]])}function iu(e){var t,n;return ii.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return t=e.payload,r.next=3,Object(oi.j)(Xa.getPropertyConfig);case 3:if(n=r.sent){r.next=7;break}return r.next=7,Object(oi.c)(Qo);case 7:return r.next=9,Object(oi.j)(Xa.getPropertyConfig);case 9:n=r.sent,t.promise.resolve(n);case 11:case"end":return r.stop()}},ts,this)}function ou(e){var t;return ii.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t=e.payload,n.next=3,Object(oi.h)(Pa.setPropertyAcceptedInvitation(t.id));case 3:t.promise.resolve({success:!0});case 4:case"end":return n.stop()}},ns,this)}function cu(e){var t,n;return ii.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return t=e.payload,r.prev=1,n=t.messageId,r.next=5,Object(oi.c)(kc,{messageId:n});case 5:return r.abrupt("return",t.promise.resolve({success:!0}));case 8:return r.prev=8,r.t0=r.catch(1),r.abrupt("return",t.promise.reject({type:"connection",reason:"Request failed"}));case 11:case"end":return r.stop()}},rs,this,[[1,8]])}function su(e){var t,n,r,a;return ii.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return t=e.payload,i.next=3,Object(oi.c)(Mi,Xa.getPropertyChatState);case 3:if(n=i.sent,!(n===tc)){i.next=8;break}return t.promise.reject({type:"state",reason:"You can't start new chat during chat"}),i.abrupt("return");case 8:return i.next=10,Object(oi.j)(Xa.getPropertyWelcomeMessage);case 10:if(r=i.sent){i.next=15;break}return i.next=14,Object(oi.c)(Ms);case 14:r=i.sent.welcome_to_chat;case 15:return i.prev=15,i.next=18,Object(oi.c)(hu,{customId:"startchat",welcomeMessage:r});case 18:return i.next=20,Object(oi.c)(Mi,Xa.getPropertyChatId);case 20:a=i.sent,t.promise.resolve({chatId:a}),i.next=27;break;case 24:i.prev=24,i.t0=i.catch(15),t.promise.reject({type:"connection",reason:"Request failed"});case 27:case"end":return i.stop()}},as,this,[[15,24]])}function uu(e){var t,n,r,a,i,o,c,s,u,d,l,p;return ii.a.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(t=e.payload,n=t.group,r=t.promise,"undefined"===typeof n){f.next=6;break}f.t0=n,f.next=9;break;case 6:return f.next=8,Object(oi.j)(Xa.getPropertyGroup);case 8:f.t0=f.sent;case 9:return a=f.t0,f.next=12,Object(oi.j)(Xa.getPropertyClientLimitExceeded);case 12:if((i=f.sent)||"undefined"!==typeof n){f.next=23;break}return f.next=16,Object(oi.j)(Xa.getPropertyChatState);case 16:return o=f.sent,c=o===tc,f.next=20,Object(oi.j)(Xa.getPropertyChatStatus);case 20:return s=f.sent,r.resolve({groupStatus:s.toLowerCase(),chatting:c}),f.abrupt("return");case 23:return f.prev=23,f.next=26,Object(oi.c)(Ac,a);case 26:if(u=f.sent,d=Nc(u),l=d.chatStatus,p=d.chatState,!i||p!==tc){f.next=31;break}return f.next=31,Object(oi.h)(Pa.setPropertyClientLimitExceeded(!1));case 31:r.resolve({groupStatus:l.toLowerCase(),chatting:p===tc}),f.next=37;break;case 34:f.prev=34,f.t1=f.catch(23),r.reject({type:"connection",reason:"Request failed"});case 37:case"end":return f.stop()}},is,this,[[23,34]])}function du(){var e;return ii.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=3,Object(oi.c)(ni.d,ds);case 3:return t.next=5,Object(oi.j)(Xa.getPropertyChatState);case 5:if(e=t.sent,e===tc){t.next=10;break}return t.next=10,Object(oi.h)(Pa.setPropertyClientLimitExceeded(!0));case 10:t.next=0;break;case 12:case"end":return t.stop()}},os,this)}function lu(){var e,t;return ii.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(oi.a)([ps.getActionName()],ni.b.expanding());case 2:return e=n.sent,n.next=5,Object(oi.l)("VISITOR_DATA_WATCHER");case 5:return n.next=8,Object(oi.l)(e);case 8:return t=n.sent,n.next=11,Object(oi.c)(Mi,Xa.getPropertyPingSent);case 11:return n.next=13,Object(oi.c)(Ds,t);case 13:n.next=5;break;case 15:case"end":return n.stop()}},cs,this)}function pu(e){var t;return ii.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t=e.payload,n.next=3,Object(oi.h)(Pa.setPropertyGroup(t.group));case 3:case"end":return n.stop()}},ss,this)}function fu(){var e,t,n;return ii.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Object(oi.e)(du);case 2:return r.next=4,Object(oi.e)(lu);case 4:return r.next=6,Object(oi.m)(Ts.getActionName(),ou);case 6:return r.next=8,Object(oi.m)(xs.getActionName(),Ws);case 8:return r.next=10,Object(oi.m)(_s.getActionName(),Gs);case 10:return r.next=12,Object(oi.m)(Vs.getActionName(),Hs);case 12:return r.next=14,Object(oi.m)(ys.getActionName(),Js);case 14:return r.next=16,Object(oi.m)(ms.getActionName(),Us);case 16:return r.next=18,Object(oi.m)(hs.getActionName(),qs);case 18:return r.next=20,Object(oi.m)(bs.getActionName(),Fs);case 20:return r.next=22,Object(oi.m)(vs.getActionName(),Ls);case 22:return r.next=24,Object(oi.m)(gs.getActionName(),Bs);case 24:return r.next=26,Object(oi.m)(fs.getActionName(),Ys);case 26:return r.next=28,Object(oi.m)(Os.getActionName(),Ks);case 28:return r.next=30,Object(oi.m)(Cs.getActionName(),nu);case 30:return r.next=32,Object(oi.m)(Es.getActionName(),ru);case 32:return r.next=34,Object(oi.m)(Is.getActionName(),au);case 34:return r.next=36,Object(oi.m)(Ss.getActionName(),iu);case 36:return r.next=38,Object(oi.m)(ks.getActionName(),cu);case 38:return r.next=40,Object(oi.m)(As.getActionName(),uu);case 40:return r.next=42,Object(oi.m)(Ns.getActionName(),pu);case 42:return r.next=44,Object(oi.a)([ls.getActionName(),js.getActionName(),ws.getActionName(),Ps.getActionName()],ni.b.expanding());case 44:e=r.sent,t=ii.a.mark(function t(){var n,r;return ii.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(oi.l)(e);case 2:n=t.sent,t.t0=n.type,t.next=t.t0===ls.getActionName()?6:t.t0===js.getActionName()?9:t.t0===ws.getActionName()?19:t.t0===Ps.getActionName()?22:25;break;case 6:return t.next=8,Object(oi.c)(Rs,n);case 8:return t.abrupt("break",26);case 9:return t.next=11,Object(oi.e)(tu,n);case 11:return r=t.sent,t.next=14,Object(oi.i)({success:Object(oi.g)(r),cancel:Object(oi.l)(function(e){return e.type===gi.getActionName()&&e.payload.customId===n.payload.customId})});case 14:if(!t.sent.cancel){t.next=18;break}return t.next=18,Object(oi.d)(r);case 18:return t.abrupt("break",26);case 19:return t.next=21,Object(oi.c)(eu,n);case 21:return t.abrupt("break",26);case 22:return t.next=24,Object(oi.c)(su,n);case 24:return t.abrupt("break",26);case 25:return t.abrupt("return",{v:void 0});case 26:case"end":return t.stop()}},t,this)});case 46:return r.delegateYield(t(),"t0",48);case 48:if("object"!==typeof(n=r.t0)){r.next=51;break}return r.abrupt("return",n.v);case 51:r.next=46;break;case 53:case"end":return r.stop()}},us,this)}var mu=ii.a.mark(hu);function hu(e){var t,n,r,a,i,o,c,s,u,d,l,p,m,h,v;return ii.a.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return t=e.customId,n=e.text,r=e.answers,a=e.welcomeMessage,i=e.acceptedInvitation,o=e.fromManualInvitation,c=void 0!==o&&o,b.next=3,Object(oi.j)(Xa.getPropertyGroup);case 3:return s=b.sent,b.next=6,Object(oi.c)(Mi,Xa.getPropertyVisitorId);case 6:return u=b.sent,b.next=9,Object(oi.j)(ei);case 9:if(d=b.sent,b.t1=d.name,b.t1){b.next=15;break}return b.next=14,Object(oi.c)(Ms);case 14:b.t1=b.sent.client;case 15:if(b.t0=b.t1,b.t0){b.next=18;break}b.t0="Client";case 18:return l=b.t0,b.next=21,Object(oi.j)(Xa.getPropertyMobile);case 21:return p=b.sent,b.next=24,Object(oi.c)(Mi,Xa.getPropertyPingSent);case 24:return m={group:s,source_group:s,details:"",details_labels:"",from_manual_invitation:c,integration_params:"",random_id:t,trigger_unique_id:"",version:"Embedded",custom_variables:{},is_mobile:p,welcome_message:(a||"").replace(/%name%/g,l),return_secured_session_id:!0,visitor:{id:u,nick:l,email:d.email||""},script_version:{embedded_env:"production",embedded_version:"VisitorSDK-849cea2"}},n&&(m.visitor_message=n,m.visitor_message_id=t),d.customProperties&&(m.custom_variables=Object(f.H)(String,d.customProperties)),r&&(m.pre_chat_survey=r),i&&(m.trigger_unique_id=i),b.next=31,Object(oi.h)(Pa.setPropertyChatId(void 0));case 31:return b.next=33,Object(oi.j)(Xa.getPropertyLicense);case 33:return h=b.sent,qi.removeItem("securedToken"),qi.removeOldSecretTokenCookie(h),b.next=38,Object(oi.h)(Pa.removePropertySecuredToken());case 38:return b.next=40,Object(oi.h)(Pa.setPropertyServerIdsMap({}));case 40:return b.next=42,Object(oi.h)(Pa.setPropertyVisitorCustomIdMap({}));case 42:return b.next=44,Object(oi.c)(To,"start_chat",m);case 44:if(!(v=b.sent).secured_session_id){b.next=49;break}return b.next=48,Object(oi.h)(Pa.setPropertySecretId(v.secured_session_id));case 48:qi.setItem("secretId",v.secured_session_id);case 49:if(!v.secured_token){b.next=55;break}return b.next=52,Object(oi.h)(Pa.setPropertySecuredToken(v.secured_token));case 52:return b.next=54,Object(oi.h)(Pa.setPropertyChatState(tc));case 54:qi.setItem("securedToken",v.secured_token);case 55:case"end":return b.stop()}},mu,this)}var vu=ii.a.mark(Ou),bu=ii.a.mark(wu),gu=ii.a.mark(xu),_u=ii.a.mark(Cu),yu=ii.a.mark(Eu),ju=function(e,t,n,r){var a,i={visitor:{id:t,group:n}};return e&&(i.page={title:r.pageTitle,url:r.pageUrl}),e&&r.pageReferrer&&(i.page.referrer=r.pageReferrer),e&&r.email&&(i.visitor.email=r.email),e&&r.name&&(i.visitor.name=r.name),e&&r.customProperties&&(i.visitor.custom_variables=(a=r.customProperties,Object.keys(a).map(function(e){return{name:String(e),value:String(a[e])}}))),i};function Ou(e){var t,n,r,a,i,o,c,s,u,d,l;return ii.a.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return t=e.sendFullPing,p.next=3,Object(oi.c)(Mi,Xa.getPropertyVisitorId);case 3:return n=p.sent,p.next=6,Object(oi.j)(Xa.getPropertyLicense);case 6:return r=p.sent,p.next=9,Object(oi.j)(Xa.getPropertyGroup);case 9:return a=p.sent,p.next=12,Object(oi.j)(ei);case 12:return i=p.sent,p.next=15,Object(oi.j)(Za);case 15:return o=p.sent,p.next=18,Object(oi.j)(Xa.getPropertyRegion);case 18:return c=p.sent,s=ju(t,n,a,i),p.next=22,Object(oi.j)(Xa.getPropertyChatBetweenGroups);case 22:return u=p.sent,p.next=25,Object(oi.j)(Xa.getPropertyRequestDistribution);case 25:return d=p.sent,p.prev=26,p.t0=oi.c,p.t1=oo,p.t2=r,p.t3=o,p.t4=c,p.t5=s,p.next=35,Object(oi.f)("external");case 35:return p.t6=p.sent,p.t7=u,p.t8=a,p.t9=d,p.t10={license:p.t2,environment:p.t3,region:p.t4,body:p.t5,external:p.t6,chatBetweenGroups:p.t7,group:p.t8,requestDistribution:p.t9},p.t11={retry:10},p.next=43,(0,p.t0)(p.t1,"ping",p.t10,p.t11);case 43:return l=p.sent,p.next=46,Object(oi.j)(Xa.getPropertyConnectionStatus);case 46:if("connected"===p.sent){p.next=50;break}return p.next=50,Object(oi.h)(Pa.setPropertyConnectionStatus("connected"));case 50:return p.abrupt("return",l);case 53:return p.prev=53,p.t12=p.catch(26),p.next=57,Object(oi.j)(Xa.getPropertyConnectionStatus);case 57:if("disconnected"===p.sent){p.next=61;break}return p.next=61,Object(oi.h)(Pa.setPropertyConnectionStatus("disconnected"));case 61:return p.abrupt("return",{error:!0});case 62:case"end":return p.stop()}},vu,this,[[26,53]])}function wu(e){var t,n,r,a,i;return ii.a.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(!e.automatic_greeting){o.next=8;break}return t=Fi(e.automatic_greeting),n=t.agent,r=t.invitation,o.next=4,Object(oi.h)(Ma(n));case 4:return o.next=6,Object(oi.h)(Wa(r));case 6:o.next=20;break;case 8:if(!e.personal_greeting){o.next=13;break}return o.next=11,Object(oi.c)(hu,{customId:String(Math.random()),welcomeMessage:e.personal_greeting.greeting_message.message,fromManualInvitation:!0});case 11:o.next=20;break;case 13:if(!e.standard_greeting){o.next=20;break}return o.next=16,Object(oi.c)(Ms);case 16:return a=o.sent,i=a.welcome_to_chat,o.next=20,Object(oi.c)(hu,{customId:String(Math.random()),welcomeMessage:i,fromManualInvitation:!0});case 20:case"end":return o.stop()}},bu,this)}function xu(){var e,t,n,r;return ii.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Object(oi.a)(Ua.getActionName(),ni.b.expanding());case 2:return e=a.sent,a.next=5,Object(oi.h)({type:"VISITOR_DATA_WATCHER"});case 5:return a.next=8,Object(oi.l)(e);case 8:if((t=a.sent).payload.internal){a.next=26;break}return a.next=12,Object(oi.c)(Ou,{sendFullPing:!0});case 12:if(!(n=a.sent).error){a.next=17;break}return a.next=16,Object(oi.h)(Ra({error:n.error,requestId:t.payload.requestId}));case 16:return a.abrupt("return",a.sent);case 17:return a.next=19,Object(oi.c)(wu,n);case 19:return a.next=21,Object(oi.j)(ei);case 21:return r=a.sent,a.next=24,Object(oi.h)(za({visitorData:r,requestId:t.payload.requestId}));case 24:a.next=34;break;case 26:return a.t0=oi.h,a.next=29,Object(oi.j)(ei);case 29:return a.t1=a.sent,a.t2={visitorData:a.t1},a.t3={type:"EMIT_VISITOR_DATA",payload:a.t2},a.next=34,(0,a.t0)(a.t3);case 34:a.next=5;break;case 36:case"end":return a.stop()}},gu,this)}function Cu(){var e,t,n,r;return ii.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return e=3,t=!0,a.next=4,Object(oi.c)(Mi,Xa.getPropertyRequestDistribution);case 4:return a.next=7,Object(oi.c)(Ou,{sendFullPing:t});case 7:if(n=a.sent,r=t,t=Boolean(n.next_ping_send_full_details),0!==n.next_ping_delay){a.next=16;break}return a.next=13,Object(oi.c)($o);case 13:return a.next=15,Object(oi.h)(Pa.setPropertyClientLimitExceeded(!0));case 15:return a.abrupt("return");case 16:return e=!r&&t?0:n.next_ping_delay||3,a.next=19,Object(oi.c)(wu,n);case 19:return a.next=21,Object(oi.h)(Pa.setPropertyPingSent(!0));case 21:return a.next=23,Object(oi.c)(ni.d,1e3*e);case 23:a.next=4;break;case 25:case"end":return a.stop()}},_u,this)}function Eu(){return ii.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(oi.e)(Cu);case 2:return e.next=4,Object(oi.e)(xu);case 4:case"end":return e.stop()}},yu,this)}var Iu=function(e){var t=document.cookie.split(";"),n=Object(f.k)(function(t){var n=Object(f.kb)(t).split("=")[0];return decodeURIComponent(n)===e},t);return n?decodeURIComponent(n.split("=")[1]):null},Su=ii.a.mark(Tu);function Tu(){var e,t,n,r,a,i,o,c;return ii.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,Object(oi.c)(Mi,Xa.getPropertyRequestDistribution);case 2:return s.next=5,Object(oi.j)(Xa.getPropertyLicense);case 5:return e=s.sent,s.prev=6,s.next=9,Object(oi.c)(Ac);case 9:return t=s.sent,s.next=12,Object(oi.j)(Xa.getPropertyChatStatus);case 12:return n=s.sent,s.next=15,Object(oi.j)(Xa.getPropertyChatState);case 15:return r=s.sent,a=Nc(t),i=a.chatStatus,o=a.chatState,s.next=19,Object(oi.j)(Xa.getPropertyConnectionStatus);case 19:if("connected"===s.sent){s.next=23;break}return s.next=23,Object(oi.h)(Pa.setPropertyConnectionStatus("connected"));case 23:if(n===i){s.next=26;break}return s.next=26,Object(oi.h)(Pa.setPropertyChatStatus(i));case 26:if(r===o||o!==tc){s.next=32;break}return c=qi.getItem("securedToken")||Iu("secret_token_"+e),s.next=30,Object(oi.h)(Pa.setPropertySecuredToken(c));case 30:return s.next=32,Object(oi.h)(Pa.setPropertyChatState(o));case 32:s.next=42;break;case 34:return s.prev=34,s.t0=s.catch(6),s.next=38,Object(oi.j)(Xa.getPropertyConnectionStatus);case 38:if("disconnected"===s.sent){s.next=42;break}return s.next=42,Object(oi.h)(Pa.setPropertyConnectionStatus("disconnected"));case 42:return s.next=44,Object(oi.c)(ni.d,3e3);case 44:s.next=2;break;case 46:case"end":return s.stop()}},Su,this,[[6,34]])}var ku=Tu,Pu="chat_started",Au="new_message",Nu="chat_ended",Vu="agent_changed",Mu="status_changed",zu="connection_status_changed",Ru="new_file",Du="visitor_queued",qu="typing_indicator",Lu="visitor_data",Fu="chat_rated",Uu="new_invitation",Bu="ready",Gu="message_seen",Hu="protocol_upgraded",Wu="integration_data",Yu=ii.a.mark(td),Ju=ii.a.mark(ad),Qu=ii.a.mark(id),Ku=ii.a.mark(od),Xu=ii.a.mark(ud),Zu=ii.a.mark(ld),$u=ii.a.mark(md),ed=ii.a.mark(gd);function td(e,t){var n,r,a,i,o;return ii.a.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return n=e.emitter,r=t.payload,c.next=4,Object(oi.c)(Mi,Xa.getPropertyChatId);case 4:if(a=c.sent,n.emit(Pu,{chatId:a}),!r.welcomeMessage){c.next=17;break}return c.next=9,Object(oi.j)(Xa.getPropertyLastAgentId);case 9:return i=c.sent,c.next=12,Object(oi.j)(Xa.getPropertyServerIdsMap);case 12:return o=c.sent,c.next=15,Object(oi.h)(Pa.setPropertyServerIdsMap(Object(d.a)({},o,{welcome_message:{serverId:"welcome_message",authorId:i}})));case 15:return c.next=17,Object(oi.h)(Na({id:"welcome_message",timestamp:Date.now(),authorType:"agent",authorId:i,text:r.welcomeMessage,chatId:a,customId:"welcome_message"}));case 17:if(!r.visitorMessage){c.next=20;break}return c.next=20,Object(oi.h)(Na(r.visitorMessage));case 20:return c.next=22,Object(oi.l)(Va.getActionName());case 22:return n.emit(Nu),c.next=25,Object(oi.h)(Pa.setPropertyLastMessageId(null));case 25:case"end":return c.stop()}},Yu,this)}function nd(e,t){var n=e.emitter,r=t.payload;n.emit(Mu,{status:r.data.toLowerCase()})}function rd(e,t){var n=e.emitter,r=t.payload;n.emit(zu,{status:r.data.toLowerCase()})}function ad(e,t){var n,r,a,i,o;return ii.a.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return n=e.emitter,r=t.payload,c.next=4,Object(oi.c)(Mi,Xa.getPropertyChatId);case 4:return a=c.sent,c.next=7,Object(oi.j)(Xa.getPropertyVisitorId);case 7:i=c.sent,o={id:r.id,timestamp:r.timestamp,authorId:"visitor"===r.authorType?i:r.authorId,text:r.text,chatId:a,json:r.json},"undefined"!==typeof r.isMobile&&(o.isMobile=r.isMobile),"undefined"!==typeof r.customId&&(o.customId=r.customId),n.emit(Au,o);case 12:case"end":return c.stop()}},Ju,this)}function id(e,t){var n,r,a,i;return ii.a.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return n=e.emitter,r=t.payload,o.next=4,Object(oi.j)(Xa.getPropertyVisitorId);case 4:a=o.sent,i={id:r.id,timestamp:r.timestamp,authorId:"visitor"===r.authorType?a:r.authorId,url:r.url,contentType:r.contentType,size:r.size},r.thumbnail&&(i.thumbnail=r.thumbnail),n.emit(Ru,i);case 8:case"end":return o.stop()}},Qu,this)}function od(e,t){var n,r,a;return ii.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(n=e.emitter,r=t.payload,Object(oi.j)(Xa.getPropertyLastAgentId)!==r.id){i.next=5;break}return i.abrupt("return");case 5:return i.next=7,Object(oi.h)(Pa.setPropertyLastAgentId(r.id));case 7:a={name:r.name,id:r.id},r.avatarUrl&&(a.avatarUrl=r.avatarUrl),r.jobTitle&&(a.jobTitle=r.jobTitle),n.emit(Vu,a);case 11:case"end":return i.stop()}},Ku,this)}function cd(e,t){var n=e.emitter,r=t.payload,a=r.numberInQueue,i=r.waitingTime;n.emit(Du,{numberInQueue:a,waitingTime:i})}function sd(e,t){var n=e.emitter,r=t.payload,a=r.authorId,i=r.isTyping;n.emit(qu,{authorId:a,isTyping:i})}function ud(e){var t,n;return ii.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return t=e.emitter,r.next=3,Object(oi.c)(Mi,Xa.getPropertyVisitorId);case 3:n=r.sent,Promise.resolve().then(function(){t.emit(Lu,{id:n})});case 5:case"end":return r.stop()}},Xu,this)}function dd(e,t){e.emitter.emit(Fu,{rate:t.payload.rate,comment:t.payload.comment})}function ld(e,t){return ii.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return e.emitter.emit(Uu,t.payload),n.next=4,Object(oi.l)(function(e){return e.type===Ei.getActionName()&&e.payload.id===t.payload.id});case 4:return n.next=6,Object(oi.h)(Pa.setPropertyWelcomeMessage(t.payload.text));case 6:case"end":return n.stop()}},Zu,this)}function pd(e){e.emitter.emit(Bu)}function fd(e,t){var n=e.emitter,r=t.payload;n.emit(Gu,r)}function md(e,t,n){return ii.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,Object(oi.c)(e[n.type],{emitter:t},n);case 3:r.next=7;break;case 5:r.prev=5,r.t0=r.catch(0);case 7:case"end":return r.stop()}},$u,this,[[0,5]])}function hd(e){e.emitter.emit(Hu)}function vd(e,t){var n=e.emitter,r=t.payload;n.emit(Wu,r)}function bd(e,t){var n=e.emitter,r=t.payload.visitorData;n.emit(Lu,Object(f.c)(r))}function gd(e){var t,n,r;return ii.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return n=e.emitter,a.next=3,Object(oi.e)(ud,{emitter:n});case 3:return(t={})[Aa.getActionName()]=td,t[Pa.setPropertyChatStatus.getActionName()]=nd,t[Pa.setPropertyConnectionStatus.getActionName()]=rd,t[Na.getActionName()]=ad,t[Da.getActionName()]=id,t[Ma.getActionName()]=od,t[qa.getActionName()]=cd,t[La.getActionName()]=sd,t[Fa.getActionName()]=dd,t[Wa.getActionName()]=ld,t[Pa.setPropertyHistoryLoaded.getActionName()]=pd,t[Ya.getActionName()]=fd,t[Ja.getActionName()]=hd,t[Qa.getActionName()]=vd,t.EMIT_VISITOR_DATA=bd,r=t,a.next=6,Object(oi.m)(Object.keys(r),md,r,n);case 6:case"end":return a.stop()}},ed,this)}var _d=P("INCOMING_MESSAGE",function(e){return{name:e.name,message:e.message}}),yd=1800,jd=ii.a.mark(Od);function Od(e){var t,n,r,a,i;return ii.a.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return void 0===e&&(e={}),o.next=3,Object(oi.c)(Mi,Xa.getPropertyVisitorId);case 3:return t=o.sent,o.next=6,Object(oi.j)(Xa.getPropertyGroup);case 6:return n=o.sent,o.next=9,Object(oi.j)(Xa.getPropertyLastMessageId);case 9:return r=o.sent,a=e.sneakPeek,i={random_id:String(Math.random()),visitor:{id:t,group:n}},r&&(i.last_unique_id=r),"string"===typeof a&&(i.sneak_peek=a),o.next=16,Object(oi.c)(To,"get_pending_messages",i);case 16:return o.abrupt("return",o.sent);case 17:case"end":return o.stop()}},jd,this)}var wd=ii.a.mark(Td),xd=ii.a.mark(Nd),Cd=ii.a.mark(Vd),Ed=ii.a.mark(Md),Id=ii.a.mark(zd),Sd="";function Td(){var e;return ii.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(oi.j)(Xa.getPropertyLicense);case 2:return e=t.sent,t.next=5,Object(oi.h)(Pa.setPropertyChatState(nc));case 5:return t.next=7,Object(oi.h)(Pa.removePropertySecuredToken());case 7:return t.next=9,Object(oi.h)(Va());case 9:return qi.removeItem("securedToken"),qi.removeOldSecretTokenCookie(e),t.next=13,Object(oi.h)(Pa.setPropertyServerIdsMap({}));case 13:return t.next=15,Object(oi.h)(Pa.setPropertyVisitorCustomIdMap({}));case 15:case"end":return t.stop()}},wd,this)}var kd=function(e){return Object(f.u)("message.data",e)&&(e.message.data=Object(f.G)(f.b,e.message.data)),Object(f.u)("message.name",e)&&(e.message.name=Object(f.b)(e.message.name)),Object(d.a)({timestamp:e.timestamp,uniqueId:e.unique_id},e.message)},Pd=function(e){return Math.max.apply(Math,[0].concat(e.map(function(e){return e.unique_id})))},Ad=function(e){return e.messages.map(function(e){if(e.message_iwcs){var t=jo(e.message_iwcs);return!!t&&{timestamp:e.timestamp,unique_id:e.unique_id,message:t}}return e}).filter(Boolean).map(kd)};function Nd(){var e,t,n;return ii.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Object(oi.c)(Mi,Xa.getPropertyConfigLoaded);case 2:return r.next=4,Object(oi.j)(Xa.getPropertySecuredToken);case 4:if(!r.sent){r.next=36;break}return r.prev=6,r.next=9,Object(oi.c)(Od);case 9:if(!(e=r.sent).messages){r.next=22;break}return t=Ad(e),r.next=14,Object(oi.b)(t.map(function(e){return Object(oi.h)(_d({name:e.name,message:e}))}));case 14:if(!(n=Pd(e.messages))){r.next=18;break}return r.next=18,Object(oi.h)(Pa.setPropertyLastMessageId(n));case 18:return r.next=20,Object(oi.h)(Pa.setPropertyChatState(tc));case 20:r.next=24;break;case 22:return r.next=24,Object(oi.c)(Td);case 24:r.next=34;break;case 26:return r.prev=26,r.t0=r.catch(6),r.next=30,Object(oi.j)(Xa.getPropertyConnectionStatus);case 30:if("disconnected"===r.sent){r.next=34;break}return r.next=34,Object(oi.h)(Pa.setPropertyConnectionStatus("disconnected"));case 34:r.next=38;break;case 36:return r.next=38,Object(oi.h)(Pa.setPropertyChatState(nc));case 38:return r.next=40,Object(oi.h)(Pa.setPropertyHistoryLoaded(!0));case 40:case"end":return r.stop()}},xd,this,[[6,26]])}function Vd(){var e,t,n,r,a,i;return ii.a.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=3,Object(oi.j)(Xa.getPropertySecuredToken);case 3:return e=o.sent,o.next=6,Object(oi.j)(Xa.getPropertyChatState);case 6:return t=o.sent,o.next=9,Object(oi.j)(Xa.getPropertySneakPeek);case 9:if(n=o.sent,!e||t!==tc){o.next=43;break}return o.prev=11,o.next=14,Object(oi.c)(Od,{sneakPeek:Sd!==n?n:null});case 14:return r=o.sent,o.next=17,Object(oi.j)(Xa.getPropertyConnectionStatus);case 17:if("connected"===o.sent){o.next=21;break}return o.next=21,Object(oi.h)(Pa.setPropertyConnectionStatus("connected"));case 21:if(r.messages){o.next=26;break}return o.next=24,Object(oi.c)(Td);case 24:o.next=33;break;case 26:if(a=Ad(r),!(i=Pd(r.messages))){o.next=31;break}return o.next=31,Object(oi.h)(Pa.setPropertyLastMessageId(i));case 31:return o.next=33,Object(oi.b)(a.map(function(e){return Object(oi.h)(_d({name:e.name,message:e}))}));case 33:o.next=43;break;case 35:return o.prev=35,o.t0=o.catch(11),o.next=39,Object(oi.j)(Xa.getPropertyConnectionStatus);case 39:if("disconnected"===o.sent){o.next=43;break}return o.next=43,Object(oi.h)(Pa.setPropertyConnectionStatus("disconnected"));case 43:return Sd=n,o.next=46,Object(oi.i)([Object(oi.c)(ni.d,yd),Object(oi.l)(bi.getActionName()),Object(oi.l)("PRIVATE_SEND_MESSAGE")]);case 46:o.next=0;break;case 48:case"end":return o.stop()}},Cd,this,[[11,35]])}function Md(){return ii.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(oi.c)(Mi,Xa.getPropertyChatState);case 2:return e.next=4,Object(oi.c)(Vd);case 4:return e.next=6,Object(oi.m)(Pa.setPropertyChatState.getActionName(),Vd);case 6:case"end":return e.stop()}},Ed,this)}function zd(){return ii.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(oi.c)(Nd);case 2:return e.next=4,Object(oi.k)(Md);case 4:case"end":return e.stop()}},Id,this)}var Rd="agentMessageSeen",Dd="sendMessage",qd="startChat",Ld="chatAttachment",Fd="sendRatingComment",Ud="visitorMessageSeen",Bd=ii.a.mark(Wd),Gd=ii.a.mark(Yd),Hd=ii.a.mark(Jd);function Wd(e,t){var n,r;return ii.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Object(oi.j)(Xa.getPropertyVisitorCustomIdMap);case 2:return r=a.sent,a.next=5,Object(oi.h)(Pa.setPropertyVisitorCustomIdMap(Object(d.a)({},r,((n={})[e]=t,n))));case 5:case"end":return a.stop()}},Bd,this)}function Yd(e){var t,n,r,a,i,c,s,u,l,p,m;return ii.a.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:n=e.payload,(r=n.message).timestamp*=1e3,h.t0=r.name,h.next=h.t0===qd?6:h.t0===Dd?26:h.t0===_o.RATE_CHAT?31:h.t0===Fd?34:h.t0===Ld?37:h.t0===_o.NEW_AGENT_MESSAGE?40:h.t0===_o.AGENTS_OFFLINE?48:h.t0===_o.CHAT_ENDED?48:h.t0===_o.NEW_AGENT?64:h.t0===_o.VISITOR_QUEUED?73:h.t0===_o.TYPING_INDICATOR?76:h.t0===Ud?79:h.t0===_o.INTEGRATION_DATA?91:h.t0===Rd?94:106;break;case 6:return h.next=8,Object(oi.j)(Xa.getPropertySecuredToken);case 8:return h.t1=h.sent,h.t2=r.data.welcomeMessage,a={securedToken:h.t1,welcomeMessage:h.t2},i=Object(f.u)("data.visitor.nick",r),h.next=14,Object(oi.j)(ei);case 14:if(c=h.sent.name,!i||i===c){h.next=18;break}return h.next=18,Object(oi.h)(Ua({visitorData:{name:i},internal:!0}));case 18:return r.data.visitorMessage&&(a.visitorMessage={id:r.uniqueId,timestamp:r.timestamp,authorType:"visitor",text:r.data.visitorMessage,customId:r.data.randomId}),h.next=21,Object(oi.h)(Pa.setPropertyChatId(void 0));case 21:return h.next=23,Object(oi.h)(Aa(a));case 23:return h.next=25,Object(oi.c)(Wd,r.data.randomId,r.uniqueId);case 25:return h.abrupt("break",107);case 26:return h.next=28,Object(oi.c)(Wd,r.data.randomId,r.uniqueId);case 28:return h.next=30,Object(oi.h)(Na({id:r.uniqueId,timestamp:r.timestamp,authorType:"visitor",text:r.data.message,customId:r.data.randomId}));case 30:return h.abrupt("break",107);case 31:return h.next=33,Object(oi.h)(Fa({id:r.uniqueId,timestamp:r.timestamp,rate:r.data.rate,comment:r.data.comment}));case 33:return h.abrupt("break",107);case 34:return h.next=36,Object(oi.h)(Fa({id:r.uniqueId,timestamp:r.timestamp,comment:r.data.comment}));case 36:return h.abrupt("break",107);case 37:return h.next=39,Object(oi.h)(Da({id:r.uniqueId,timestamp:r.timestamp,authorId:r.data.author.login||"visitor",authorType:r.data.author.type,url:r.data.files[0].url,size:r.data.files[0].size,contentType:r.data.files[0]["content-type"],attachmentToken:r.data.attachmentToken,thumbnail:r.data.files[0].thumbs}));case 39:return h.abrupt("break",107);case 40:return h.next=42,Object(oi.j)(Xa.getPropertyServerIdsMap);case 42:return s=h.sent,h.next=45,Object(oi.h)(Pa.setPropertyServerIdsMap(Object(d.a)({},s,((t={})[r.uniqueId]={serverId:r.data.id,authorId:r.data.authorId},t))));case 45:return h.next=47,Object(oi.h)(Na({id:r.uniqueId,timestamp:r.timestamp,authorType:"agent",text:r.data.message,isMobile:r.data.isMobile,authorId:r.data.authorId,serverId:r.data.id,json:r.data.json}));case 47:return h.abrupt("break",107);case 48:return h.next=50,Object(oi.h)(Va());case 50:return h.next=52,Object(oi.h)(Pa.setPropertyChatState(nc));case 52:return h.next=54,Object(oi.j)(Xa.getPropertyHistoryLoaded);case 54:return u=h.sent,h.next=57,Object(oi.j)(Xa.getPropertyLicense);case 57:if(l=h.sent,qi.removeItem("securedToken"),qi.removeOldSecretTokenCookie(l),u){h.next=63;break}return h.next=63,Object(oi.h)(Pa.removePropertySecuredToken());case 63:return h.abrupt("break",107);case 64:return h.next=66,Object(oi.h)(Ma({id:r.data.id,name:r.data.name,jobTitle:r.data.jobTitle,avatarUrl:Li(r.data.avatarUrl)}));case 66:return h.next=68,Object(oi.j)(Xa.getPropertyChatId);case 68:if(h.sent){h.next=72;break}return h.next=72,Object(oi.h)(Pa.setPropertyChatId(r.data.chatId));case 72:return h.abrupt("break",107);case 73:return h.next=75,Object(oi.h)(qa({numberInQueue:r.data.numberInQueue,waitingTime:r.data.waitingTime}));case 75:return h.abrupt("break",107);case 76:return h.next=78,Object(oi.h)(La({authorId:r.data.authorId,isTyping:r.data.isTyping}));case 78:return h.abrupt("break",107);case 79:return h.t3=oi.h,h.t4=o,h.next=83,Object(oi.j)(Xa.getPropertyVisitorCustomIdMap);case 83:return h.t5=r.data.id,h.t6=h.sent[h.t5],h.t7=r.data.id,h.t8={id:h.t6,customId:h.t7,type:"visitor"},h.t9=h.t4.messageSeen.call(h.t4,h.t8),h.next=90,(0,h.t3)(h.t9);case 90:return h.abrupt("break",107);case 91:return h.next=93,Object(oi.h)(Qa({id:String(r.uniqueId),timestamp:r.timestamp,integrationName:r.data.integrationName,data:r.data.data}));case 93:return h.abrupt("break",107);case 94:return h.next=96,Object(oi.j)(Xa.getPropertyServerIdsMap);case 96:if(p=h.sent,m=null,p){h.next=100;break}return h.abrupt("break",107);case 100:if(Object(f.q)(function(e,t){e.serverId===r.data.message.id&&(m=t)},p),m){h.next=103;break}return h.abrupt("break",107);case 103:return h.next=105,Object(oi.h)(Ya({id:m,customId:r.data.message.id,type:"agent"}));case 105:return h.abrupt("break",107);case 106:return h.abrupt("return");case 107:case"end":return h.stop()}},Gd,this)}function Jd(){var e,t;return ii.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(oi.a)(_d.getActionName(),ni.b.expanding());case 2:e=n.sent;case 3:return n.next=6,Object(oi.l)(e);case 6:return t=n.sent,n.next=9,Object(oi.c)(Yd,t);case 9:n.next=3;break;case 11:case"end":return n.stop()}},Hd,this)}var Qd=ii.a.mark(tl),Kd=ii.a.mark(nl),Xd=ii.a.mark(rl),Zd=[ci,yi,Si,Aa].map(function(e){return e.getActionName()}),$d=function(e){var t=e.type,n=e.payload;return t===Pa.setPropertyClientLimitExceeded.getActionName()&&!0===n.data},el=function(e){var t=e.type,n=e.payload;return t===Pa.setPropertyClientLimitExceeded.getActionName()&&!1===n.data};function tl(){var e,t,n;return ii.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,zi(Object(oi.e)(zd));case 2:e=r.sent;case 3:return r.next=6,Object(oi.i)([Object(oi.l)(Zd),Object(oi.l)(el)]);case 6:return r.next=8,zi(Object(oi.e)(ku));case 8:return t=r.sent,r.next=11,zi(Object(oi.e)(Eu));case 11:return n=r.sent,r.next=14,Object(oi.i)([Object(oi.l)(mi.getActionName()),Object(oi.l)($d)]);case 14:return r.next=16,Object(oi.h)(Pa.setPropertyPingSent(void 0));case 16:return r.next=18,Object(oi.d)(t,e,n);case 18:r.next=3;break;case 20:case"end":return r.stop()}},Qd,this)}function nl(){var e,t,n;return ii.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=3,Object(oi.l)(Pa.setPropertyGroup);case 3:return e=r.sent,t=e.payload.data,r.next=7,Object(oi.j)(Xa.getPropertyLicense);case 7:n=r.sent,qi.setPrefix("_livechat_"+n+"_"+t),r.next=0;break;case 11:case"end":return r.stop()}},Kd,this)}function rl(e){var t,n;return ii.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return t=e.emitter,n=e.serverConfig,r.next=3,Object(oi.j)(Xa.getPropertyChatBetweenGroups);case 3:if(!1!==r.sent){r.next=7;break}return r.next=7,zi(Object(oi.e)(nl));case 7:return r.next=9,zi(Object(oi.e)(fu));case 9:return r.next=11,zi(Object(oi.e)(gd,{emitter:t}));case 11:return r.next=13,zi(Object(oi.e)(Jd));case 13:return r.next=15,zi(Object(oi.e)(tl));case 15:return r.next=17,Object(oi.c)(ec,n);case 17:case"end":return r.stop()}},Xd,this)}var al="undefined"!==typeof document,il=function(e){return function(t){var n=void 0===t?{}:t,r=n.text,a=n.customId,i=n.json,o=Object(k.a)();return r&&a?(e.dispatch(ci({customId:a,text:r,json:i,promise:o})),o.promise):(o.reject({type:"missing argument",reason:"Missing text or customId parameter"}),o.promise)}},ol=function(e){return function(t){var n=t.text,r=Object(k.a)();return e.dispatch(li({text:n,promise:r})),r.promise}},cl=function(e){return function(t){var n=void 0===t?{}:t,r=n.rate,a=n.comment,i=Object(k.a)();return r||a?r&&"good"!==r&&"none"!==r&&"bad"!==r?(i.reject({type:"wrong argument",reason:'Rate argument should be equal "good", "bad" or "none"'}),i.promise):(e.dispatch(di({rate:r,comment:a,promise:i})),i.promise):(i.reject({type:"missing argument",reason:"Missing rate parameter"}),i.promise)}},sl=function(e){return function(t){var n=(void 0===t?{}:t).email,r=Object(k.a)();return n?(e.dispatch(pi({email:n,promise:r})),r.promise):(r.reject({type:"missing argument",reason:"Missing email parameter"}),r.promise)}},ul=function(e){return function(){var t=Object(k.a)();return e.dispatch(fi({promise:t})),t.promise}},dl=function(e){return function(){var t=Object(k.a)();return e.dispatch(mi({promise:t})),t.promise}},ll=function(e,t){return function(){t.off("*"),e.cancel()}},pl=function(e){return function(t){var n=(void 0===t?{}:t).group,r=Object(k.a)();return e.dispatch(hi({promise:r,group:n})),r.promise}},fl=function(e){return function(){var t=Object(k.a)();return e.dispatch(ji({promise:t})),t.promise}},ml=function(e){return function(t){var n=void 0===t?{}:t,r=n.file,a=n.onProgress,i=String(Math.random()),o=Object(k.a)();return r?r.size>10485760?(o.reject({type:"wrong argument",reason:"Cannot upload a file over 10MB"}),o.promise):(e.dispatch(bi({file:r,customId:i,promise:o,onProgress:a})),{then:function(e,t){return o.promise.then(e,t)},catch:function(e){return o.promise.catch(e)},cancel:function(){e.dispatch(gi({customId:i}))}}):(o.reject({type:"missing argument",reason:"Missing file"}),o.promise)}},hl=function(e){return function(t){void 0===t&&(t={});var n=Object(k.a)();return e.dispatch(vi({answers:t,promise:n})),n.promise}},vl=function(e){return function(t){var n=void 0===t?{}:t,r=n.name,a=n.email,i=n.customProperties,o=n.pageUrl,c=n.pageTitle,s=n.update,u=Object(k.a)();return r||a||i||o||c?(e.dispatch(si({name:r,email:a,customProperties:i,pageUrl:o,pageTitle:c,update:s,promise:u})),u.promise):(u.reject({type:"missing argument",reason:"Missing name, email, url or customProperties"}),u.promise)}},bl=function(e){return function(){var t=Object(k.a)();return e.dispatch(ui({promise:t})),t.promise}},gl=function(e){return function(){var t=Object(k.a)();return e.dispatch(_i({promise:t})),t.promise}},_l=function(e){return function(t){void 0===t&&(t={});var n=Object(k.a)();return e.dispatch(yi({promise:n,answers:t})),n.promise}},yl=function(e){return function(){var t=Object(k.a)();return e.dispatch(Oi({promise:t})),t.promise}},jl=function(e){return function(){var t=Object(k.a)();return e.dispatch(wi({promise:t})),t.promise}},Ol=function(e){return function(t){void 0===t&&(t={});var n=Object(k.a)();return e.dispatch(xi({promise:n,answers:t})),n.promise}},wl=function(e){return function(){var t=Object(k.a)();return e.dispatch(Ci({promise:t})),t.promise}},xl=function e(t){return function(n){var r=Object(k.a)();return t.dispatch(Ei({id:n,promise:r})),e.promise}},Cl=function(e){return function(t){var n=Object(k.a)();return e.dispatch(Ii({promise:n,messageId:t})),n.promise}},El=function(e){return function(){var t=Object(k.a)();return e.dispatch(Si({promise:t})),t.promise}},Il=function(e){return function(t){var n="undefined"!==typeof t?parseInt(t,10):void 0,r=Object(k.a)();return e.dispatch(Ti({promise:r,group:n})),r.promise}},Sl=function(e){return function(t){e.dispatch(ki({group:parseInt(t,10)}))}},Tl=function(e){return function(){var t=Object(k.a)();return e.dispatch(Pi({promise:t})),t.promise}},kl=function(e,t){var n,r=void 0===e?{}:e,a=r.license,i=r.group,o=r.environment,c=void 0===o?"production":o,s=r.page,u=void 0===s?{}:s,d=r.visitor,l=void 0===d?{}:d,p=r.region,m=r.external,h=void 0===m||m,v=r.mobile,b=void 0!==v&&v;if(!a)throw new Error("Missing license parameter");if("production"!==c&&"labs"!==c&&"staging"!==c)throw new Error("Wrong environment parameter");var g=T(),_=g.emit,y=[];g.emit=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];y.push(t)},setTimeout(function(){g.emit=_,y.forEach(function(e){g.emit.apply(g,e)}),y=null},0);var j=String(Math.random());qi.setPrefix("_livechat_"+a);var O=((n={environment:c})[ka.LICENSE]=a,n[ka.GROUP]=i,n[ka.SESSION_ID]=j,n[ka.MOBILE]=b,n.visitorData={email:l.email||null,name:l.name||null,pageUrl:u.url||Object(f.v)("unknown","location.href",al&&document),pageTitle:u.title||Object(f.v)("unknown","0.innerHTML",al&&document.getElementsByTagName("title")||{}),pageReferrer:u.referrer,customProperties:l.customProperties&&!Object(f.B)(l.customProperties)?l.customProperties:null},n[ka.SECURED_TOKEN]=qi.getItem("securedToken")||Iu("secret_token_"+a),n[ka.SECRET_ID]=qi.getItem("secretId"),n[ka.CHAT_BETWEEN_GROUPS]=function(e){return void 0===e&&(e={}),(!e.__lc||!1!==e.__lc.chat_between_groups)&&-1===Object(f.u)("location.href",al&&document).indexOf("unique_group=1")}(t),n);p&&(O[ka.REGION]=p);var w=ri(O,{external:h}),x=qi.getItem("visitorId");x&&w.dispatch(Pa.setPropertyVisitorId(x));var C=w.runSaga(rl,{emitter:g,serverConfig:t});return{sendMessage:il(w),setSneakPeek:ol(w),setVisitorData:vl(w),getVisitorData:bl(w),rateChat:cl(w),forwardChatTranscript:sl(w),closeChat:ul(w),disconnect:dl(w),getTicketForm:pl(w),getTranslations:fl(w),sendTicketForm:hl(w),sendFile:ml(w),on:g.on,off:g.off,destroy:ll(C,g),getPrechatForm:gl(w),sendPrechatForm:_l(w),getPredictedAgent:yl(w),getPostChatForm:jl(w),sendPostChatForm:Ol(w),getConfig:wl(w),acceptInvitation:xl(w),markMessageAsSeen:Cl(w),startChat:El(w),checkGroupStatus:Il(w),setVisitorGroup:Sl(w),getQueueForm:Tl(w)}};function Pl(e){void 0===e&&(e=!1);var t=[],n=e;return{add:function(e){n?e():t.push(e)},run:function(){n=!0;var e=t;t=[],e.forEach(function(e){return e()})},pause:function(){n=!1}}}var Al,Nl=function(e,t,n){var r=un(t,n,e).fields;return e.getView("Chat/"+t).fields.map(function(e){return Object(f.x)(e.serverName,r)?{type:e.type,label:e.label,value:e.options?Object(f.i)(r[e.serverName]).map(function(t){return Object(f.k)(function(e){return e.originalValue===t},e.options).label}).join(", "):r[e.serverName]}:null}).filter(Boolean)},Vl=function(e,t){var n=t.author,r=t.timestamp,a=t.properties.text,i=e.getUser(n).type,o={text:a,timestamp:Math.floor(r/1e3),user_type:"agent"===i?i:"visitor"};if("agent"===i){var c=e.getUser(n);o.agent_name=c.name,o.agent_login=c.id}else o.visitor_name=e.getSessionUser().name;e.emit("on_message",o)},Ml=function(e,t,n){e.emit("on_"+t+"_survey_submitted",{form_data:Nl(e,t,n)})},zl=function(e,t){Ml(e,"prechat",t)},Rl=function(e,t){Ml(e,"postchat",t)},Dl=function(e,t){e.emit("on_rating_comment_submitted",t)},ql=function(e,t){e.emit("on_rating_submitted",null===t?"none":t)},Ll=function(e,t,n){e.emit("on_message",{text:t.properties.text,timestamp:n/1e3,user_type:"visitor",visitor_name:e.getSessionUser().name})},Fl=function(e,t,n){var r=n.id,a=n.text,i=n.visitor,o=i.email,c=i.name,s=n.subject,u={form_data:Nl(e,"offline",t),ticket_id:r,text:a,visitor_name:c,visitor_email:o};s&&(u.ticket_subject=s),e.emit("on_ticket_created",u)},Ul=function(e){return Wr()(ca(e,function(e){return e.application.ready}),Cr()(Boolean),ta()(1),Yr.a)},Bl=function(e,t){return new Promise(function(n){var r=Object(f.l)(function(e){return"groupSelect"===e.meta},t.fields);if(-1!==r){var a,i=t.fields[r],o=i.options.map(function(e){return parseInt(e.groupNumber,10)});(a=o.map(e.checkGroupStatus),Promise.all(a.map(function(e){return e.then(function(e){return{type:"success",result:e}},function(e){return{type:"error",error:e}})}))).then(function(e){n(Object(d.a)({},t,{fields:Object(f.mb)(r,Object(d.a)({},i,{options:Object(f.ob)(function(e,t){return void 0!==t.error?e:Object(d.a)({},e,{meta:{online:"online"===t.result.groupStatus}})},i.options,e)}),t.fields)}))})}else n(t)})},Gl=function(e,t,n){return{id:Object(f.t)(e.getChat("liveChatChatId").events),type:"system_message",author:"system",seen:!0,properties:Object(f.d)({systemMessageType:t,textVariables:n})}},Hl=function(e,t,n){var r=e.license,i=e.group,o=e.region,c=e.mobile,s=t.getSessionUser(),u={name:s.name,email:s.email};s.properties&&(u.customProperties=s.properties);var p={license:r,environment:"production",page:t.getApplicationState("page"),visitor:u,external:!1,region:o,mobile:c};null!==i&&(p.group=i);var m=kl(p,n);var h,v=Pl(),b=Pl(),g=function(e){return function(t){return v.add(function(){return e(t)})}},_=function(){t.updateView("Chat/information",{text:t.localize("lost_connection")}),t.setDefaultView("Chat","information"),t.setCurrentView("Chat"),m.destroy(),t.setApplicationState({destroyed:!0})},y=!1,j=function(){var e=t.getApplicationState().config;if(!t.getChat("liveChatChatId").active){if(!e.features.offlineForm.enabled)return t.updateView("Chat/information",{text:t.localize("agents_not_available")}),t.setDefaultView("Chat","information"),void t.updateView("minimized",{hidden:!0});t.updateView("minimized",{text:t.localize("embedded_leave_message")}),t.getView("Chat/offline").fields?t.setDefaultView("Chat","offline"):m.getTicketForm().then(function(e){return mr(t,e)}).catch(_)}},O=function(){var e=t.getChat("liveChatChatId"),n=e.active,r=e.properties,a=t.getDefaultView("Chat");if(n)t.setDefaultView("Chat","timeline");else if(!r.queued&&"queue"!==a){var i=t.getApplicationState(),o=i.config,c=i.maximized,s=o.features;t.updateView("minimized",{text:t.localize("embedded_chat_now"),hidden:!1}),In("liveChatChatId",t)?t.setDefaultView("Chat","timeline"):s.preChatForm.enabled?ar(t):c&&(s.preChatForm.enabled?ar(t):y||(y=!0,t.setDefaultView("Chat","loader"),m.getPredictedAgent().then(function(e){var n=void 0===e?{}:e,r=n.name,a=n.id,i=n.avatarUrl,o=n.jobTitle,c=n.message;y=!1,a?(t.hasUser(a)||t.addUser({id:a,name:r,type:"agent",avatar:i,properties:{jobTitle:o}}),t.addParticipant("liveChatChatId",a),nr(t,a),t.hasEvent("liveChatChatId","welcome_message")||t.addEvent("liveChatChatId",{author:a,id:"welcome_message",type:"message",seen:!0,properties:{text:An(t,c)}}),t.setDefaultView("Chat","timeline")):m.startChat().catch(_)}).catch(function(){return y=!1,m.startChat().catch(_)})))}},w=new Promise(function(e){m.on("ready",function t(){m.off("ready",t),e()})}),x=function(){return m.getPrechatForm().catch(function(){return null})},C=new Promise(function(e){m.on("status_changed",function t(){m.off("status_changed",t),e()})});Promise.all([m.getTranslations(),x(),m.getConfig(),w,C]).then(function(e){var n=e[0],r=e[1],a=e[2];r&&lr(r,t),t.setLocalization(n),cr(a,t),v.run(),b.run(),t.setApplicationState({ready:!0})}),m.on("visitor_data",g(function(e){t.getSessionUser().user!==e.id&&t.setSessionUserId(e.id);var n=Object(f.W)(["email","name"],e);Object(f.B)(n)||t.updateUser(t.getSessionUser().id,n)})),m.on("chat_ended",g(function(){t.addEvent("liveChatChatId",Gl(t,"chat_session_closed")),Yn(t),t.setDefaultView("Chat","loader"),m.getPostChatForm().then(function(e){dr(t,dn(e)),ir(t)}).catch(function(){t.setDefaultView("Chat","timeline")})})),m.on("chat_started",g(function(e){var n=e.chatId;$n({id:n},t)})),m.on("status_changed",(h=function(e){var n=e.status;t.setApplicationState({availability:n}),"offline"===n?g(j)():g(O)()},function(e){return b.add(function(){return h(e)})})),m.on("agent_changed",g(function(e){var n=e.id,r=e.name,a=e.avatarUrl,i=e.jobTitle,o=t.getChat("liveChatChatId").properties,c=o.ended,s=o.queued;c&&t.flushChat("liveChatChatId"),s&&t.updateChat("liveChatChatId",{properties:{queued:!1}});var u=gn("liveChatChatId",t);null!==u&&u.id!==n&&t.addEvent("liveChatChatId",Gl(t,"user_transfer",{operator:r})),t.hasUser(n)||(t.addUser({id:n,name:r,type:"agent",avatar:a,properties:{jobTitle:i}}),t.addParticipant("liveChatChatId",n)),nr(t,n)})),m.on("new_invitation",g(function(e){var n=e.id,r=e.authorId,a=e.text,i=e.receivedFirstTime;Sn("liveChatChatId",t)&&(m.acceptInvitation(n),pr(t,{authorId:r,text:a,receivedFirstTime:i}))})),m.on("new_message",g(function(e){var n=e.id,r=e.authorId,a=e.timestamp,i=e.text,o=e.customId,c=e.json;if(!t.hasEvent("liveChatChatId",o)&&("welcome_message"!==n||!t.hasEvent("liveChatChatId","invitation"))){var s="welcome_message"===n?An(t,i):i,u={id:String(n),type:"message",author:r,timestamp:a,seen:!1,properties:{customId:o,text:s}};if(c&&"rich_message"===c.type&&c.payload)return u=Object(d.a)({},u,c.payload,{template:c.payload.template_id}),void t.addEvent("liveChatChatId",hn(u));if("message"!==u.type);else{var l=t.addEvent("liveChatChatId",u);Vl(t,l)}}})),m.on("new_file",g(function(e){var n=e.id,r=e.authorId,a=e.timestamp,i=e.url,o=e.customId,c=e.thumbnail;t.hasEvent("liveChatChatId",o)||(c?t.addEvent("liveChatChatId",{id:String(n),type:"rich_message",author:r,timestamp:a,properties:{card:{template:"default",elements:{image:{link:i,url:c.url}}},customId:o}}):t.addEvent("liveChatChatId",{id:String(n),type:"message",author:r,timestamp:a,properties:{url:i,text:Object(f.F)(i.split("/")),customId:o}}))})),m.on("chat_rated",g(function(e){var n=e.rate,r=e.comment;n&&Jn(t,{rate:n}),r&&Qn(t,{comment:r})})),m.on("message_seen",g(function(e){if("agent"!==e.type){var n=t.hasEvent("liveChatChatId",e.id)?e.id:e.customId;t.hasEvent("liveChatChatId",n)&&t.updateEvent("liveChatChatId",n,{seen:!0})}else(function(e,t,n){var r=n.getSessionUserId();return yn(e,{authorPredicate:function(e){return e.author===r},lastSeenPredicate:function(e){return e.serverId===t}},n)})("liveChatChatId",e.id,t).forEach(function(e){t.updateEvent("liveChatChatId",e.id,{seen:!0})})})),m.on("visitor_queued",g(function(e){t.updateView("minimized",{text:t.localize("embedded_waiting_for_operator")}),t.updateChat("liveChatChatId",{properties:{queued:!0}});var n=t.getDefaultView("Chat");if("Chat"!==t.getCurrentView()||"timeline"!==n){var r=e.numberInQueue,a=e.waitingTime;t.setDefaultView("Chat","loader"),m.getQueueForm().then(function(e){if(!t.getChat("liveChatChatId").active){var n=function(e,t,n){return Object(d.a)({},n,{fields:n.fields.map(function(n){return"information"===n.type?Object(d.a)({},n,{value:n.value.replace("%number%",e).replace("%minutes%",t)}):n})})}(r,Math.floor(a/60),e);t.updateView("Chat/queue",n),t.setDefaultView("Chat","queue"),t.setCurrentView("Chat")}}).catch(_)}})),m.on("connection_status_changed",g(function(e){var n=e.status;t.setConnectionState("disconnected"===n?a.RECONNECTING:n)})),m.on("typing_indicator",g(function(e){var n=e.isTyping;t.updateChat("liveChatChatId",{properties:{agentIsTyping:n}})})),m.on("protocol_upgraded",g(function(){t.emit("protocol_upgraded",{version:"3"})})),m.on("integration_data",g(function(e){var n=e.id,r=e.integrationName,a=e.data;"joinme"===r&&t.addEvent("liveChatChatId",function(e,n){var r=gn("liveChatChatId",t);return{id:e,author:r.id,type:"rich_message",properties:{template:"cards",card:{template:"default",elements:{title:t.localize("joinme_info").replace(/<(\/)?strong>/gi,"").replace(/<br>/gi,"\n").replace(/%sender%/gi,r.name),buttons:[{text:t.localize("button_allow"),type:"url",value:n.link},{text:t.localize("button_link_cancel"),type:"message",value:t.localize("joinme_session_rejected")}]}}}}}(n,a))})),t.on("request_update_event",function(e){var n=t.getEvent("liveChatChatId",e.id);if(e.data.seen)m.markMessageAsSeen(n.serverId).then(e.resolve).catch(e.reject);else if("offline"===n.properties.formType){var r=e.data.properties.answers,a=un("offline",r,t).fields;m.sendTicketForm(a).then(function(n){Fl(t,r,n),e.resolve(),t.updateView("Chat/information",{text:t.localize("offline_message_sent")}),t.setDefaultView("Chat","information"),t.setCurrentView("Chat")})}else if("prechat"===n.properties.formType){var i=e.data.properties.answers,o=un("prechat",i,t);if(zl(t,i),t.setDefaultView("Chat","loader"),"number"===typeof o.choosenGroup){var c=t.getView("Chat/prechat"),s=Object(f.k)(function(e){return"groupSelect"===e.meta},c.fields),u=Object(f.k)(function(e){return e.groupNumber===o.choosenGroup},s.options);return t.updateFeature("offlineForm",{enabled:!u.ticketFormDisabled}),m.setVisitorGroup(o.choosenGroup),void m.checkGroupStatus(o.choosenGroup).then(function(n){if("offline"===n.groupStatus)return u.ticketFormDisabled?(t.updateView("Chat/information",{text:t.localize("agents_not_available")}),t.setDefaultView("Chat","information")):m.getTicketForm({group:o.choosenGroup}).then(function(e){return mr(t,e)});var r=Object(d.a)({},o.fields,{choosenGroupIndex:o.choosenGroupIndex});return m.sendPrechatForm(r).then(function(){e.resolve()})}).catch(_)}m.sendPrechatForm(o.fields).then(function(){e.resolve()})}else if("postchat"===n.properties.formType){var l=e.data.properties.answers,p=un("postchat",l,t);if(Rl(t,l),Object(f.x)("rate",p)){var h=t.getChat("liveChatChatId").properties,v=h.rate,b=h.rateComment,g={},y=v&&p.rate!==v,j=!v&&p.rate;(y||j)&&(g.rate=p.rate),Object(f.x)("rateComment",p)&&p.rateComment!==b&&(g.comment=p.rateComment),Object(f.B)(g)||m.rateChat(g).then(function(){t.updateChat("liveChatChatId",{properties:Object(f.W)(["rate","rateComment"],p)})},f.N)}m.sendPostChatForm(p.fields).then(function(){e.resolve(),t.setDefaultView("Chat","timeline")})}}),t.on("request_update_chat",function(e){var n=e.resolve,r=e.reject,a=e.data,i=a.properties,o=void 0===i?{}:i,c=Object(l.a)(a,["properties"]);o.rateComment?(Dl(t,o.rateComment),m.rateChat({comment:o.rateComment}).then(n).catch(r)):"undefined"!==typeof o.rate?(ql(t,o.rate),m.rateChat({rate:null===o.rate?"none":o.rate}).then(n).catch(r)):o.transcriptSentTo?m.forwardChatTranscript({email:o.transcriptSentTo}).then(n).catch(r):!1===c.active?m.closeChat().then(n).catch(r):"string"===typeof o.messageDraft&&m.setSneakPeek({text:o.messageDraft}).then(n).catch(r)}),t.on("request_update_user",function(e){var n=e.resolve,r=(e.reject,e.id),a=e.data,i=a.properties,o=Object(l.a)(a,["properties"]);t.getSessionId()===r&&(i&&(o.customProperties=i,o.update=!0),m.setVisitorData(o).then(n).catch(f.N))}),t.on("request_set_user_properties",function(e){var n=e.resolve,r=(e.reject,e.id),a=e.properties;if(t.getSessionId()===r){var i={};a&&(i.customProperties=a,i.update=!1),m.setVisitorData(i).then(n).catch(f.N)}}),t.on("update_event",function(e){var n=e.event;"file"===n.type&&n.properties.canceled&&Wn(t,n.id)}),t.on("send_event",function(e){var n=e.event,r=e.meta;if("file"===n.type)Gn(t,n.id),m.sendFile({file:r.file,onProgress:function(e){t.updateEvent("liveChatChatId",n.id,{properties:{progress:e}})}}).then(function(e){var r=e.id,a=e.url;t.setEventServerId("liveChatChatId",n.id,r),t.updateEvent("liveChatChatId",n.id,{delivered:!0,properties:{url:a}}),Wn(t,n.id)}).catch(function(e){var r={failed:!0,failReason:"Cannot upload a file over 10MB"===e.reason?t.localize("cannot_upload_a_file_over_10mb"):t.localize("upload_failed")};t.updateEvent("liveChatChatId",n.id,{properties:r})});else if("message"===n.type){var a={customId:n.id,text:n.properties.text},i=n.properties.triggeredBy;if(i&&"action_button"===i.type){var o=t.getEvent("liveChatChatId",i.event).serverId;a.json={postback:{id:i.button.postback,type:i.button.type,value:i.button.value,event_id:o}}}m.setSneakPeek({text:""}),m.sendMessage(a).then(function(e){Ll(t,n,e.timestamp),t.setEventServerId("liveChatChatId",n.id,e.id),t.updateEvent("liveChatChatId",n.id,{delivered:!0})}).catch(function(){t.updateEvent("liveChatChatId",n.id,{failed:!0})})}});var E=Wr()(ca(t,function(e){return e.application.destroyed}),Cr()(Boolean),ta()(1),Yr.a);Wr()(ca(t,function(e){return e.application.page}),Kr()(1),Object(na.a)(E),Sr()(function(e){var t=e.title,n=e.url;return m.setVisitorData({pageTitle:t,pageUrl:n}).catch(f.N)}));var I=function(){t.getApplicationState("destroyed")?t.setCurrentView("information"):m.checkGroupStatus().then(function(e){"online"===e.groupStatus?O():j()}).catch(_)};t.on("flush_chat",function(){x().then(function(e){if(!t.getChat("liveChatChatId").active){if(e){var n=lr(e,t);Bl(m,n).then(function(e){t.updateView("Chat/prechat",e)},f.N)}t.updateView("Chat",{inputMode:"text"}),I()}})});var S=Ul(t),T=function(e){return Wr()(S,$r(e))},k=Wr()(T(function(){return ca(t,function(e){return e.application.maximized})}),Cr()(Boolean),Yr.a);Wr()(k,Sr()(function(){return v.add(function(){return I()})})),Wr()(T(function(){if(!t.getApplicationState("config").features.preChatForm.enabled)return Ur.a;var e=ca(t,function(){return t.getDefaultView("Chat")});return Wr()(Pr()(k,Wr()(e,Cr()(function(e){return"prechat"===e}))),$r(function(){var e=t.getView("Chat/prechat");return Wr()(Object(Mr.a)(Bl(m,e)),Fr)}))}),Sr()(function(e){t.updateView("Chat/prechat",e)}))},Wl=Object(Wt.b)()?window.localStorage:Wt.a,Yl=function(e,t){return new Promise(function(n){return n(Wl.setItem(e,t))})},Jl=function(e){return new Promise(function(t){return t(Wl.getItem(e))})},Ql=function(e){return new Promise(function(t){return t(Wl.removeItem(e))})},Kl=function(e){return{type:"ok",value:e}},Xl=function(e){return{type:"error",error:e}},Zl=function(e,t){return e.identity_exception?Xl({code:"SSO_IDENTITY_EXCEPTION",message:e.identity_exception}):e.oauth_exception?Xl({code:"SSO_OAUTH_EXCEPTION",message:e.oauth_exception}):Kl(function(e,t){var n=t.license;return{accessToken:e.access_token,entityId:e.entity_id,expiresIn:1e3*e.expires_in,tokenType:e.token_type,creationDate:Date.now(),license:n}}(e,t))},$l=function(e,t){var n=document.createElement("iframe");return n.style.display="none",n.setAttribute("src",function(e,t,n){return""+("production"===n?"https://accounts.livechatinc.com":"https://accounts.livechatinc.com".replace("accounts.","accounts."+n+"."))+function(e){var t=e.uniqueGroups,n=e.license,r=e.group;return(t?"/licence/g"+n+"_"+r:"")+"/customer"}(e)+"?"+m(function(e){var t=e.clientId,n=e.license,r=e.redirectUri,a=e.state,i={license_id:n,flow:"button",response_type:"token",client_id:t,redirect_uri:r,post_message_uri:r};return a&&(i.state=a),i}(Object(d.a)({},e,{state:t})))}(Object(d.a)({},e,{redirectUri:b(String(location))+location.pathname}),"@livechat/customer-auth",t)),n},ep=function(e){var t=e.code,n=e.message,r=new Error(n);return r.code=t,r},tp=function(e){var t=e.license,n=e.clientId;if("number"!==typeof t||"string"!==typeof n)throw new Error("You need to pass valid configuration object: { license, clientId }.")},np=function(e,t){tp(e);var n,r,a=function(e){var t=e.uniqueGroups,n=void 0!==t&&t,r=Object(l.a)(e,["uniqueGroups"]);return Object(d.a)({uniqueGroups:n},r)}(e),i="@@lc_auth_token:"+a.license+(a.uniqueGroups?":"+a.group:""),o=Jl(i).then(function(e){null!==o&&(o=null,e&&(r=JSON.parse(e)))}),c=Object.freeze({getFreshToken:function(){return n=function(e,t){var n=e.license,r=function(e){return"production"===e?"https://accounts.livechatinc.com":"https://accounts.livechatinc.com".replace("accounts.","accounts."+e+".")}(t);return new Promise(function(a,i){var o,c=$l(e,t),s=function(){var e,t;(t=c).parentNode&&t.parentNode.removeChild(t),(e=window).removeEventListener.apply(e,d)},u=setTimeout(function(){s(),i(ep({message:"Request timed out.",code:"REQUEST_TIMEOUT"}))},15e3),d=["message",function(e){var t,o,c,d=e.origin,l=e.data;d===r&&l&&"@livechat/customer-auth"===l.state&&(clearTimeout(u),s(),t=function(e){return i(ep(e))},o=a,"ok"===(c=Zl(l,{license:n})).type?o(c.value):t(c.error))},!1];(o=window).addEventListener.apply(o,d),aa().then(function(e){e.appendChild(c)})})}(a,t).then(function(e){return n=null,Yl(i,JSON.stringify(e)),r=e,e}).catch(function(e){throw n=null,e})},getToken:function(){return n||(!r||(e=r,Date.now()>=e.creationDate+e.expiresIn)?o?o.then(c.getToken):c.getFreshToken():Promise.resolve(r));var e},invalidate:function(){Ql(i),r=null,o=null}});return c},rp=n(27),ap="destroy",ip="login_attempt",op="login_success",cp="reconnect",sp="set_self_id",up="get_chats_summary",dp="login";function lp(e){var t=function(e,t){if("object"!==typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===typeof t?t:String(t)}var pp=function(e){return e.connection.status},fp=function(e,t){return e.requests[t]},mp=function(e){var t={},n=e.users.self;return n.name&&(t.name=n.name),n.email&&(t.email=n.email),t.fields=n.fields,t},hp=function(e){return e.users.self.id},vp=function(e,t){var n=e.chats[t];return!!n&&n.active},bp=function(e){return"connected"===pp(e)},gp=function(e){return e.connection.logging},_p=function(e){var t=e.region;return"https://api"+(t?"-"+t:"")+function(e){var t=e.license,n=e.env;return 1520===t?".staging":"production"===n?"":"."+n}(e)+".livechatinc.com/v3.0/customer"},yp=function(e){var t=e.license,n=e.group,r=void 0===n?null:n,a=e.customer,i=void 0===a?{}:a,o=e.env,c=e.page,s=void 0===c?null:c,u=e.region,d=e.referrer,l=void 0===d?null:d,p=e.uniqueGroups,f=void 0!==p&&p;return{license:t,env:o,group:r,chats:{},connection:{status:"disconnected",logging:!1},page:s,queuedPushes:[],region:u,referrer:l,requests:{},serverUrl:_p(e),storedUpdates:{},users:{self:{id:null,type:"customer",name:i.name||null,email:i.email||null,fields:i.fields||{}},others:{}},uniqueGroups:f}},jp=function(e,t){var n=t.id,r=e.requests,a=(r[n],Object(l.a)(r,[n].map(lp)));return Object(d.a)({},e,{requests:a})},Op=function(e,t){return Object(f.ab)("connection.status",e,t)},wp=function(e,t){return Object(f.ab)("connection.logging",e,t)},xp=M(null,((Al={}).clear_push_queue=function(e){return Object(d.a)({},e,{queuedPushes:[]})},Al.clear_stored_updates=function(e){return Object(d.a)({},e,{storedUpdates:{}})},Al[ap]=function(e){return Op("destroyed",e)},Al[ip]=function(e){return wp(!0,e)},Al[op]=function(e){var t=wp(!1,e);return Op("connected",t)},Al.queue_push=function(e,t){return Object(d.a)({},e,{queuedPushes:[].concat(e.queuedPushes,[t])})},Al.request_failed=jp,Al.response_received=jp,Al.send_request=function(e,t){var n=t.action,r=t.promise,a=t.resolve,i=t.reject,o=t.id,c=t.data;return Object(f.ab)("requests."+o,{promise:r,resolve:a,reject:i,action:n,data:c},e)},Al.set_chat_active=function(e,t){var n=t.id,r=t.active;return Object(f.ab)("chats."+n+".active",r,e)},Al[sp]=function(e,t){return Object(f.ab)("users.self.id",t,e)},Al.socket_disconnected=function(e){var t=pp(e);var n=wp(!1,e),r=Op("disconnected"===t?"disconnected":"reconnecting",n);return Object(d.a)({},r,{queuedPushes:[],requests:{},storedUpdates:{}})},Al.stop_connection=function(e){return Op("stopped",e)},Al.store_update=function(e,t){var n,r=t.updateAction,a=t.data;return Object(d.a)({},e,{storedUpdates:Object(f.L)(e.storedUpdates,(n={},n[r]=a,n))})},Al.update_customer_page=function(e,t){var n=Object(d.a)({},t);return Object(d.a)({},e,{page:n})},Al.update_customer=function(e,t){var n=t.name,r=t.email,a=t.fields,i=Object(f.c)(e.users.self);return"string"===typeof n&&(i.name=n),"string"===typeof r&&(i.email=r),Object(f.D)(a)&&(i.fields=Object(d.a)({},i.fields,a)),Object(f.ab)("users.self",i,e)},Al));function Cp(e){var t=e.message,n=e.code,r=new Error(t);return r.code=n,r.framesToPop=1,r}var Ep=function(e){var t={type:e.type};switch(e.type){case"message":t.text=e.text;break;default:t=e}return"string"===typeof e.customId&&(t.custom_id=e.customId),e.postback&&(t.postback=e.postback),Object(f.D)(e.properties)&&(t.properties=e.properties),t},Ip=function(e){var t=e.access,n=e.events,r=e.chatProperties,a=e.threadProperties,i={};return t&&t.groups&&(i.access={group_ids:t.groups}),n&&(i.thread={events:n.map(Ep)}),r&&(i.properties=r),a&&(i.thread=i.thread||{},i.thread.properties=a),{chat:i}},Sp=function(e,t,n){return void 0===t&&(t=null),void 0===n&&(n={}),{type:"send_request",payload:{action:e,data:t},meta:n}},Tp=function(e,t){return{type:"set_chat_active",payload:{id:e,active:t}}},kp=function(e,t){return{type:"store_update",payload:{updateAction:e,data:t}}},Pp=Object.freeze({success:!0}),Ap=function(e){return"number"===typeof e?1e3*e:null},Np=function(e){return Object(f.H)(function(e){return Ap(e.last_seen_timestamp)},Object(f.E)("id",e))},Vp=function(e){return Object(f.H)(function(e){return Object(f.H)(function(e){return e.value},e)},e)},Mp=function(e,t){var n={id:t.id,author:t.author_id,timestamp:Ap(t.timestamp),thread:e,properties:void 0!==t.properties?Vp(t.properties):{}};return void 0!==t.custom_id&&(n.customId=t.custom_id),n},zp=function(e,t){var n,r=t.height>t.width?["height","width"]:["width","height"],a=r[0],i=r[1],o=t[a],c=t[i],s=e/o;return(n={})[a]=Math.min(o,e),n[i]=Math.min(s*c,c),n},Rp=function(e,t){return void 0!==t.width&&void 0!==t.height?function(e,t){var n=Object(d.a)({},Mp(e,t),{type:"file",contentType:t.content_type,url:t.url,width:t.width,height:t.height});return t.thumbnail_url&&(n.thumbnails={default:Object(d.a)({url:t.thumbnail_url},Object(f.H)(Math.ceil,zp(300,t))),high:Object(d.a)({url:t.thumbnail2x_url},Object(f.H)(Math.ceil,zp(600,t)))}),n}(e,t):Object(d.a)({},Mp(e,t),{type:"file",contentType:t.content_type,url:t.url})},Dp=function(e){var t=Object(f.W)(["title","subtitle"],e);return e.image&&(t.image={url:e.image.url}),e.buttons&&(t.buttons=e.buttons.map(function(e){var t=e.text,n=e.postback_id,r=e.user_ids,a=e.type,i=e.value,o={text:t,postback:n,users:r};return a&&(o.type=a,o.value=i),o})),t},qp=function(e,t){switch(t.type){case"file":return Rp(e,t);case"message":return function(e,t){return Object(d.a)({},Mp(e,t),{type:"message",text:t.text})}(e,t);case"rich_message":return function(e,t){return Object(d.a)({},Mp(e,t),{type:"rich_message",template:t.template_id,elements:t.elements.map(Dp)})}(e,t);case"system_message":return function(e,t){var n=Object(d.a)({},Mp(e,Object(d.a)({},t,{author_id:"system"})),{type:"system_message",text:t.text,systemMessageType:t.system_message_type});return t.text_vars&&(n.textVars=t.text_vars),n}(e,t);default:return function(e,t){return Object(d.a)({},Mp(e,t),Object(f.P)(["id","author_id","timestamp","custom_id","order"],t))}(e,t)}},Lp=function(e,t,n){return{id:n.id,chat:e,active:n.active,order:n.order,users:n.user_ids,lastSeenTimestamps:Np(t),events:Object(f.O)("order",n.events).map(function(e){return qp(n.id,e)}),properties:Vp(n.properties||{})}},Fp=function(e){return Object(d.a)({},Object(f.P)(["events","users","lastSeenTimestamps"],e),{totalEvents:e.events.length})},Up=function(e){var t={id:e.id,type:e.type,fields:e.fields||{}};return e.name&&(t.name=e.name),e.email&&(t.email=e.email),t},Bp=function(e){return"customer"===e.type?Up(e):{id:(t=e).id,type:"agent",name:t.name,avatar:t.avatar,jobTitle:t.job_title};var t},Gp=function(e){var t=e.id,n=e.thread,r=e.users;return{events:n.events.map(function(e){return qp(n.id,e)}),users:r.map(Bp),thread:Lp(t,r,n)}},Hp=function(e){return{url:e.url,title:e.title,timestamp:Ap(e.timestamp)}},Wp=function(e){var t=e.chat,n=t.id,r=t.thread,a=t.users,i=t.properties;return{chat:{id:n,users:a.map(function(e){return e.id}),thread:r.id,events:r.events.map(function(e){return qp(r.id,e)}),properties:Vp(i||{})},thread:Lp(n,a,r),users:a.map(Bp)}},Yp=function(e){switch(e.action){case"chat_properties_deleted":return{chat:(t=e.payload).chat_id,properties:t.properties};case"chat_properties_updated":return function(e){return{chat:e.chat_id,properties:Vp(e.properties)}}(e.payload);case"chat_thread_properties_deleted":return function(e){return{chat:e.chat_id,thread:e.thread_id,properties:e.properties}}(e.payload);case"chat_thread_properties_updated":return function(e){return{chat:e.chat_id,thread:e.thread_id,properties:Vp(e.properties)}}(e.payload);case"chat_user_added":return function(e){var t=e.chat_id,n=e.user;return{chat:t,user:Bp(n)}}(e.payload);case"chat_user_removed":return function(e){return{chat:e.chat_id,user:e.user_id}}(e.payload);case"customer_page_updated":return Hp(e.payload);case"customer_updated":return function(e){return Up(e.customer)}(e.payload);case"event_properties_deleted":return function(e){return{chat:e.chat_id,thread:e.thread_id,event:e.event_id,properties:e.properties}}(e.payload);case"event_updated":return function(e){var t=e.thread_id;return{chat:e.chat_id,thread:t,event:qp(t,e.event)}}(e.payload);case"incoming_chat_thread":return function(e){return Gp(e.chat)}(e.payload);case"incoming_event":return function(e){return{chat:e.chat_id,event:qp(e.thread_id,e.event)}}(e.payload);case"incoming_typing_indicator":return function(e){var t=e.chat_id,n=e.typing_indicator;return{chat:t,user:n.author_id,isTyping:n.is_typing}}(e.payload);case"last_seen_timestamp_updated":return function(e){return{chat:e.chat_id,user:e.user_id,timestamp:Ap(e.timestamp)}}(e.payload);case"thread_closed":return{chat:e.payload.chat_id};default:return e.payload}var t},Jp=function(e,t){switch(e){case"activate_chat":return Wp(t);case"close_thread":case"delete_chat_properties":case"delete_chat_thread_properties":case"delete_event_properties":return Pp;case"get_chat_threads":return function(e){var t=e.chat,n=t.threads,r=t.users,a=t.id;return{threads:Object(f.O)("order",n).map(function(e){return Lp(a,r,e)}),users:r.map(Bp)}}(t);case"get_chat_threads_summary":return function(e){var t=e.threads_summary,n=e.total_threads;return{threadsSummary:Object(f.O)("order",t.map(function(e){var t=e.total_events;return{id:e.id,active:e.active,order:e.order,totalEvents:t}})),totalThreads:n}}(t);case up:return function(e){var t=e.chats_summary.map(function(e){var t=e.id,n=e.active,r=e.order,a=e.last_thread_id,i=e.last_event_per_type,o=e.properties,c=void 0===o?{}:o,s=e.users,u={};if(u.id=t,u.active=n,u.order=Ap(r),u.properties=Vp(c),u.users=s.map(function(e){return e.id}),u.lastThread=a,u.lastSeenTimestamps=Np(s),!i)return u;u.lastEventsPerType=Object(f.H)(function(e){var t=e.thread_id,n=e.event;return qp(t,n)},i);var d=Object.keys(i).map(function(e){return i[e]}),l=Object(f.F)(d.sort(function(e,t){return e.thread_id===t.thread_id?e.event.order-t.event.order:e.thread_order-t.thread_order}));return l&&(u.lastEvent=Object(f.c)(u.lastEventsPerType[l.event.type])),u});return{chatsSummary:Object(f.O)(function(e){var t=e.lastEvent,n=e.order;return-1*(void 0!==t?t.timestamp:n)},t),totalChats:e.total_chats,users:Object(f.e)(function(e){return e.map(Bp)},function(e){return Object(f.lb)(function(e){return e.id},e)},function(e){return Object(f.p)(function(e){return e.users},e)})(e.chats_summary)}}(t);case"get_form":return function(e){return e.enabled?Object(d.a)({},e,{form:Object(d.a)({},e.form,{fields:e.form.fields.map(function(e){if("group_chooser"===e.type)return Object(d.a)({},e,{options:e.options.map(function(e){var t=e.group_id,n=Object(l.a)(e,["group_id"]);return Object(d.a)({},n,{group:t})})});if("rating"===e.type){var t=e.comment_label,n=Object(l.a)(e,["comment_label"]);return Object(d.a)({},n,{commentLabel:t})}return e})})}):e}(t);case"get_groups_status":return function(e){return e.groups_status}(t);case"get_url_details":return function(e){return{title:e.title,description:e.description,url:e.url,image:{url:"https://"+e.image_url,width:e.image_width,height:e.image_height}}}(t);case"send_event":return function(e){return e.chat?Gp(e.chat):{event:qp(e.thread_id,e.event)}}(t);case"send_sneak_peek":return Pp;case"start_chat":return Wp(t);case"update_chat_properties":case"update_chat_thread_properties":case"update_customer":return Pp;case"update_customer_page":return Hp(t);case"update_last_seen_timestamp":return{timestamp:Ap(t.timestamp)};default:return t}},Qp=function(e,t){switch(t.type){case"authentication":case"group_unavailable":case"groups_offline":case"group_offline":case"request_timeout":case"users_limit_reached":case"validation":case"wrong_product_version":return{code:t.type.toUpperCase(),message:t.message};default:return Object(d.a)({code:"REQUEST_FAILED"},t)}},Kp=function(e,t){t.payload.id=Object(f.t)(e.getState().requests);var n=Kt(),r=n.resolve,a=n.reject,i=n.promise;return t.payload.promise=i,t.payload.resolve=r,t.payload.reject=a,e.dispatch(t),i},Xp="AUTHENTICATION",Zp="USERS_LIMIT_REACHED",$p="WRONG_PRODUCT_VERSION",ef=function(e){var t=e.getState(),n=t.license,r=t.group;return"side_storage_"+n+(t.uniqueGroups?":"+r:"")},tf=function(e){return Jl(ef(e)).catch(f.N).then(function(e){return void 0===e&&(e="{}"),JSON.parse(e)}).catch(function(){return{}})},nf=function(e){return new Promise(function(t){setTimeout(t,e)})};function rf(e,t){var n,r,a=new Ni.a({min:300,max:6e4,jitter:.3}),i=function(){n.dispatch({type:ip})},o=function(){return Promise.all([t.getToken(),tf(n)])},c=function(e){var t=e[0],r=e[1];if(null===hp(n.getState())){var a=t.entityId;n.dispatch({type:sp,payload:a})}return[t,r]},s=function(e){var t=e[0],r=e[1],a=n.getState(),i=mp(a),o=a.group,c=a.page,s=a.referrer,u={token:t.tokenType+" "+t.accessToken,customer:i,customer_side_storage:r};return"number"===typeof o&&(u.group_id=o),null!==c&&(u.customer_page=c),null!==s&&(u.referrer=s),Promise.race([Kp(n,Sp(dp,u,{source:"login"})),nf(15e3).then(function(){return Promise.reject(Cp({message:"Request timed out.",code:"REQUEST_TIMEOUT"}))})])},u=function(e){return Promise.all([e,Kp(n,Sp(up,null,{source:"login"}))])},d=function(e){var t=e[0],r=e[1],i=r.chatsSummary,o=r.totalChats;n.dispatch({type:op,payload:{previousStatus:pp(n.getState()),chatsSummary:i,totalChats:o,dynamicConfig:t.__priv_dynamic_config}}),a.reset()},l=function(){n.dispatch({type:cp,payload:{delay:a.duration()}})};return function(e){n=e,function(){var e=Object(f.s)();r=e,[i,o,c,s,u].reduce(function(t,n){return t.then(function(t){if(e!==r)throw new Error("Cancelled.");return n(t)})},Promise.resolve()).then(d,function(a){if(e===r)switch(a.code){case Xp:return t.getFreshToken(),void l();case"CONNECTION_LOST":return;case"SSO_IDENTITY_EXCEPTION":case"SSO_OAUTH_EXCEPTION":return"server_error"===a.message||"temporarily_unavailable"===a.message?void l():void n.dispatch({type:ap,payload:{reason:a.message}});case Zp:case $p:return void n.dispatch({type:ap,payload:{reason:a.code.toLowerCase()}});default:return void l()}})}()}}var af,of,cf=function(e){return!(!e.users||!e.thread)},sf=function(e,t){var n=e.getState(),r=t.payload.action;if("push_received"===t.type){var a=t.payload.push;switch(r){case"incoming_chat_thread":return void e.dispatch(Tp(a.thread.chat,!0));case"thread_closed":return void e.dispatch(Tp(a.chat,!1));default:return}}var i=t.payload.response;switch(r){case"close_thread":return void e.dispatch(Tp(t.payload.data.chat_id,!1));case up:return void i.chatsSummary.filter(function(e){var t=e.id,r=e.active;return vp(n,t)!==r}).forEach(function(t){var n=t.id,r=t.active;e.dispatch(Tp(n,r))});case"send_event":return void(cf(i)&&e.dispatch(Tp(t.payload.data.chat_id,!0)));case"activate_chat":case"start_chat":return void e.dispatch(Tp(i.chat.id,!0));default:return}},uf=function(e,t){t.forEach(function(t){e("user_data",t)})},df=function(e,t){var n=Fp(t.thread);uf(e,t.users),e("thread_summary",n),t.thread.users.forEach(function(t){e("user_joined_chat",{chat:n.chat,user:t})})},lf=function(e,t,n){var r=e.getState().requests,a=t.payload.id;e.dispatch({type:"request_failed",payload:{id:a,reject:r[a].reject,error:n}})},pf=function(e,t){var n=e.emit,r=e.store,a=t.payload,i=a.action,o=a.push;switch(i){case"chat_properties_updated":case"chat_thread_properties_updated":case"last_seen_timestamp_updated":case"thread_closed":return void n(i,o);case"customer_side_storage_updated":return void function(e,t){Yl(ef(e),JSON.stringify(t)).catch(f.N)}(r,o.customer_side_storage);case"chat_user_added":return uf(n,[o.user]),void n("user_joined_chat",{chat:o.chat,user:o.user.id});case"chat_user_removed":return void n("user_left_chat",o);case"customer_disconnected":switch(o.reason){case"customer_banned":case"license_not_found":case"product_version_changed":case"unsupported_version":r.dispatch({type:ap,payload:o});break;default:n("disconnected",o)}return;case"incoming_chat_thread":return df(n,o),void o.events.forEach(function(e){n("new_event",{chat:o.thread.chat,event:e})});case"incoming_event":return void n("new_event",o);case"incoming_typing_indicator":return void n(o.isTyping?"user_is_typing":"user_stopped_typing",{chat:o.chat,user:o.user});case"customer_updated":return r.dispatch({type:"update_customer",payload:o}),void n(i,o);default:return void n(i,o)}},ff=function(e){var t=e.auth,n=e.emitter,r=e.socket,a=n.emit,i=rf(0,t);return function(e,o){var c=e.type,s=e.payload;switch(c){case"check_goals":return void function(e,t){var n=e.getState(),r=n.page;r&&r.url&&t.getToken().then(function(e){var t=m({license_id:n.license}),a={customer_fields:mp(n).fields,group_id:n.group||0,page_url:r.url};Object(p.a)(n.serverUrl+"/action/check_goals?"+t,{method:"POST",headers:{"Content-Type":"application/json",Authorization:e.tokenType+" "+e.accessToken},body:JSON.stringify({payload:a})}).catch(f.N)})}(o,t);case ap:return r.destroy(),"manual"!==s.reason&&a("disconnected",s),void n.off();case"emit_events":return void e.payload.forEach(function(e){var t=e[0],n=e[1];a(t,n)});case op:var u={chatsSummary:s.chatsSummary,totalChats:s.totalChats};Object.defineProperty(u,"__unsafeDynamicConfig",{value:s.dynamicConfig}),a("disconnected"===s.previousStatus?"connected":"connection_restored",u);var d=o.getState(),l=d.queuedPushes,h=d.storedUpdates,v=Object.keys(h);return 0!==v.length&&(v.forEach(function(e){Kp(o,Sp(e,h[e])).catch(f.N)}),o.dispatch({type:"clear_stored_updates"})),void(0!==l.length&&(l.forEach(function(e){pf({emit:a,store:o},e)}),o.dispatch({type:"clear_push_queue"})));case"prefetch_token":return void t.getToken().catch(f.N);case"push_received":return sf(o,e),bp(o.getState())?void pf({emit:a,store:o},e):void o.dispatch({type:"queue_push",payload:e});case cp:return void r.reconnect(e.payload.delay);case"request_failed":return void s.reject(Cp(s.error));case"response_received":return sf(o,e),void function(e,t){var n=e.emit,r=e.store,a=t.payload,i=a.action,o=a.promise,c=a.resolve,s=a.response;switch(i){case"get_chat_threads":return uf(n,s.users),void c(s.threads);case up:var u=s.chatsSummary,d=s.totalChats,l=s.users;return uf(n,l),void c({chatsSummary:u,totalChats:d});case"send_event":if(cf(s)){df(n,s);var p=function(e){e.forEach(function(e){n("new_event",{chat:s.thread.chat,event:e})})};if(s.events[0].author===r.getState().users.self.id){var m=s.events,h=m[0],v=m.slice(1);c(h),o.then(function(){p(v)})}else{var b=Object(f.cb)(-1,s.events),g=b[0],_=b[1][0];p(g),c(_)}}return void c(s.event);case"activate_chat":case"start_chat":return df(n,s),void c(s.chat);default:c(s)}}({emit:a,store:o},e);case"send_request":var b=o.getState();return function(e){return"destroyed"===pp(e)}(b)?void lf(o,e,{code:"SDK_DESTROYED",message:"SDK destroyed."}):bp(b)||"login"===e.meta.source?void function(e,t,n){var r=n.payload,a=r.id,i=r.action,o=r.data,c={};c.request_id=a,c.action=i,null!==o&&(c.payload=o),t.emit(c)}(0,r,e):void lf(o,e,{code:"NO_CONNECTION",message:"No connection."});case sp:return void a("customer_id",s);case"socket_connected":return void i(o);case"socket_disconnected":return"connected"===s.previousStatus&&a("connection_lost"),void s.rejects.forEach(function(e){e(Cp({message:"Connection lost.",code:"CONNECTION_LOST"}))});case"stop_connection":return void r.disconnect();case"start_connection":return r.connect(),void o.dispatch({type:"prefetch_token"});default:return}}},mf=function(e){var t=Object(f.db)(function(e,t){var n=t+e.totalEvents;return[n>=50,n]},0,e);return[t[0],t[1].map(function(e){return e.id})]},hf=function(e,t){var n=mf(t);e.threadsSummary=n[0],e.threadsToFetch=n[1]},vf=function(e,t,n){return e.getChatThreads(t,n)},bf=function(e,t,n){var r={done:!1,idle:!0,leftToFetch:1/0,queuedTasks:[],totalThreads:1/0,threadsSummary:null,threadsToFetch:[]},a=function(i,o){var c;r.done?i({done:!0}):r.idle?(r.idle=!1,r.threadsSummary?r.threadsToFetch.length>0?c=vf(t,n,r.threadsToFetch):r.threadsSummary.length>0?(hf(r,r.threadsSummary),c=vf(t,n,r.threadsToFetch)):c=function(e,t,n){return e.getChatThreadsSummary(t,{offset:0}).then(function(r){var a=r.totalThreads-n.leftToFetch;return e.getChatThreadsSummary(t,{offset:a})})}(t,n,r).then(function(e){var a=e.threadsSummary;return hf(r,a),vf(t,n,r.threadsToFetch)}):c=function(e,t){return e.getChatThreadsSummary(t,{offset:0}).then(function(n){var r=n.threadsSummary,a=n.totalThreads,i=mf(r),o=i[0],c=i[1];return Promise.all([{threadsSummary:o,totalThreads:a},vf(e,t,c)])})}(t,n).then(function(e){var t=e[0],n=t.threadsSummary,a=t.totalThreads,i=e[1];return r.threadsSummary=n,r.totalThreads=r.leftToFetch=a,i}),c.then(function(t){i(function(e,t,n){t.idle=!0,t.threadsToFetch=[],t.leftToFetch-=n.length;var r=Object(f.p)(function(e){return e.events},n);return e.dispatch({type:"emit_events",payload:n.map(function(e){return["thread_summary",Fp(e)]})}),0===t.leftToFetch?(t.done=!0,{value:r,done:!0}):{value:r,done:!1}}(e,r,t));var n=r.queuedTasks.shift();n&&a(n.resolve,n.reject)}).catch(function(e){return o(function(e,t){return e.idle=!0,e.queuedTasks.forEach(function(e){return(0,e.reject)(t)}),t}(r,e))})):r.queuedTasks.push({resolve:i,reject:o})};return{next:function(){return new Promise(a)}}},gf=n(184),_f=n.n(gf),yf=function(e){var t=m({license_id:e.getState().license,bh:Object(f.s)()}),n=T(),r=new Ni.a({min:1e3,max:5e3,jitter:.5}),a=!1,i=!1,o=null,c=null,s=function(){c.send('{"action": "ping"}')},u=Object(f.f)(3e4,function(){a&&(i&&s(),u())}),d=function(){i=!0,r.reset(),n.emit("connect"),u()},l=function(){i=!1,c=null,n.emit("disconnect"),g()},p=function(e){var t=e.data,r=JSON.parse(t);"ping"!==r.action&&n.emit("message",r)},h=function(){s(),u()},v=function(){var e;(e=c).removeEventListener("open",d),e.removeEventListener("close",l),e.removeEventListener("message",p),e.removeEventListener("heartbeat",h),i=!1,c.close(),c=null},b=function(){var n;a=!0,c=new _f.a(e.getState().serverUrl+"/rtm/sjs?"+t,void 0,{transports:["websocket","xhr-polling"]}),(n=c).addEventListener("open",d),n.addEventListener("close",l),n.addEventListener("message",p),n.addEventListener("heartbeat",h)},g=function(e){void 0===e&&(e=r.duration()),clearTimeout(o),o=setTimeout(b,e)},_={connect:function(){if(a)throw new Error("Socket is already connected or opening.");b()},destroy:function(){_.off(),_.disconnect()},disconnect:function(){a=!1,clearTimeout(o),null!==c&&v()},reconnect:function(e){if(!a)throw new Error("Socket is not opened.");null!==c&&v(),g(e)},emit:function(e){if(!i)throw new Error("Socket is not connected.");c.send(JSON.stringify(e)),u()},on:n.on,off:n.off};return _},jf=function(e,t){var n=e.dispatch,r=e.getState,a=t.request_id,i=t.payload,o=fp(r(),a),c=o.promise,s=o.resolve,u=o.action;n({type:"response_received",payload:{id:a,action:u,data:o.data,promise:c,resolve:s,response:Jp(u,i)}})},Of=((af={}).check_goals=!0,af.get_chat_threads_summary=!0,af.get_chat_threads=!0,af[up]=!0,af.get_form=!0,af.get_groups_status=!0,af.get_predicted_agent=!0,af.get_url_details=!0,af[dp]=!0,af.send_rich_message_postback=!0,af.send_sneak_peek=!0,af),wf=((of={}).close_thread="thread_closed",of),xf=function(e,t){var n=e.dispatch,r=e.getState,a=function(t){if("response"===t.type)return t.success?void(Of[t.action]&&jf(e,t)):void function(e,t){var n=e.dispatch,r=e.getState,a=t.request_id,i=t.payload,o=fp(r(),a),c=o.reject;o.action;n({type:"request_failed",payload:{id:a,reject:c,error:Qp(0,i.error)}})}(e,t);if("string"===typeof t.request_id){var n=fp(r(),t.request_id);if(n){var a=wf[n.action];if(!a||a===t.action)return void function(e,t){void 0!==fp(e.getState(),t.request_id)&&jf(e,t)}(e,t)}}!function(e,t){e.dispatch({type:"push_received",payload:{action:t.action,push:Yp(t)}})}(e,t)},i=function(){n({type:"socket_connected"})},o=function(){var e=r().requests;n({type:"socket_disconnected",payload:{previousStatus:pp(r()),rejects:Object.keys(e).map(function(t){return e[t].reject})}})};return t.on("connect",i),t.on("message",a),t.on("disconnect",o),function(){t.off("connect",i),t.off("message",a),t.off("disconnect",o)}},Cf=function(e){var t,n=e.auth,r=e.chat,a=e.data,i=e.spec,o=e.store,c=!1,s=new Promise(function(e,s){!function(e){if(e.size>10485760){var t=new Error("The file is too big (max size is "+function(e,t){if(void 0===t&&(t=2),e<1024)return e+" b";var n=e/1024;if(e<1048576)return n.toFixed(t)+" kb";var r=n/1024;return e<1073741824?r.toFixed(t)+" MB":(r/1024).toFixed(t)+" GB"}(10485760)+").");throw t.code="TOO_BIG_FILE",t}}(a.file);var u=o.getState(),l=u.license,p=u.serverUrl+"/action/send_file?"+m({license_id:l}),f=function(e,t){var n={};return n["payload.chat_id"]=e,n["payload.file"]=t.file,t.customId&&(n["payload.custom_id"]=t.customId),n}(r,a);n.getToken().then(function(n){c?s(new Error("Upload cancelled.")):(t=Ki(p,f,Object(d.a)({},i,{headers:{Authorization:n.tokenType+" "+n.accessToken}}))).then(function(t){return e(t.payload)},s)})});return{then:function(e,t){return s.then(e,t)},catch:function(e){return s.catch(e)},cancel:function(){c||(c=!0,t&&t.cancel())}}},Ef=function(e,t){var n;void 0===t&&(t="production"),tp(e);var r=e.autoConnect,a=void 0===r||r,i=Object(l.a)(e,["autoConnect"]),o=function(e){var t=f.y,n=F(),r=Object(I.e)(xp,yp(e),t(Object(I.a)(n)));return r.addSideEffectsHandler=n.add,r}(Object(d.a)({},i,{env:t})),c=T(),s=yf(o),u=np(i,t);o.addSideEffectsHandler(ff({emitter:c,socket:s,auth:u})),xf(o,s);var p=Kp.bind(null,o),m=function(){o.dispatch({type:"start_connection"})},h=Object.freeze(((n={activateChat:function(e,t){return void 0===t&&(t={}),p(Sp("activate_chat",function(e,t){return Object(f.L)(Ip(t),{chat:{id:e}})}(e,t)))},auth:u,cancelRate:function(e,t){return void 0===t&&(t=["score"]),h.getChatThreadsSummary(e).then(function(n){var r=n.threadsSummary;return h.deleteChatThreadProperties(e,Object(f.F)(r).id,{rating:t})})},closeThread:function(e){return p(Sp("close_thread",{chat_id:e}))},connect:m,deleteChatProperties:function(e,t){return p(Sp("delete_chat_properties",{chat_id:e,properties:t}))},deleteChatThreadProperties:function(e,t,n){return p(Sp("delete_chat_thread_properties",{chat_id:e,thread_id:t,properties:n}))},deleteEventProperties:function(e,t,n,r){return p(Sp("delete_chat_thread_properties",{chat_id:e,thread_id:t,event_id:n,properties:r}))},destroy:function(){o.dispatch({type:ap,payload:{reason:"manual"}})},disconnect:function(){o.dispatch({type:"stop_connection"})},getChatHistory:function(e){return bf(o,h,e)},getChatsSummary:function(e){void 0===e&&(e={});var t=e,n=t.offset,r=void 0===n?0:n,a=t.limit,i=void 0===a?10:a;return i>25?Promise.reject(new Error("Specified limit is too high (max 25).")):p(Sp(up,{offset:r,limit:i}))},getChatThreads:function(e,t){return p(Sp("get_chat_threads",{chat_id:e,thread_ids:t}))},getChatThreadsSummary:function(e,t){void 0===t&&(t={});var n=t,r=n.offset,a=void 0===r?0:r,i=n.limit,o=void 0===i?25:i;return o>1e3?Promise.reject(new Error("Specified limit is too high (max 1000).")):p(Sp("get_chat_threads_summary",{chat_id:e,offset:a,limit:o}))},getForm:function(e,t){return p(Sp("get_form",{group_id:e,type:t}))},getGroupsStatus:function(e){return p(Sp("get_groups_status",e?{groups:e,group_ids:e}:{all:!0}))},getPredictedAgent:function(){return p(Sp("get_predicted_agent"))},getUrlDetails:function(e){return p(Sp("get_url_details",{url:e}))},on:c.on,once:c.once,off:c.off,rateChat:function(e,t){return h.getChatThreadsSummary(e).then(function(n){var r=n.threadsSummary;return h.updateChatThreadProperties(e,Object(f.F)(r).id,{rating:t})})},sendEvent:function(e,t,n){return p(function(e,t,n){var r={chat_id:e,event:Ep(t)};return Object(f.D)(n)&&n.attachToLastThread&&(r.attach_to_last_thread=!0),Sp("send_event",r)}(e,t,n))},sendFile:function(e,t,n){return Cf({auth:u,chat:e,data:t,spec:n,store:o})},sendPostback:function(e,t,n,r){var a=r.id,i=r.toggled;return p(Sp("send_rich_message_postback",{chat_id:e,event_id:n,thread_id:t,postback:{id:a,toggled:void 0===i||i}}))},setSneakPeek:function(e,t){var n=o.getState();vp(n,e)&&bp(n)&&p(Sp("send_sneak_peek",{chat_id:e,sneak_peek_text:t})).catch(f.N)},startChat:function(e){return void 0===e&&(e={}),p(Sp("start_chat",Ip(e)))},updateChatProperties:function(e,t){return p(Sp("update_chat_properties",{chat_id:e,properties:t}))},updateChatThreadProperties:function(e,t,n){return p(Sp("update_chat_thread_properties",{chat_id:e,thread_id:t,properties:n}))},updateCustomer:function(e){o.dispatch({type:"update_customer",payload:e});var t=o.getState();bp(t)?p(Sp("update_customer",e)).catch(f.N):gp(t)&&o.dispatch(kp("update_customer",e))},updateCustomerPage:function(e){o.dispatch({type:"update_customer_page",payload:e});var t=o.getState();bp(t)?p(Sp("update_customer_page",e)).catch(f.N):gp(t)&&o.dispatch(kp("update_customer_page",e))},updateEventProperties:function(e,t,n,r){return p(Sp("update_event_properties",{chat_id:e,event_id:n,thread_id:t,properties:r}))},updateLastSeenTimestamp:function(e,t){return p(Sp("update_last_seen_timestamp",function(e){var t={};return t.chat_id=e.chat,"number"===typeof e.timestamp&&(t.timestamp=Math.floor(e.timestamp/1e3)),t}({chat:e,timestamp:t})))}})[rp.default]=Object(f.S)(function(){return Object.freeze({subscribe:function(e){if(!Object(f.D)(e))throw new TypeError("Expected the observer to be an object.");var t=function(t,n){"function"===typeof e.next&&e.next([t,n])};return c.on("*",t),function(){c.off("*",t)}}})}),n));return a?m():o.dispatch({type:"check_goals"}),h},If="SET";function Sf(e){var t=function(e,t){if("object"!==typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===typeof t?t:String(t)}var Tf=function(e){var t=e.thumbnails,n=Object(l.a)(e,["thumbnails"]);return t?pn("rich_message",Object(d.a)({},n,{card:mn({image:Object(d.a)({},t.default,{link:n.url,srcset:t.default.url+" 1x, "+t.high.url+" 2x"})})})):pn("message",Object(d.a)({},n,{text:Object(f.F)(n.url.split("/"))}))},kf=function(e){return"offline"===e?"offline":"online"},Pf=function(e,t){return e.getGroupsStatus(t).then(function(e){return Object(f.H)(kf,e)})},Af=function(e){return Ji(Yi(e))},Nf=function(e){return Ji(ln(function(e){return Object(d.a)({},e,{fields:e.fields.map(function(e,t){return Object(d.a)({},e,{id:String(t)})})})}(e)))},Vf=function(e){var t=e.localization_url,n=e.serv;return Object(p.a)("https://"+n+t).then(function(e){return e.json()}).then(function(e){var t=e.localization;return Object(f.G)(function(e){return e.toLowerCase()},t)})},Mf=function(e,t){var n=t.numberInQueue,r=t.waitingTime,a=t.thread;e.updateView("minimized",{text:e.localize("embedded_waiting_for_operator")});var i={active:!0,properties:{queued:!0}};if(a&&(i.properties.lastThread=a),e.updateChat("liveChatChatId",i),"Chat"!==e.getCurrentView()||!In("liveChatChatId",e)){var o={fields:[{type:"information",value:e.localize("user_in_queue").replace("%number%",n).replace("%minutes%",Math.floor(r/60))}]};e.updateView("Chat/queue",o),e.setDefaultView("Chat","queue")}},zf=function(e,t,n){var r=e.license,i=e.group,o=e.region,c=e.uniqueGroups,s=Pl(),u=!t.getApplicationState("clientLimitExceeded"),p=t.getApplicationState("page"),m=t.getSessionUser(),h={license:r,clientId:"c5e4f61e1a6c3b1521b541bc5c5a2ac5",customer:{name:m.name,email:m.email,fields:m.properties},region:o,page:Object(f.T)(["url","title"],p),referrer:p.referrer,autoConnect:u,uniqueGroups:c};null!==i&&(h.group=i);var v=Ef(h,"production");var b=function(){t.updateView("Chat/information",{text:t.localize("lost_connection")}),t.setDefaultView("Chat","information"),t.setCurrentView("Chat"),v.destroy(),t.setApplicationState({destroyed:!0})},g=null,_=null,y=function(){return t.getChat("liveChatChatId").serverId},j=function(e){g=e,null===y()&&t.setChatServerId("liveChatChatId",e)},w=function(){return t.getChat("liveChatChatId").properties.lastThread},C=function(){return n.pre_chat_survey?Yi(n.pre_chat_survey):null},E=function(e){return"good"===e?1:"bad"===e?0:null},I=function(e){return v.rateChat(y(),Object(f.d)({comment:e.rateComment,score:E(e.rating)})).then(function(){t.updateChat("liveChatChatId",{properties:Object(f.d)({rate:e.rating,rateComment:e.rateComment})})},f.N)},S=function(e){return v.cancelRate(y(),e).then(function(){t.updateChat("liveChatChatId",{properties:e.reduce(function(e,t){return"comment"===t?e.rateComment=null:"score"===t&&(e.rate=null),e},{})})},f.N)},T=function(){return v.getForm(t.getApplicationState("group"),"ticket").then(function(e){if(!e.enabled)return t.updateView("Chat/information",{text:t.localize("agents_not_available")}),t.setDefaultView("Chat","information"),void t.setCurrentView("Chat");var n=fr(t,Nf(e.form));t.updateView("Chat/offline",n.properties),t.setDefaultView("Chat","offline"),t.setCurrentView("Chat")})},k=function(){Yn(t),v.getForm(t.getApplicationState("group"),"postchat").then(function(e){var n=e.enabled,r=e.form;n&&(dr(t,ln(r)),ir(t))},f.N)},P=function(e){var n=function(e){var n=t.getChat("liveChatChatId").properties,r=n.rate,a=n.rateComment,i={comment:"NOTHING",score:"NOTHING"};e.rating!==r&&(i.score=null===e.rating?"CANCEL":If);var o="string"===typeof e.rateComment&&""!==e.rateComment;return a&&!o||"CANCEL"===i.score&&a?i.comment="CANCEL":!o||a&&e.rateComment===a||(i.comment=If),i}(e);"NOTHING"===n.score&&"NOTHING"===n.comment||(n.score!==If||n.comment!==If?"CANCEL"!==n.score||"CANCEL"!==n.comment?("CANCEL"===n.score?S(["score"]):n.score===If&&I({rating:e.rating}),"CANCEL"===n.comment?S(["comment"]):n.comment===If&&I({rateComment:e.rateComment})):S(["comment","score"]):I(e))},A=function(e){var n=e.id,r=e.name,a=e.email,i=void 0===a?null:a;if(t.getSessionUser().id===n){var o={email:i,properties:e.fields};return"Customer"!==r&&(o.name=r),void t.updateUser(n,o)}t.getUser(n)||t.addUser({id:n,type:"agent",name:r,avatar:"https://"+O(e.avatar),properties:{jobTitle:e.jobTitle}})},N=!1,V=function(){N=!0,or.apply(void 0,arguments);t.on("update_chat",function e(n){n.active&&(t.off("update_chat",e),N=!1)})},M=function(e){if(e.rating){var n=e.rating,r=n.score,a=n.comment;return"number"===typeof r&&t.updateChat("liveChatChatId",{properties:{rate:1===r?"good":"bad"}}),void("string"===typeof a&&t.updateChat("liveChatChatId",{properties:{rateComment:a}}))}if(e.lc2){var i=e.lc2,o=i.queue_pos,c=i.queue_waiting_time;if(void 0===o||void 0===c)return;if(o>0&&c>0)return void Mf(t,{numberInQueue:o,waitingTime:c});-1===o&&-1===c&&(t.updateView("minimized",{text:t.localize("embedded_chat_with",{operator:gn("liveChatChatId",t).name})}),t.updateChat("liveChatChatId",{active:!0,properties:{queued:!1}}),t.updateView("Chat",{inputMode:"text"}),t.setDefaultView("Chat","timeline"),t.setCurrentView("Chat"))}},z=function(e){switch(e.systemMessageType){case"routing.archived_inactive":return void t.addEvent("liveChatChatId",vn(Object(d.a)({},e,{systemMessageType:"client_inactive"})));case"manual_archived_agent":return void t.addEvent("liveChatChatId",vn(Object(d.a)({},e,{systemMessageType:"operator_closed_session",textVariables:{operator:e.textVars.agent}})));case"manual_archived_customer":case"system_archived":case"customer_banned":case"routing.archived_deleted":case"routing.archived_disconnected":case"routing.archived_offline":case"routing.archived_other":case"routing.archived_remotely_signed_out":case"routing.archived_signed_out":case"archived_customer_disconnected":return void t.addEvent("liveChatChatId",vn(Object(d.a)({},e,{systemMessageType:"chat_session_closed"})));case"routing.assigned_other":return void t.addEvent("liveChatChatId",vn(Object(d.a)({},e,{systemMessageType:"user_transfer",textVariables:{operator:e.textVars.agent}})));case"routing.assigned_deleted":case"routing.assigned_disconnected":case"routing.assigned_inactive":case"routing.assigned_remotely_signed_out":case"routing.assigned_signed_out":return void t.addEvent("liveChatChatId",vn(Object(d.a)({},e,{systemMessageType:"user_transfer",textVariables:{operator:e.textVars.agent_added}})));case"chat_transferred":return void t.addEvent("liveChatChatId",vn(Object(d.a)({},e,{systemMessageType:"user_transfer",textVariables:{operator:e.textVars.targets}})));case"agent_joined":case"agent_added":return void t.addEvent("liveChatChatId",vn(Object(d.a)({},e,{systemMessageType:"operator_joined_conference",textVariables:{operator:e.textVars.agent}})));case"agent_left":case"agent_removed":return void t.addEvent("liveChatChatId",vn(Object(d.a)({},e,{systemMessageType:"operator_left_conference",textVariables:{operator:e.textVars.agent}})));case"rating.chat_rated":return void t.addEvent("liveChatChatId",vn(Object(d.a)({},e,{systemMessageType:"rate_me_confirmation_"+e.textVars.score})));case"rating.chat_commented":return void t.addEvent("liveChatChatId",vn(Object(d.a)({},e,{systemMessageType:"rate_me_comment_added",textVariables:{comment:e.textVars.comment}})));case"rating.chat_rating_canceled":return void t.addEvent("liveChatChatId",vn(Object(d.a)({},e,{systemMessageType:"rate_me_cancel"})));default:return}},R=function(e){if("message"!==e.type)"rich_message"!==e.type?"file"!==e.type?"system_message"!==e.type||z(e):t.addEvent("liveChatChatId",Tf(e)):t.addEvent("liveChatChatId",hn(e));else{var n=t.addEvent("liveChatChatId",fn(e));Vl(t,n)}},D=function(e){return{welcome_author_id:e.author,welcome_text:e.properties.originalText}},q=function(){var e,n=function(e,t){var n=t.getEvents(e);return Object(f.k)(function(e){return"invitation"===e.id},n)}("liveChatChatId",t);if(n)return{lc2:(e=n,Object(d.a)({},D(e),{greeting_id:e.properties.greetingId,greeting_unique_id:e.properties.greetingUniqueId}))};var r=t.getEvent("liveChatChatId","welcome_message");return r?{lc2:D(r)}:null},L=function(e){if(Sn("liveChatChatId",t)){var n=e.agent;A({id:n.id,name:n.name,avatar:n.avatar,type:"agent",jobTitle:n.job_title}),nr(t,n.id),s.add(function(){pr(t,{authorId:n.id,text:e.text,receivedFirstTime:e.displayed_first_time,properties:{greetingId:e.id,greetingUniqueId:e.unique_id}})})}},F=function(e){return!!e&&-1!==e.indexOf(t.getApplicationState("group"))},U=function(e){t.setApplicationState({availability:F(e)?"online":"offline"})},B=function(e){U(e.online_groups_ids)},G=function(e){return v.getChatThreads(y(),[e]).then(f.F).then(function(n){var r=n.events,a=n.users,i=n.lastSeenTimestamps,o=n.properties;t.updateChat("liveChatChatId",{active:!0,properties:{lastThread:e}}),Object(f.x)("rating",o)&&!Object(f.x)("score",o.rating)&&t.updateChat("liveChatChatId",{properties:{rate:null}}),nr(t,Object(f.F)(a.filter(function(e){return e!==t.getSessionUser().id}))),M(o);var c=t.getSessionUser().id,s=i[c],u=Object(l.a)(i,[c].map(Sf)),p=Math.max.apply(Math,Object(f.nb)(u).filter(Boolean));r.forEach(function(e){if(!(t.hasEvent("liveChatChatId",e.id)||void 0!==e.customId&&t.hasEvent("liveChatChatId",e.customId)||In("liveChatChatId",t)&&Object(f.u)("properties.lc2.welcome_message",e))){var n=e.author===c?p>=e.timestamp:s>=e.timestamp,r=Object(d.a)({},e,{seen:n});"file"!==e.type?"message"!==e.type?"rich_message"!==e.type?"system_message"!==e.type||z(e):t.addEvent("liveChatChatId",hn(r)):t.addEvent("liveChatChatId",fn(r)):t.addEvent("liveChatChatId",Tf(r))}}),"queue"!==t.getDefaultView("Chat")&&t.setDefaultView("Chat","timeline")})};v.on("chat_thread_properties_deleted",function(e){var n=e.chat,r=e.thread,a=e.properties;n===y()&&r===w()&&Object(f.x)("rating",a)&&-1!==a.rating.indexOf("score")&&t.updateChat("liveChatChatId",{properties:{rate:null}})}),v.on("chat_thread_properties_updated",function(e){var t=e.chat,n=e.thread,r=e.properties;t===y()&&n===w()&&M(r)}),v.once("customer_id",t.setSessionUserId),v.on("customer_updated",function(e){t.updateUser(t.getSessionId(),Object(d.a)({},Object(f.W)(["name","email"],e),{properties:e.fields}))}),v.on("event_updated",function(e){var n=e.chat,r=e.thread,a=e.event;if(n===y()&&r===w()&&Object(f.u)("properties.lc2.welcome_message",a)){var i=t.getEventByServerId("liveChatChatId",a.id);a.author!==i.author&&(t.setEventData("liveChatChatId",i.id,{author:a.author}),t.recalculateTimeline("liveChatChatId")),a.text!==i.properties.text&&t.updateEvent("liveChatChatId",i.id,{properties:{text:a.text}})}}),t.on("set_application_state",function(e){var n=e.paused,r=e.focused;n&&r&&(v.connect(),t.setApplicationState({paused:!1}))}),v.on("disconnected",function(e){switch(e.reason){case"product_version_changed":case"wrong_product_version":return void t.emit("protocol_upgraded",{version:"2"});case"customer_banned":case"license_not_found":case"unsupported_version":case"users_limit_reached":return void b();case"inactivity_timeout":return void(t.getApplicationState("focused")||(t.setApplicationState({paused:!0}),t.setConnectionState(a.RECONNECTING),v.disconnect()));default:return}}),v.on("user_joined_chat",function(e){var n=e.chat,r=e.user;n===y()&&(t.addParticipant("liveChatChatId",r),t.getSessionUser().id!==r&&gn("liveChatChatId",t)!==r&&nr(t,r))}),v.on("user_left_chat",function(e){var n=e.chat,r=e.user;n===y()&&(t.removeParticipant("liveChatChatId",r),t.getSessionUser().id!==r&&gn("liveChatChatId",t)===r&&nr(t,null))}),v.on("user_data",A);var H=new Promise(function(e){v.on("connected",function t(n){v.off("connected",t),e(n)})});cr(Go(n),t);var W=C();W&&lr(W,t);var Y=function(e){var t=e.chatsSummary,n=e.__unsafeDynamicConfig;if(B(n),0===t.length)return Object(f.x)("greeting",n)&&L(n.greeting),null;var r=t[0],a=r.id;return j(a),r.active?G(r.lastThread):(Object(f.x)("greeting",n)&&L(n.greeting),null)};u?Vf(n).then(t.setLocalization).then(function(){return H}).then(Y).then(function(){s.run(),t.setConnectionState(a.CONNECTED),t.setApplicationState({ready:!0})}):Vf(n).then(function(e){var r,i;t.setLocalization(e),t.setConnectionState(a.CONNECTED),U(n.skills_online),t.setApplicationState({ready:!0}),Wr()((r=document,i=["click","touchstart"],Pr.a.apply(void 0,i.map(function(e){return Object(Tr.a)(r,e)}))),ta()(1),Sr()(function(){H.then(Y),t.setApplicationState({clientLimitExceededLifted:!0}),v.connect()}))}),v.on("connection_lost",function(){t.setConnectionState(a.RECONNECTING)}),v.on("connection_restored",function(e){var n=e.chatsSummary,r=e.__unsafeDynamicConfig;Promise.resolve().then(function(){if(B(r),0===n.length)return Object(f.x)("greeting",r)&&L(r.greeting),null;var e=y();if(null===e){var a=n[0],i=a.id;return j(i),a.active?(G(a.lastThread),null):(Object(f.x)("greeting",r)&&L(r.greeting),null)}var o=Object(f.k)(function(t){return t.id===e},n);if(!o)return b(),null;var c=t.getChat("liveChatChatId");return o.active?(o.lastThread!==c.properties.lastThread&&V("liveChatChatId",t),G(o.lastThread)):(c.active?k():Object(f.x)("greeting",r)&&L(r.greeting),null)}).then(function(){t.setConnectionState(a.CONNECTED)})}),v.on("incoming_multicast",function(e){var n=e.type,r=e.content;if("lc2"===n)if("groups_update"===r.name&&Object(f.x)("groups",r)){var a=t.getApplicationState("group"),i=Object(f.k)(function(e){return e.id===a},r.groups);if(!i)return;t.setApplicationState({availability:kf(i.status)})}else Object(f.x)("greeting",r)&&L(r.greeting)}),v.on("last_seen_timestamp_updated",function(e){var n=e.chat,r=e.user,a=e.timestamp;n===y()&&(t.getSessionUser().id===r?On:jn)("liveChatChatId",a,t).forEach(function(e){t.updateEvent("liveChatChatId",e.id,{seen:!0})})}),v.on("new_event",function(e){var n=e.chat,r=e.event;n===y()&&("postchat"!==Object(f.u)("properties.lc2.form_type.value",r)?(ie&&x("received_event_during_chat_starting"),R(r)):t.setDefaultView("Chat","timeline"))}),v.on("thread_closed",function(e){e.chat===y()&&k()}),v.on("thread_summary",function(e){var n=t.getChat("liveChatChatId");if((null===n.serverId||n.serverId===e.chat)&&e.active)if(j(e.chat),ie||V("liveChatChatId",t),e.properties.lc2&&e.properties.lc2.queue_pos>0&&e.properties.lc2.queue_waiting_time>0){var r=e.properties.lc2,a=r.queue_pos,i=r.queue_waiting_time;Mf(t,{numberInQueue:a,waitingTime:i,thread:e.id})}else $n({id:e.chat,thread:e.id},t)});var J=function(e){var n=e.user;return e.chat===y()&&t.getSessionUser().id!==n},Q=Wr()(Ar(v,"user_is_typing"),Cr()(J),Dr()(function(){return!0})),K=Wr()(Ar(v,"user_stopped_typing"),Cr()(J),Dr()(function(){return!1}));Wr()(Pr()(Wr()(Q,Cr()(function(){return!t.getChat("liveChatChatId").properties.messageDraft})),K),$r(function(e){return e?Object(br.a)(Object(Br.a)(!0),Wr()(Object(ra.a)(1e4),Dr()(function(){return!1}))):Object(Br.a)(!1)}),Object(jr.a)(),Sr()(function(e){t.updateChat("liveChatChatId",{properties:{agentIsTyping:e}})})),t.on("request_update_chat",function(e){var n=e.resolve,r=e.reject,a=e.data,i=a.properties,o=void 0===i?{}:i,c=Object(l.a)(a,["properties"]);if(o.rateComment){var s=o.rateComment;Dl(t,s),v.rateChat(y(),{comment:s}).then(n,r)}else if("undefined"!==typeof o.rate){if(ql(t,o.rate),null===o.rate)return void v.cancelRate(y()).then(n,r);v.rateChat(y(),{score:E(o.rate)}).then(n,r)}else o.transcriptSentTo?v.updateChatThreadProperties(y(),w(),{routing:{transcript_email:o.transcriptSentTo}}).then(n,r):!1===c.active?v.closeThread(y()).then(function(){k(),n()},r):"string"===typeof o.messageDraft&&(t.getChat("liveChatChatId").active&&v.setSneakPeek(y(),o.messageDraft),n())});var X=function(e){return"confirm_subscription"===e.meta?"checkbox_for_email":"groupSelect"===e.meta?"group_chooser":"name"===e.name?"name":"text"===e.type?"question":e.type},Z=function(e,n){var r=t.getView("Chat/"+e),a=un(e,n,t),i=a.fields,o={filledForm:{type:"filled_form",form_id:r.id,fields:r.fields.filter(function(e){return void 0!==e.serverName&&"rating"!==e.type&&"information"!==e.type}).map(function(e){var t=e.label,n=e.serverName,r={label:t,type:X(e),id:n};if(Object(f.A)(e.options)){var a=Object(f.x)(n,i)?Object(f.i)(i[n]):[],o=e.options.filter(function(e){return Object(f.z)(e.originalValue,a)}).map(function(e){return{label:e.label,value:e.originalValue}});if("confirm_subscription"===e.meta)r.label=e.options[0].label,r.answer=!!a.length;else if("checkbox"===r.type)r.answers=o.map(function(e){return{label:e.label,id:e.value}});else if("groupSelect"===e.meta){var c=o[0];r.answer={group_id:parseInt(c.value,10),label:c.label}}else if(o.length){var s=o[0];r.answer={id:s.value,label:s.label}}}else Object(f.x)(n,i)&&(r.answer=i[n]);return r}),properties:{lc2:{form_type:e}}}};return void 0!==a.choosenGroup&&(o.choosenGroup=a.choosenGroup),o};t.on("request_update_event",function(e){var r=t.getEvent("liveChatChatId",e.id);if(e.data.seen)v.updateLastSeenTimestamp(y(),r.timestamp).then(e.resolve,e.resolve);else if("offline"===r.properties.formType){var a=e.data.properties.answers,i=un("offline",a,t).fields,o=t.getApplicationState(),c=t.getSessionUser(),s=gc({license:o.license,group:o.group,visitorId:c.id,visitorData:{pageUrl:o.page.url}},Af(n.offline_form),i);ro("v2/tickets/new",{environment:"production",license:o.license,body:s}).then(function(n){Fl(t,a,_c(n.id,s)),e.resolve(),t.updateView("Chat/information",{text:t.localize("offline_message_sent")}),t.setDefaultView("Chat","information"),t.setCurrentView("Chat")})}else if("prechat"===r.properties.formType){var u=e.data.properties.answers;zl(t,u),t.setDefaultView("Chat","loader");var d=Object(f.W)(["name","email"],u);Object(f.B)(d)||v.updateCustomer(d);var l=Z("prechat",u),p=l.filledForm,m=l.choosenGroup,h={parsedEvent:p},g=function(){se(h).then(function(){e.resolve(),"queue"!==t.getDefaultView("Chat")&&t.setDefaultView("Chat","timeline")},function(t){"GROUPS_OFFLINE"!==t.code?e.reject():T().then(e.resolve,e.reject)})};if(void 0!==m)return h.access={groups:[m]},void function(e,t){return Pf(e,[t]).then(function(e){return e[t]})}(v,m).then(function(e){t.setApplicationState({group:m}),"online"===e?g():v.getForm(t.getApplicationState("group"),"ticket").then(function(e){e.enabled?(!function(e,t){sr(e,t,{enabled:!0})}(t,"offlineForm"),_=Nf(e.form)):ur(t,"offlineForm"),t.setApplicationState({availability:"offline"})},function(){ur(t,"offlineForm"),t.setApplicationState({availability:"offline"})})},b);g()}else if("postchat"===r.properties.formType){var j=e.data.properties.answers;Rl(t,j),Object(f.x)("rating",j)&&P(j),v.sendEvent(y(),Z("postchat",j).filledForm,{attachToLastThread:!0}).then(function(){e.resolve(),t.setDefaultView("Chat","timeline")})}}),t.on("request_update_user",function(e){var n=e.resolve,r=e.id,a=e.data,i=a.properties,o=Object(l.a)(a,["properties"]);if(t.getSessionId()===r){var c=Object(f.d)({name:o.name,email:o.email,fields:i});v.updateCustomer(c),n()}}),t.on("update_event",function(e){var n=e.event;"file"===n.type&&n.properties.canceled&&Wn(t,n.id)}),t.on("request_set_user_properties",function(e){var n=e.resolve,r=e.id,a=e.properties;if(t.getSessionId()===r){var i=Object(f.d)({name:a.name,email:a.email,fields:a});v.updateCustomer(i),n()}});var $=function(e){var n=e.type,r=e.id;if("message"===n||"url_preview"===n){var a=e.properties,i=a.text,o=a.triggeredBy,c={type:"message",customId:r,text:i};if(o&&"action_button"===o.type){var s=t.getEvent("liveChatChatId",o.event),u=s.serverId,d=s.properties.thread;c.postback={id:o.button.postback,type:o.button.type,value:o.button.value,event_id:u,thread_id:d}}return c}},ee=function(e,n){var r=n.id,a=n.timestamp,i=n.thread;Ll(t,e,a),t.setEventServerId("liveChatChatId",e.id,r),t.updateEvent("liveChatChatId",e.id,{delivered:!0,properties:{serverTimestamp:a,thread:i}})},te=function(e,n){throw t.updateEvent("liveChatChatId",e.id,{failed:!0}),n},ne=function(e){var n=e.event,r=e.meta;if("file"===n.type)return Gn(t,n.id),v.sendFile(y(),{customId:n.id,file:r.file},{onProgress:function(e){t.updateEvent("liveChatChatId",n.id,{properties:{progress:e}})}}).then(function(e){var r=e.url;t.updateEvent("liveChatChatId",n.id,{delivered:!0,properties:{url:r}}),Wn(t,n.id)},function(e){var r={failed:!0,failReason:"TOO_BIG_FILE"===e.code?t.localize("cannot_upload_a_file_over_10mb"):t.localize("upload_failed")};t.updateEvent("liveChatChatId",n.id,{properties:r})});if("message"===n.type)return v.sendEvent(y(),$(n)).then(function(e){ee(n,e)},function(e){te(n,e)});if("rich_message_postback"===n.type){var a=n.properties,i=a.eventId,o=Object(l.a)(a,["eventId"]),c=t.getEvent("liveChatChatId",i),s=c.id,u=c.properties.thread;return v.sendPostback(y(),u,s,o).catch(f.N)}if("url_preview"===n.type){var d=v.getUrlDetails(n.properties.url).catch(function(){return null});return v.sendEvent(y(),$(n)).then(function(e){ee(n,e),d.then(function(r){if(null!==r){var a=r.title,i=r.description,o=r.image,c=o.url,s=o.width,u=o.height,d=r.url;return t.updateEvent("liveChatChatId",n.id,{properties:{title:a,description:i,image:{url:c,link:d}}}),v.updateEventProperties(y(),e.thread,e.id,{url_details:{title:a,description:i,url:d,image_url:c,image_width:s,image_height:u}})}}).catch(f.N)}).catch(function(e){te(n,e)})}},re=function(e){return e.filter(function(e){return"filled_form"!==e.type&&((!Object(f.u)("properties.lc2.welcome_message",e)||!In("liveChatChatId",t))&&!t.hasEventByServerId("liveChatChatId",e.id))})},ae=function(e){var n=xn("liveChatChatId",t);if(n){var r=Object(f.k)(function(e){return Object(f.u)("properties.lc2.welcome_message",e)},e),a={serverId:r.id},i=r.author!==n.author;i&&(a.author=r.author),t.setEventData("liveChatChatId",n.id,a),r.text!==n.properties.text&&t.updateEvent("liveChatChatId",n.id,{properties:{text:r.text}}),i&&(nr(t,r.author),t.recalculateTimeline("liveChatChatId"))}},ie=!1,oe=[],ce=function(e){return v.activateChat(y(),e)},se=function(e){void 0===e&&(e={}),ie=!0;var n=t.getSessionUser();"Customer"!==n.name&&n.name||v.updateCustomer({name:t.localize("client")});var r={threadProperties:q()||{}};e.access&&(r.access=e.access);var a,i=y()?ce:v.startChat;if(e.event&&"file"===e.event.type)a=i(r).then(function(e){var t=e.events;return ae(t),re(t).forEach(R),e}).then(function(t){return Promise.all([t,ne(e)])}).then(function(e){return e[0]});else if(e.event||e.parsedEvent){var o=e.parsedEvent?e.parsedEvent:$(e.event);r.events=[o],a=i(r).then(function(e){var n,r=e.events;return n=r,[o].forEach(function(e){var r=Object(f.k)(function(t){return void 0!==e.customId&&t.customId===e.customId},n);r&&(t.setEventServerId("liveChatChatId",e.customId,r.id),t.updateEvent("liveChatChatId",e.customId,{delivered:!0,properties:{serverTimestamp:r.timestamp,thread:r.thread}}))}),ae(r),re(r).forEach(R),e})}else a=i(r).then(function(e){var t=e.events;return re(t).forEach(R),e});return a.then(function(e){ie=!1;var t=oe;return oe=[],t.forEach(ne),e},function(e){ie=!1;var n=oe;if(oe=[],n.forEach(function(e){t.updateEvent("liveChatChatId",e.id,{failed:!0})}),"GROUPS_OFFLINE"===e.code){var r=new Error("Groups offline.");throw r.code=e.code,r}throw e})};t.on("send_event",function(e){ie?oe.push(e):y()&&t.getChat("liveChatChatId").active?ne(e):se(e).catch(function(n){"GROUPS_OFFLINE"!==n.code?t.updateEvent("liveChatChatId",e.event.id,{failed:!0}):T()})});var ue=function(){if(N||t.getChat("liveChatChatId").properties.queued)return{type:"nothing"};var e=t.getApplicationState();return t.getApplicationState("destroyed")?{type:"set_current_view",view:"Chat",defaultView:"information",changeCurrentView:!0}:"offline"===t.getApplicationState("availability")?e.config.features.offlineForm.enabled?{type:"set_current_view",view:"Chat",defaultView:"offline",props:fr(t,_||dn(Af(n.offline_form))).properties,changeCurrentView:!1}:{type:"set_current_view",view:"Chat",defaultView:"information",props:{text:t.localize("agents_not_available")},changeCurrentView:!1}:In("liveChatChatId",t)?{type:"set_current_view",view:"Chat",defaultView:"timeline",changeCurrentView:!1}:e.maximized?e.config.features.preChatForm.enabled?{type:"show_prechat"}:v.getPredictedAgent().then(function(e){return{type:"predicted_agent",agent:e}},function(e){return"GROUP_UNAVAILABLE"===e.code?{type:"start_thread"}:{type:"panic"}}):{type:"nothing"}},de=function(){var e=t.getChat("liveChatChatId");return!e.active&&!e.properties.ended},le=function(){t.updateView("minimized",{hidden:!1})},pe=Ul(t),fe=Wr()(ca(t,function(e){return e.application.destroyed}),Cr()(Boolean),ta()(1),Yr.a),me=function(e){return Wr()(pe,$r(e))},he=Wr()(me(function(){return ca(t,function(e){return e.application.maximized})}),Cr()(Boolean),Yr.a);Wr()(he,Sr()(le));var ve=Wr()(Ar(t,"flush_chat"),Jr.a);Wr()(ve,Sr()(function(){j(g);var e=C();e&&lr(e,t),_=null,t.updateView("Chat",{inputMode:"text"}),t.updateView("minimized",{text:"online"===t.getApplicationState("availability")?t.localize("embedded_chat_now"):t.localize("embedded_leave_message")})}));var be=Wr()(ca(t,function(e){return e.application.availability}),Kr()(1),Jr.a,Object(Gr.a)(function(e){return"online"===e})),ge=be[0],_e=be[1];Wr()(_e,Cr()(de),Sr()(function(){t.updateView("minimized",{text:t.localize("embedded_leave_message")})})),Wr()(ge,Cr()(de),Sr()(function(){t.updateView("minimized",{text:t.localize("embedded_chat_now")}),t.getView("minimized").hidden&&le()})),Wr()(me(function(){if(!t.getApplicationState("config").features.preChatForm.enabled)return Ur.a;var e=ca(t,function(){return t.getDefaultView("Chat")});return Wr()(Pr()(he,Wr()(e,Cr()(function(e){return"prechat"===e}))),$r(function(){var e=t.getView("Chat/prechat");return Wr()(Object(Mr.a)(function(e,t){var n=Object(f.l)(function(e){return"groupSelect"===e.meta},t.fields);if(-1===n)return Promise.resolve(t);var r=t.fields[n],a=r.options.map(function(e){return parseInt(e.groupNumber,10)});return Pf(e,a).then(function(e){return Object(d.a)({},t,{fields:Object(f.mb)(n,Object(d.a)({},r,{options:r.options.map(function(t){return Object(d.a)({},t,{meta:{online:"online"===e[parseInt(t.groupNumber,10)]}})})}),t.fields)})})}(v,e)),Fr)}))}),Sr()(function(e){t.updateView("Chat/prechat",e)})),Wr()(me(function(){return Pr()(he,ge,_e,ve)}),Cr()(de),Object(wr.a)(function(){return Object(Mr.a)((e=ue,new Promise(function(t){t(e())})));var e}),Sr()(function(e){switch(e.type){case"panic":return void b();case"predicted_agent":var n=e.agent;A(Object(d.a)({},n,{type:"agent",jobTitle:n.job_title})),nr(t,n.id);var r=t.localize("welcome_to_chat");return t.addEvent("liveChatChatId",fn({id:"welcome_message",type:"message",author:n.id,timestamp:Date.now(),seen:!0,text:An(t,r),originalText:r,properties:{}})),void t.setDefaultView("Chat","timeline");case"set_current_view":var a=e.defaultView?e.view+"/"+e.defaultView:e.view;return e.props&&t.updateView(a,e.props),e.defaultView&&t.setDefaultView(e.view,e.defaultView),void(e.changeCurrentView&&t.setCurrentView(e.view));case"show_prechat":return void ar(t);case"start_thread":return void se().catch(function(e){"WIDGET_DESTROYED"!==e.code&&("GROUPS_OFFLINE"!==e.code?b():T())});default:return}})),Wr()(ca(t,function(e){return e.application.page}),Kr()(1),Object(na.a)(fe),Sr()(function(e){var t=e.url,n=e.title;v.updateCustomerPage({url:t,title:n})}))},Rf=function(e){return e.some(f.y)},Df=function(e,t){if(t){var n,r=(n=t,Pr()(Object(Er.a)(Object(zr.a)(function(){var e=new Promise(function(e){n.call("isFocused").then(e),setTimeout(function(){return e(!1)},1e3)});return Object(Mr.a)(e)})),Ar(n,"focus"))),a=Wr()(qr(),Yr.a);Wr()(a,Sr()(function(e){t.emit("focus",e)})),Wr()(vr()(a,r),Object(yr.a)(50),Dr()(Rf),Object(jr.a)(),Sr()(function(t){e.setApplicationState({focused:t})}))}else Wr()(qr(),Sr()(function(t){e.setApplicationState({focused:t})}))},qf=/\.(\w{1,})$/i,Lf=function(e){return e.match(qf)[1]},Ff=window.AudioContext||window.webkitAudioContext,Uf=Ff?new Ff:null,Bf=!Ff,Gf=Bf?null:[],Hf=function(e){"function"===typeof e.start?e.start(0):e.noteOn(0)},Wf=Bf?f.N:function(){var e=function e(){document.removeEventListener("click",e,!0),document.removeEventListener("touchend",e,!0),Gf.forEach(function(e){e.stop()}),Gf=null,Uf.resume(),function(){var e=Uf.createBuffer(1,1,22050),t=Uf.createBufferSource();t.buffer=e,t.connect(Uf.destination),Hf(t)}()};document.addEventListener("click",e,!0),document.addEventListener("touchend",e,!0)},Yf=function(e){var t={};return function(n){return t[n]?t[n]:(t[n]=e(n).finally(function(){delete t[n]}),t[n])}},Jf=function(e){return new Promise(function(t,n){Uf.decodeAudioData(e,t,n)})},Qf=function(e){return{play:function(){var t=Uf.createBufferSource();return t.connect(Uf.destination),t.buffer=e,Hf(t),{stop:function(){!function(e){"function"===typeof e.stop?e.stop(0):e.noteOff(0)}(t)}}}}},Kf=Bf?function(e){return new Promise(function(t,n){var r=new Audio(e);r.onloadeddata=function(){t(r)},r.onerror=n})}:function(e){return(t=e,new Promise(function(e,n){var r=new XMLHttpRequest;r.onload=function(){e(r.response)},r.onerror=n,r.open("GET",t),r.responseType="arraybuffer",r.send()})).then(Jf).then(Qf).catch(function(e){throw e?void 0!==e.message&&void 0!==e.code&&void 0!==e.name&&(e=new Error(e.message+" - preloading error. canPlayType ogg? "+(new Audio).canPlayType("audio/ogg")+" canPlayType mp3? "+(new Audio).canPlayType("audio/mp3")+". keys: "+JSON.stringify({code:e.code,name:e.name,constructor:e.constructor.name}))):e=new Error("Preloading error - typeof: "+typeof e+", isNul: "+(null===e)+"."),e});var t},Xf=function(e){var t=e.play();Gf&&Gf.push(t)};var Zf,$f=n(185),em=n.n($f),tm=n(186),nm=function(e){var t=new Audio,n=Object.keys(e).reduce(function(n,r){var a=Object(f.k)(function(e){var n=Lf(e).toLowerCase();return""!==t.canPlayType("audio/"+n)},Object(f.i)(e[r]));return a||Promise.reject(new Error("soundPlayer error. Can't play any type.")),n[r]={sound:null,source:a},n},{}),r=Yf(function(e){return Kf(n[e].source)});return{play:function(e){var t=n[e];t.sound?Xf(t.sound):r(e).then(function(t){n[e].sound=t,Xf(t)})},preload:r}}(((Zf={}).new_message=[n.n(tm).a,em.a],Zf));Wf(),nm.preload("new_message");var rm=Date.now()-2e3,am=function(e){e.on("add_event",function(t){var n=t.event;if(!e.getApplicationState().muted){var r=e.getSessionUserId(),a=Date.now();"system"!==n.author&&"welcome_message"!==n.id&&n.author!==r&&a-rm>2e3&&(nm.play("new_message"),rm=a)}})},im=n(43),om=n(4),cm=Mt(function(e,t){var n=t.prop;return function(e){return{configValue:e.getApplicationState("config")[n]}}},{shouldHandleStateChanges:Boolean("")})(function(e){return e.children(e.configValue)}),sm=n(7),um=n(65),dm=Object(om.V)("div",{target:"e3e0l5g0"})("border-radius:50%;background-color:#eb4736;color:#fff;width:1.5em;height:1.5em;line-height:1.5em;text-align:center;font-size:0.8em;box-shadow:0 0.2em 0.2em rgba(0,0,0,0.2);"),lm=Object(om.V)("div",{displayName:"Minimized",section:!0,target:"extks10"})("padding:",function(e){return"circle"===e.minimizedType?"0.5em 0.5em 1em 1em":"0.8em 0.8em 0 0.8em"},";position:absolute;bottom:0;z-index:2;will-change:tranform,opacity;backface-visibility:hidden;",function(e){return e.position},":0;"),pm=Object(om.V)("div",{displayName:"MinimizedBubble",section:!0,target:"extks11"})("background:#427fe1;display:flex;width:60px;height:60px;box-shadow:0 0.2em 0.8em rgba(0,0,0,0.2);border-radius:50%;justify-content:center;&:hover{cursor:pointer;}"),fm=Object(om.V)("div",{displayName:"MinimizedBar",section:!0,target:"extks12"})("width:255px;height:50px;box-shadow:0 0 1.2em rgba(0,0,0,0.3);background:#fff;border-radius:8px 8px 0 0;display:flex;padding:0 0.9em;align-items:center;&:hover{cursor:pointer;}"),mm=Object(om.V)("p",{target:"extks13"})("flex-grow:1;font-weight:700;font-size:0.9em;"),hm=Object(om.S)("padding:0;"),vm=Object(om.S)("max-width:255px;margin-bottom:10px;cursor:pointer;"),bm=Object(om.S)("width:10px;"),gm=Object(om.S)("background:rgba(255,255,255,0.5);border-radius:50%;width:1.7em;height:1.7em;display:flex;padding:0;justify-content:center;align-items:center;margin-bottom:0.4em;"),_m=Object(om.V)("div",{displayName:"Invitation",section:!0,target:"extks14"})("display:flex;flex-direction:column;align-items:",function(e){return e.alignToRight?"flex-end":"flex-start"},";&:hover{*{visibility:visible;}}",om.f,"{box-shadow:0 0.1em 1.2em rgba(0,0,0,0.3);}"),ym=Object(om.S)("position:absolute;right:0.5em;top:0;"),jm=function(e){var t=e.invitation,n=e.invitationHidden;return Boolean(t&&!n)},Om=function(e){function t(){return e.apply(this,arguments)||this}Object(Rt.a)(t,e);var n=t.prototype;return n.componentDidUpdate=function(e){jm(e)!==jm(this.props)&&this.props.onResize()},n.render=function(){var e=this.props,t=e.avatar,n=e.invitation,r=e.minimizedType,a=e.minimizedText,i=e.innerRef,o=e.hideInvitation,c=e.mobile,s=e.unseenCount,u=e.screenPosition,d=(e.onResize,e.onMaximize);return zt.createElement(lm,{innerRef:i,minimizedType:r,position:u},zt.createElement(om.m,null,jm(this.props)&&zt.createElement(_m,{alignToRight:"right"===u},zt.createElement(om.I,{reverse:"right"===u},zt.createElement(om.r,{className:gm,mobile:c,onClick:o},zt.createElement(om.l,{className:bm}))),zt.createElement(om.f,{className:vm,onClick:d},zt.createElement(om.y,null,n))),zt.createElement(om.I,{reverse:"right"===u},"circle"===r&&zt.createElement(pm,{hasAvatar:Boolean(t),onClick:d},s>0?zt.createElement(dm,{className:ym},s):null,zt.createElement(om.r,{className:hm},t?zt.createElement(om.e,{imgUrl:t,size:"60px"}):zt.createElement(om.i,null))),"bar"===r&&zt.createElement(fm,{onClick:d},s>0?zt.createElement(dm,{className:ym},s):null,zt.createElement(mm,{ellipsis:!0},a),zt.createElement(om.i,{noShrink:!0})))))},t}(zt.Component);Om.defaultProps={innerRef:f.N,onResize:f.N};var wm=Mt(function(e,t){var n=t.onResize,r=function(){Xn(e)};return function(e){var t=e.getApplicationState().mobile,a=Cn(e),i=t?70:200,o=Pn("liveChatChatId",e),c=o.invitationHidden,s=o.minimizedText,u=o.invitationText,d=o.unseenCount;return{avatar:o.avatar,invitation:u?Vn(i,u):null,minimizedType:a,minimizedText:s,hideInvitation:r,invitationHidden:c,mobile:t,onResize:n,unseenCount:d,screenPosition:En(e)}}})(Om),xm=function(){return!0},Cm=Mt(function(e,t){var n=t.name,r=t.condition,a=void 0===r?xm:r;return function(e){var t=_n(n,e),r=t.enabled,i=Object(l.a)(t,["enabled"]);return{shouldRender:r&&a(i)}}})(function(e){var t=e.shouldRender,n=e.children;return t?n:null}),Em=function(e){e.styles;var t=Object(l.a)(e,["styles"]);return zt.createElement("svg",Object(d.a)({height:"14",preserveAspectRatio:"xMidYMid",viewBox:"0 0 15 14",width:"15",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink"},t),zt.createElement("path",{d:"M13.542,9.934 C13.542,9.934 14.458,10.082 14.516,10.901 C14.516,10.901 14.514,12.040 13.003,12.009 C13.003,12.009 13.843,13.818 10.924,13.840 C10.924,13.840 9.078,13.921 6.479,13.318 C6.479,13.318 4.808,12.862 3.500,12.000 C3.500,12.000 3.500,5.500 3.500,5.500 C3.500,5.500 7.088,3.413 7.530,2.407 C7.530,2.407 7.948,1.233 7.925,0.599 C7.925,0.599 8.708,-0.640 9.612,0.433 C9.612,0.433 10.234,1.949 9.600,3.390 C9.600,3.390 9.040,4.364 8.909,4.818 C8.905,4.831 8.998,4.987 9.000,5.000 C9.000,5.000 13.000,5.000 13.000,5.000 C13.000,5.000 14.553,4.821 14.575,6.151 C14.575,6.151 14.814,7.244 13.432,7.450 C13.432,7.450 15.035,7.301 15.003,8.725 C15.003,8.725 15.084,9.860 13.542,9.934 ZM1.242,12.477 C0.582,12.477 0.000,12.160 0.000,11.500 C0.000,11.500 0.000,6.000 0.000,6.000 C0.000,5.340 0.582,4.966 1.242,4.966 C1.901,4.966 2.500,5.340 2.500,6.000 C2.500,6.000 2.500,11.500 2.500,11.500 C2.500,12.160 1.901,12.477 1.242,12.477 Z",id:"path-1"}))},Im=function(e){return zt.createElement(om.q,e,zt.createElement(Em,null))},Sm=function(e){e.styles;var t=Object(l.a)(e,["styles"]);return zt.createElement("svg",Object(d.a)({height:"14",preserveAspectRatio:"xMidYMid",viewBox:"0 0 15 14",width:"15",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink"},t),zt.createElement("path",{d:"M13.758,8.978 C13.099,8.978 12.500,8.600 12.500,7.932 C12.500,7.932 12.500,2.370 12.500,2.370 C12.500,1.703 13.099,1.383 13.758,1.383 C14.418,1.383 15.000,1.703 15.000,2.370 C15.000,2.370 15.000,7.932 15.000,7.932 C15.000,8.600 14.418,8.978 13.758,8.978 ZM7.470,11.566 C7.470,11.566 7.052,12.753 7.075,13.395 C7.075,13.395 6.293,14.648 5.388,13.562 C5.388,13.562 4.766,12.030 5.400,10.572 C5.400,10.572 5.960,9.587 6.091,9.127 C6.095,9.115 6.002,8.957 6.000,8.944 C6.000,8.944 2.000,8.944 2.000,8.944 C2.000,8.944 0.447,9.125 0.426,7.779 C0.426,7.779 0.186,6.674 1.568,6.466 C1.568,6.466 -0.035,6.616 -0.003,5.176 C-0.003,5.176 -0.084,4.028 1.458,3.954 C1.458,3.954 0.542,3.805 0.484,2.976 C0.484,2.976 0.486,1.824 1.997,1.856 C1.997,1.856 1.158,0.026 4.076,0.004 C4.076,0.004 5.922,-0.079 8.521,0.532 C8.521,0.531 10.192,0.993 11.500,1.865 C11.500,1.865 11.500,8.438 11.500,8.438 C11.500,8.438 7.912,10.548 7.470,11.566 Z",id:"path-1"}))},Tm=function(e){return zt.createElement(om.q,e,zt.createElement(Sm,null))},km=n(14),Pm=27,Am=Object(om.S)("width:auto;height:auto;background:transparent;transform:scale(0.8);padding:0.5em;"),Nm=Object(om.V)("div",{target:"e37ga8f0"})("position:absolute;top:1em;left:1em;right:1em;background:#fff;box-shadow:0 0.2em 0.8em rgba(0,0,0,0.2);padding:0.5em;border-radius:8px;max-width:290px;margin:0 auto;"),Vm=Object(om.V)("div",{target:"e37ga8f1"})("z-index:999;position:absolute;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.5);border-radius:8px;"),Mm=Object(om.V)("div",{target:"e37ga8f2"})("display:flex;flex-direction:row-reverse;"),zm=Object(om.V)("div",{target:"e37ga8f3"})("padding:1em;"),Rm=Object(om.S)("&-appear,&-enter{opacity:0;",Nm,"{transform:scale(0);}}&-enter-active,&-appear-active{opacity:1;transition:transform 200ms ease-in-out,opacity 100ms ease-in-out;",Nm,"{transform:scale(1);}}&-exit{opacity:1;",Nm,"{transform:scale(1);}}&-exit-active{opacity:0;transform:scale(0);transition:transform 100ms ease-in-out,opacity 200ms ease-in-out;}"),Dm=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return(t=e.call.apply(e,[this].concat(r))||this).handleKeyDown=function(e){e.keyCode===Pm&&t.props.onClose()},t.stopPropagation=function(e){return e.stopPropagation()},t}Object(Rt.a)(t,e);var n=t.prototype;return n.componentDidMount=function(){document.addEventListener("keydown",this.handleKeyDown)},n.componentWillUnmount=function(){document.removeEventListener("keydown",this.handleKeyDown)},n.render=function(){var e=this.props.onClose;return Ta.a.createPortal(zt.createElement(km.TransitionGroup,null,zt.createElement(km.CSSTransition,{appear:!0,classNames:Rm,timeout:200},zt.createElement(Vm,{onClick:e},zt.createElement(Nm,{onClick:this.stopPropagation},zt.createElement(Mm,null,zt.createElement(om.r,{className:Am,key:"close",onClick:e},zt.createElement(om.l,null))),zt.createElement(zm,null,this.props.children))))),document.getElementById("app-modal"))},t}(zt.Component);Dm.defaultProps={onClose:f.N};var qm=Dm,Lm=n(17),Fm=n(87),Um=Object(om.V)("form",{displayName:"Form",section:!0,target:"e1nyj5rz0"})("padding:",function(e){return e.noPadding?"0":"1em"},";"),Bm=Object(om.V)("span",{target:"e1z1197g0"})("color:red;font-size:0.8em;margin-bottom:0.3em;");Bm.defaultProps={role:"alert"};var Gm=Bm,Hm=Object(om.V)("label",{target:"epop7600"})("font-size:0.9em;display:inline-block;width:",function(e){return e.fullWidth?"100%":"auto"},";");Hm.defaultProps={textWrap:!0};var Wm=Hm,Ym=Object(om.V)("div",{target:"e1l4jsit0"})("margin-top:0.5em;"),Jm=Object(om.S)("padding:0 1.8em;height:2.7em;margin-right:5px;border-radius:3px;"),Qm=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return(t=e.call.apply(e,[this].concat(r))||this).handleRate=Object(f.J)(function(e){return function(n){n.preventDefault();var r=t.props.input.value===e;t.props.input.onChange(r?null:e)}}),t}return Object(Rt.a)(t,e),t.prototype.render=function(){var e=this.props,t=e.meta,n=e.input;return zt.createElement(Ym,null,zt.createElement("div",null,zt.createElement(om.r,{active:"good"===n.value,className:Jm,onClick:this.handleRate("good")},zt.createElement(Im,null)),zt.createElement(om.r,{active:"bad"===n.value,className:Jm,onClick:this.handleRate("bad")},zt.createElement(Tm,null))),t.error&&t.touched&&zt.createElement(Gm,null,t.error))},t}(zt.Component),Km=Object(om.V)("div",{target:"e14owvtw0"})("margin:0.6em 0;font-size:0.9em;"),Xm=Object(om.V)("select",{target:"e1nezr1s0"})("border:1px solid #dde2e6;padding:0.8em;height:3em;border-radius:4px;font-size:",function(e){return e.mobile?"16px":"0.9em"},";min-width:200px;background:#fff;width:",function(e){return e.fullWidth?"100%":"auto"},";");var Zm=function(e){var t=e.input,n=e.meta,r=Object(l.a)(e,["input","meta"]);return zt.createElement(zt.Fragment,null,zt.createElement(Xm,Object(d.a)({},t,r)),n.error&&n.touched&&zt.createElement(Gm,null,n.error))},$m=Object(om.V)("input",{target:"e9fz61b0"})("border:1px solid #dde2e6;padding:0.8em;border-radius:4px;box-shadow:none;-webkit-appearance:none;font-size:",function(e){return e.mobile?"16px":"0.9em"},";font-family:inherit;width:",function(e){return e.fullWidth?"100%":"auto"},";&:focus,&:active{outline:none;border-color:#427fe1;}");var eh=function(e){var t=e.input,n=e.meta,r=Object(l.a)(e,["input","meta"]);return zt.createElement(zt.Fragment,null,zt.createElement($m,Object(d.a)({},t,r)),n.error&&n.touched&&zt.createElement(Gm,null,n.error))},th=Object(om.V)("textarea",{target:"e11sn8bc0"})("border:1px solid #dde2e6;padding:0.8em;border-radius:4px;resize:none;box-shadow:none;-webkit-appearance:none;font-size:",function(e){return e.mobile?"16px":"0.9em"},";font-family:inherit;width:",function(e){return e.fullWidth?"100%":"auto"},";&:focus,&:active{outline:none;border-color:#427fe1;}");var nh=function(e){var t=e.input,n=e.meta,r=Object(l.a)(e,["input","meta"]);return zt.createElement(zt.Fragment,null,zt.createElement(th,Object(d.a)({},t,r)),n.error&&n.touched&&zt.createElement(Gm,null,n.error))},rh=Object(om.S)("&-enter{opacity:0;transform:scale(0);}&-enter&-enter-active{opacity:1;transform:scale(1);transition:transform 200ms ease-in-out,opacity 100ms ease-in-out 100ms;}&-exit{opacity:1;transform:scale(1);}&-exit&-exit-active{opacity:0;transform:scale(0);transition:transform 100ms ease-in-out 100ms,opacity 200ms ease-in-out;}"),ah=function(e){var t=e.on,n=void 0!==t&&t,r=e.children,a=Object(l.a)(e,["on","children"]);return n?zt.createElement(km.CSSTransition,Object(d.a)({classNames:rh,timeout:200},a),r):null},ih=function(e){var t=e.on,n=void 0!==t&&t,r=e.children,a=Object(l.a)(e,["on","children"]);return n?null:zt.createElement(km.CSSTransition,Object(d.a)({classNames:rh,timeout:200},a),r)},oh=function(e){var t=e.on,n=e.children,r=Object(l.a)(e,["on","children"]);return zt.createElement("span",r,zt.createElement(km.TransitionGroup,null,zt.Children.map(n,function(e,n){return zt.cloneElement(e,{on:t,key:n})})))},ch=Object(om.S)("position:absolute;top:0;left:0;"),sh=Object(om.V)("span",{target:"esigbm30"})("position:relative;"),uh=Object(om.V)("input",{target:"esigbm31"})("opacity:0;margin-right:0.5em;");var dh=function(e){var t=e.input,n=e.type;return zt.createElement(sh,null,zt.createElement(uh,Object(d.a)({type:n},t)),zt.createElement(oh,{className:ch,on:t.checked},zt.createElement(ah,null,"checkbox"===n?zt.createElement(om.k,{color:"#4384F5"}):zt.createElement(om.F,{color:"#4384F5"})),zt.createElement(ih,null,"checkbox"===n?zt.createElement(om.j,null):zt.createElement(om.E,null))))},lh=Object(om.V)("button",{displayType:"Button",target:"e1m6ha5c0"})("background-color:#427fe1;color:#fff;border-radius:0.3em;font-size:inherit;font-weight:bold;border:0;padding:1em 1em;font-family:inherit;width:100%;max-width:320px;",function(e){var t=e.disabled;return"\n\t\topacity: "+(t?"0.5":"1")+";\n\t\ttext-transform: "+(e.capitalize?"capitalize":"none")+";\n\t\t\n\n\t\t&:hover {\n\t\t\tcursor: "+(t?"default":"pointer")+";\n\t\t}\n\t"},";"),ph=Object(om.V)("div",{target:"e1svmys80"})("display:flex;justify-content:center;font-size:0.9em;padding:",function(e){return e.noPadding?"0":"0.6em 0em"},";");var fh=function(e){var t=e.stickySubmit,n=e.submitLabel,r=e.submitting,a=void 0!==r&&r,i=e.noPadding,o=void 0!==i&&i,c=n+(a?"...":"");return zt.createElement(ph,{noPadding:o,sticky:t},zt.createElement(lh,{disabled:a,type:"submit"},c))},mh=Object(om.V)("p",{target:"evd1llx0"})("font-size:0.8em;text-align:center;");var hh=function(e){var t=e.error;return zt.createElement(mh,null,t)},vh={},bh={values:!0},gh={errors:!0,touched:!0},_h=Object(Fm.a)(),yh={format:function(e){return void 0===e&&(e=""),Object(f.jb)(e)},formatOnBlur:!0},jh=function(e){return Object(f.A)(e)?!Object(f.B)(e):Boolean(e)},Oh=function(e){function t(){return e.apply(this,arguments)||this}Object(Rt.a)(t,e);var n=t.prototype;return n.componentWillUnmount=function(){var e=this.props,t=e.form,n=e.name,r=t.getFieldState(n);r&&r.value&&t.change(n,void 0)},n.render=function(){return this.props.children},t}(zt.Component);var wh=function(e){var t=e.when,n=e.children;return t?zt.createElement(Lm.c,{subscription:bh},function(n){var r=n.form;return n.values[t]?zt.createElement(Oh,Object(d.a)({},e,{form:r})):null}):zt.createElement(zt.Fragment,null,n)},xh=n(52),Ch=n.n(xh),Eh=function(e){return e.stopPropagation()},Ih=Object(om.V)("a",{target:"e153l5x70"})("color:inherit;"),Sh=function(e){return zt.createElement(Ih,Object(d.a)({},e,{onClick:Eh,rel:"nofollow noopener",target:"_blank",textWrap:!0}))},Th=Object(om.V)("span",{target:"eezc8ma0"})("color:#f00;");var kh=function(e){var t=e.text,n=e.children,r=e.htmlFor,a=e.showRequiredMark,i=void 0!==a&&a,o=t?{"aria-label":t.replace(/(:\s*)$/,"")}:{};return zt.createElement(zt.Fragment,null,t&&zt.createElement(Wm,Object(d.a)({},o,{fullWidth:!0,htmlFor:r}),zt.createElement(Ch.a,{component:Sh},t),i&&zt.createElement(Th,null," *")),n)};var Ph=function(e){var t=e.name,n=e.label,r=e.required,a=e.mobile;return zt.createElement(kh,{showRequiredMark:r,text:n,htmlFor:t},zt.createElement(Lm.a,Object(d.a)({},yh,{id:t,autoComplete:t,component:eh,fullWidth:!0,mobile:a,name:t})))};var Ah=function(e){var t=e.label,n=e.name,r=e.required,a=e.mobile;return zt.createElement(kh,{showRequiredMark:r,text:t,htmlFor:n},zt.createElement(Lm.a,Object(d.a)({},yh,{component:nh,fullWidth:!0,mobile:a,name:n,id:n})))};var Nh=function(e){var t=e.label,n=e.name,r=e.mobile,a=void 0!==r&&r,i=e.required,o=void 0!==i&&i;return zt.createElement(kh,{showRequiredMark:o,text:t,htmlFor:n},zt.createElement(Lm.a,Object(d.a)({},yh,{autoComplete:"email",id:n,name:n,type:"email",component:eh,mobile:a,fullWidth:!0})))};var Vh=function(e){var t=e.name,n=e.label,r=e.type,a=e.value;return zt.createElement(Wm,{fullWidth:!0},zt.createElement(Lm.a,{component:dh,name:t,type:r,value:a}),zt.createElement("span",null,n))};var Mh=function(e){var t=e.options,n=e.label,r=e.name,a=e.type,i=e.required;return zt.createElement(kh,{showRequiredMark:i,text:n},t.map(function(e,t){return zt.createElement(Vh,{key:t,label:e.label,name:r,type:a,value:e.value})}),zt.createElement(Lm.c,{subscription:gh},function(e){var t=e.errors,n=e.touched;return t[r]&&n&&n[r]?zt.createElement(Gm,null,t[r]):null}))},zh=Object(om.V)("option",{target:"e1cmvytt0"})("color:",function(e){return e.primary?"#090":"inherit"},";");var Rh=function(e){var t=e.meta,n=e.name,r=e.label,a=e.value,i=e.localize,o=void 0!==t&&void 0!==t.online,c=Boolean(t&&t.online),s=" ("+i(c?"skill_status_online":"skill_status_offline")+")";return zt.createElement(zh,{name:n,primary:o&&c,value:a},""+r+(o?s:""))};var Dh=function(e){var t=e.options,n=e.label,r=e.name,a=e.mobile,i=e.localize,o=e.required,c=e.meta;return zt.createElement(kh,{showRequiredMark:o,text:n,htmlFor:r},zt.createElement(Lm.a,{id:r,name:r,mobile:a,fullWidth:!0,component:Zm},zt.createElement("option",{value:""},i("forms_choose")),t.map(function(e,t){return zt.createElement(Rh,{key:t,meta:c,label:e.label,localize:i,name:r,value:e.value})})))};var qh=function(e){var t=e.label,n=e.name,r=e.required,a=void 0!==r&&r;return zt.createElement(kh,{showRequiredMark:a,text:t,htmlFor:n},zt.createElement(Lm.a,{id:n,component:Qm,name:n}))},Lh=Object(om.V)("p",{displayName:"InformationField",target:"e1glbrkl0"})("text-align:center;a{color:inherit;}");var Fh={information:function(e){var t=e.value;return zt.createElement(Lh,{textWrap:!0},zt.createElement(Ch.a,{component:Sh},t))},text:Ph,textarea:Ah,email:Nh,rating:qh,radio:Mh,checkbox:Mh,select:Dh};var Uh=function(e){var t=e.type;return Fh[t]},Bh=function(e){function t(t){var n;if((n=e.call(this,t)||this).id="form_"+n.props.id,n.handleClick=function(e){e.stopPropagation()},n.handleSubmit=function(e){var t=n.props;return(0,t.onSubmit)(t.id,e)},n.validate=function(e){var t=n.props,r=t.fields,a=t.localize;return r.reduce(function(t,n){var r,i=n.required,o=n.name;return i&&!jh(e[o])?Object(d.a)({},t,((r={})[o]=a("survey_fill_in_required_fields"),r)):t},{})},!Object(f.A)(t.fields))throw new Error("form_error - for props: "+JSON.stringify(t));return n.state={initialValues:t.fields.filter(function(e){return"defaultValue"in e}).reduce(function(e,t){var n,r=t.name,a=t.defaultValue;return Object(d.a)({},e,((n={})[r]=a,n))},{})},n}Object(Rt.a)(t,e);var n=t.prototype;return n.componentDidMount=function(){this.props.mobile||this.focusFormInput()},n.focusFormInput=function(){var e=Object(Fm.b)(this.id)();if(e.length){var t=e[0];"INPUT"===t.tagName&&"checkbox"!==t.type&&"radio"!==t.type&&t.focus({preventScroll:!0})}},n.render=function(){var e=this,t=this.state.initialValues,n=this.props,r=n.id,a=n.fields,i=n.submitLabel,o=n.mobile,c=n.localize,s=n.stickySubmit,u=void 0!==s&&s,l=n.noPadding,p=void 0!==l&&l,f=n.hideSubmit,m=void 0!==f&&f;return zt.createElement(Lm.b,{decorators:[_h],initialValues:t,onSubmit:this.handleSubmit,subscription:vh,validate:this.validate},function(t){var n=t.handleSubmit,s=t.submitting,l=t.submitError;return zt.createElement(Um,{name:r,noPadding:p,onClick:e.handleClick,onSubmit:n},a.map(function(e,t){var n=Uh(e);return zt.createElement(Km,{key:t},zt.createElement(wh,{name:e.name,when:e.dependOn},zt.createElement(n,Object(d.a)({},e,{localize:c,mobile:o}))))}),l&&zt.createElement(hh,{error:l}),!m&&zt.createElement(fh,{noPadding:p,stickySubmit:u,submitLabel:i,submitting:s}))})},t}(zt.Component),Gh=Object(om.V)("div",{target:"e1mnxbjv0"})("display:flex;justify-content:center;"),Hh=Object(om.V)("div",{target:"e1mnxbjv1"})("background-color:#dde2e6;border-radius:50%;display:flex;justify-content:center;align-items:center;",function(e){return{width:e.size,height:e.size}},";"),Wh=function(e){var t=e.size,n=void 0===t?"50px":t,r=e.children;return zt.createElement(Gh,null,zt.createElement(Hh,{size:n},r))},Yh=Object(om.V)("div",{displayName:"Tooltip",target:"e22lpga0"})("display:inline-block;background-color:#424d57;color:#fff;padding:1em;position:fixed;border-radius:8px;z-index:9;font-size:0.8em;white-space:nowrap;font-weight:normal;margin-top:0.5em;border-bottom:1px solid #000;",function(e){return{left:e.position.left?e.position.left-10+"px":"auto",right:e.position.right?e.position.right-10+"px":"auto",top:e.position.top+"px"||"auto"}},";"),Jh=Object(om.V)("svg",{displayName:"TooltipArrow",target:"e22lpga1"})("position:fixed;fill:#424d57;margin-top:-1.5em;",function(e){return{left:e.position.left?e.position.left-10+3+e.arrowHorizontalFactor+"px":"auto",right:e.position.right?e.position.right-10+3+e.arrowHorizontalFactor+"px":"auto",top:"auto"}},";"),Qh=Object(om.S)("display:flex;align-items:stretch;"),Kh=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return(t=e.call.apply(e,[this].concat(r))||this).state={hover:!1,hoverTooltip:!1,disabled:!1},t.disable=function(){t.setState({disabled:!0})},t.setHoverTooltip=function(){t.setState({hoverTooltip:!0})},t.unsetHoverTooltip=function(){t.setState({hoverTooltip:!1})},t.setSourceRef=function(e){t.sourceRef=e},t.setHover=function(){if(!t.state.disabled&&!t.props.disabled){var e=t.sourceRef.getBoundingClientRect(),n={top:e.bottom+window.pageYOffset};e.left+window.pageXOffset>window.innerWidth/2?n.right=window.innerWidth-(e.right+window.pageXOffset):n.left=e.left+window.pageXOffset,t.setState({hover:!0,position:n,targetWidth:t.sourceRef.offsetWidth})}},t.unsetHover=function(){t.setState({hover:!1})},t}return Object(Rt.a)(t,e),t.prototype.render=function(){var e=this.props,t=e.children,n=e.label,r=Object(l.a)(e,["children","label"]);return zt.createElement(zt.Fragment,null,zt.createElement("div",Object(d.a)({className:Qh,onMouseEnter:this.setHover,onMouseLeave:this.unsetHover,onTouchStart:this.disable,ref:this.setSourceRef},r),t),(this.state.hover||this.state.hoverTooltip)&&zt.createElement(Yh,{onMouseEnter:this.setHoverTooltip,onMouseLeave:this.unsetHoverTooltip,position:this.state.position},zt.createElement(Jh,{arrowHorizontalFactor:this.state.targetWidth/2,height:"10",position:this.state.position,width:"16"},zt.createElement("polygon",{points:"0,10 16,10 8,0"})),n))},t}(zt.Component),Xh=Object(om.V)("p",{target:"euc9iun0"})("text-align:center;"),Zh=Object(om.S)("margin-left:5px;"),$h=Object(om.S)("& svg{flex-grow:1;}"),ev=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return(t=e.call.apply(e,[this].concat(r))||this).state={opened:!1,rate:t.props.chatRate},t.handleRate=Object(f.J)(function(e){return function(){var n=t.state.rate===e,r=n?null:e;t.rateChat(r),t.setState({rate:r,opened:!n})}}),t.showModal=function(){t.setState({opened:!0})},t.closeModal=function(){t.setState({opened:!1})},t.handleSubmit=function(e,n){t.props.rateChat({comment:n.comment}),t.closeModal()},t}Object(Rt.a)(t,e);var n=t.prototype;return n.componentDidUpdate=function(e){e.chatRate!==this.props.chatRate&&this.setState({rate:this.props.chatRate})},n.rateChat=function(e){var t=this;this.props.rateChat({rate:e}).catch(function(){return t.setState({rate:t.props.chatRate})})},n.render=function(){var e=this,t=this.props,n=t.disabled,r=t.chatRate,a=t.iconTheme;return zt.createElement(Ut,null,function(t){return zt.createElement(zt.Fragment,null,zt.createElement(Kh,{className:Zh,disabled:n,label:t("good"===r?"rate_me_cancel_tooltip":"rate_me_good_tooltip")},zt.createElement(om.r,{active:"good"===r,className:$h,disabled:n,onClick:e.handleRate("good")},"modern"===a?zt.createElement(Im,null):zt.createElement(om.H,null))),zt.createElement(Kh,{className:Zh,disabled:n,label:t("bad"===r?"rate_me_cancel_tooltip":"rate_me_bad_tooltip")},zt.createElement(om.r,{active:"bad"===r,className:$h,disabled:n,onClick:e.handleRate("bad")},"modern"===a?zt.createElement(Tm,null):zt.createElement(om.G,null))),e.state.opened&&zt.createElement(qm,{onClose:e.closeModal},zt.createElement(Wh,null,"good"===e.state.rate?zt.createElement(om.H,null):zt.createElement(om.G,null)),zt.createElement(Xh,null,t("rate_me_add_comment")),zt.createElement(Bh,{fields:[{name:"comment",type:"textarea",required:!0}],id:"rate_comment",localize:t,mobile:e.props.mobile,noPadding:!0,onSubmit:e.handleSubmit,submitLabel:t("button_add_feedback")})))})},t}(zt.Component),tv=Mt(function(e,t){var n=t.chatId,r=function(t){var r=t.rate,a=t.comment,i={};return void 0!==r&&(i.rate=r),void 0!==a&&(i.rateComment=a),e.requestUpdateChat(n,{properties:i})};return function(e){var t=e.getChat(n),a=t.active;return{chatRate:t.properties.rate,disabled:!a,iconTheme:e.getApplicationState("config").theme.iconTheme,mobile:e.getApplicationState("mobile"),rateChat:r}}})(ev),nv=Object(om.S)("box-shadow:0 0.1em 0.6em rgba(0,0,0,0.05);position:relative;"),rv=Object(om.V)("div",{target:"e4pr89p0"})("display:flex;align-items:center;position:relative;margin-right:0.5em;"),av=Object(om.S)("flex:1;justify-content:center;"),iv=Object(om.V)("div",{target:"e4pr89p1"})("width:12px;height:12px;background:#70d526;border:2px solid #fff;position:absolute;border-radius:50%;right:0;top:0;"),ov=Object(om.S)("margin-right:0;"),cv=Object(om.S)("justify-content:center;"),sv=Object(om.S)(cv," min-width:auto;"),uv=Object(om.V)("img",{target:"e4pr89p2"})("height:auto;max-height:50px;"),dv=Object(f.J)(function(e){return function(t){return t.position===e}}),lv=function(e){function t(){return e.apply(this,arguments)||this}return Object(Rt.a)(t,e),t.prototype.render=function(){var e=this.props,t=e.agent,n=e.chatId,r=e.showAvatar,a=e.logoPath,i=e.showLogo;return zt.createElement(om.a,{className:nv,noShrink:!0},t&&zt.createElement(om.I,{flexFill:!0},r&&t.avatar&&zt.createElement(rv,null,zt.createElement(om.e,{className:ov,imgUrl:t.avatar}),zt.createElement(iv,null)),zt.createElement(om.I,{flexFill:!0},zt.createElement(om.m,{className:av,flexFill:!0},zt.createElement(om.P,{ellipsis:!0},t.name),t.properties.jobTitle&&zt.createElement(om.L,{ellipsis:!0},t.properties.jobTitle),zt.createElement(Cm,{condition:dv("bottom"),name:"rating"},zt.createElement(om.I,null,zt.createElement(tv,{chatId:n})))),zt.createElement(Cm,{condition:dv("right"),name:"rating"},zt.createElement(om.m,{className:cv,noShrink:!0},zt.createElement(om.I,null,zt.createElement(tv,{chatId:n})))),i&&zt.createElement(om.m,{className:sv},zt.createElement(uv,{alt:"",src:a})))))},t}(zt.Component),pv=Mt(function(e,t){var n=t.chatId;return function(e){var t;return{agent:gn(n,e),chatActive:e.getChat(n).active,showAvatar:_n("agentAvatar",e).enabled,logoPath:(t=_n("logo",e).path,"https://"+O(t)),showLogo:_n("logo",e).enabled&&"modern"===e.getApplicationState("config").theme.name}}})(lv),fv=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return(t=e.call.apply(e,[this].concat(r))||this).state={disabled:!1},t.handleButtonClick=function(e,n){t.disableButtons();var r=t.props,a=r.card.buttons[n],i=r.eventId;(0,r.onActionButtonClick)({button:a,event:i})},t}Object(Rt.a)(t,e);var n=t.prototype;return n.disableButtons=function(){var e=this;this.setState({disabled:!0}),this._timeoutId=setTimeout(function(){e.setState({disabled:!1})},1e3)},n.componentWillUnmount=function(){clearTimeout(this._timeoutId)},n.render=function(){return zt.createElement(om.g,{card:(e=this.props.card,t=this.state.disabled,e.buttons?Object(d.a)({},e,{buttons:e.buttons.map(function(e){var n=e.type,r=e.value,a=Object(l.a)(e,["type","value"]);return a.disabled=t,"url"===n?(a.href=r,a.target="_blank",a):"phone"===n?(a.href="tel:"+r,a):a})}):e),onButtonClick:this.handleButtonClick});var e,t},t}(zt.Component),mv=Mt(function(e){return{mobile:e.getApplicationState("mobile")}},{shouldHandleStateChanges:Boolean("")})(function(e){var t=e.carousel,n=t.id,r=t.properties.cards,a=e.mobile,i=Object(l.a)(e,["carousel","mobile"]);return zt.createElement(om.h,{mobile:a},r.map(function(e,t){var r=e.elements;return zt.createElement(fv,Object(d.a)({card:r,eventId:n,key:t},i))}))}),hv=function(e){var t=e.richMessage,n=t.id,r=t.properties.card.elements,a=Object(l.a)(e,["richMessage"]);return zt.createElement(fv,Object(d.a)({card:r,eventId:n},a))},vv=function(e){return e.stopPropagation()},bv=function(e){return zt.createElement("a",Object(d.a)({},e,{onClick:vv,rel:"nofollow noopener",target:"_blank"}))},gv=function(e){var t=e.text,n=e.url;return zt.createElement(om.y,null,n?zt.createElement(bv,{href:n},t):zt.createElement(Ch.a,{component:bv},t))},_v=function(e){var t=e.message,n=e.radiusType;return zt.createElement(om.f,{radiusType:n},zt.createElement(gv,{text:t.properties.text,url:t.properties.url}))},yv=function(e){return e.stopPropagation()},jv=function(e){return zt.createElement("a",Object(d.a)({},e,{onClick:yv,rel:"nofollow noopener",target:"_blank"}))},Ov=Object(om.S)("width:100%;max-height:150px;object-fit:cover;"),wv=Object(om.V)("div",{target:"ew1pqaq0"})("width:100%;height:150px;margin:0 auto;"),xv=function(e){var t=e.url,n=e.srcset,r=Object(l.a)(e,["url","srcset"]);return zt.createElement(om.x,r,zt.createElement(wv,null,zt.createElement("img",Object(d.a)({alt:"",className:Ov},function(e,t){var n={src:e};return void 0!==t&&(n.srcSet=t),n}(t,n)))))},Cv=function(e){var t=e.link,n=Object(l.a)(e,["link"]);return t?zt.createElement(jv,{href:t,style:n.style},xv(n)):xv(n)},Ev=function(e){function t(){return e.apply(this,arguments)||this}Object(Rt.a)(t,e);var n=t.prototype;return n.componentDidUpdate=function(){this.scrollToBottom&&this._messageListContext.scrollToBottom()},n.getSnapshotBeforeUpdate=function(e){this.scrollToBottom=!this.shouldRenderPreview(e)&&this.shouldRenderPreview()&&this._messageListContext.isScrollOnBottom()},n.shouldRenderPreview=function(e){return void 0===e&&(e=this.props),Boolean(e.urlPreview.properties.title)},n.render=function(){var e=this;return zt.createElement(om.w,null,function(t){e._messageListContext=t;var n=e.props,r=n.urlPreview.properties,a=n.radiusType;return e.shouldRenderPreview()?zt.createElement(om.f,{radiusType:a},zt.createElement(Cv,r.image),zt.createElement(om.z,{subtitle:r.description,title:r.title})):zt.createElement(om.f,{radiusType:a},zt.createElement(gv,{text:r.text}))})},t}(zt.Component),Iv=Object(om.V)("div",{target:"e19v7r50"})("max-width:300px;max-height:300px;"),Sv=Object(om.V)("img",{target:"e19v7r51"})("display:block;width:auto;height:auto;max-width:100%;max-height:100%;"),Tv=function(e){var t=e.url,n=e.name;return zt.createElement(Iv,null,zt.createElement(Sv,{alt:n,src:t}))},kv=function(e){var t=e.children;return zt.createElement(om.t,{date:"",showMetaOnClick:!1,system:!0},zt.createElement(om.f,null,zt.createElement(gv,{text:t})))},Pv=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return(t=e.call.apply(e,[this].concat(r))||this).state={shouldHandleSeen:!t.props.event.own&&!t.props.event.seen},t.handleSeen=function(){t.setState({shouldHandleSeen:!1}),t.props.listItemHandlers.markAsSeen(t.props.id)},t}return Object(Rt.a)(t,e),t.getDerivedStateFromProps=function(e,t){return t.shouldHandleSeen&&e.event.seen?{shouldHandleSeen:!1}:null},t.prototype.render=function(){var e,t=this.props,n=t.author,r=t.deliveryStatus,a=t.event,i=t.listItemHandlers,o=t.radiusType,c=t.showMetaOnClick,s=this.state.shouldHandleSeen;if("system_message"===a.type){var u=a.properties,d=u.systemMessageType,l=u.textVariables;return zt.createElement(Ut,null,function(e){return zt.createElement(kv,null,e(d,l))})}return zt.createElement(om.t,{authorName:n.name,date:(e=a.timestamp,new Date(e).toTimeString().substr(0,5)),deliveryStatus:r,failed:a.failed,isOwn:a.own,onSeen:this.handleSeen,seen:!s,sending:!a.delivered&&!a.failed,showMetaOnClick:c},"carousel"===a.type&&zt.createElement(mv,{carousel:a,onActionButtonClick:i.handleActionButtonClick}),"message"===a.type&&zt.createElement(_v,{message:a,radiusType:o}),"rich_message"===a.type&&zt.createElement(hv,{onActionButtonClick:i.handleActionButtonClick,radiusType:o,richMessage:a}),"sticker"===a.type&&zt.createElement(Tv,a.properties.sticker),"url_preview"===a.type&&zt.createElement(Ev,{radiusType:o,urlPreview:a}))},t}(zt.Component),Av=Mt(function(e,t){var n=t.chatId,r=t.id;return function(e,t){var n;return function(r){var a=e(r);if(void 0===a)return n;var i=t(r,a);return n=i,i}}(function(e){return e.getEvent(n,r)},function(e,t){return{deliveryStatus:wn(e,n,r),event:t,author:e.getUser(t.author)}})})(Pv),Nv=Object(om.V)("div",{target:"emklgwg0"})("background:#fff;box-shadow:0 4px 12px rgba(0,0,0,0.2);padding:1em;margin:1em;font-size:0.9em;border-radius:6px;"),Vv=Object(om.V)("div",{target:"emklgwg1"})("position:relative;background-color:#dde2e6;width:100%;height:5px;border-radius:3px;margin-top:0.4em;"),Mv=Object(om.V)("div",{target:"emklgwg2"})("position:absolute;background-color:#3e7ce4;width:",function(e){return e.progress},"%;height:5px;border-radius:3px;transition:width 150ms ease;"),zv=Object(om.V)("span",{target:"emklgwg3"})("color:",function(e){return e.failed?"red":"inherit"},";"),Rv=Object(om.V)("span",{target:"emklgwg4"})("color:red;font-size:0.8em;"),Dv=function(e){function t(){return e.apply(this,arguments)||this}return Object(Rt.a)(t,e),t.prototype.render=function(){var e=this.props,t=e.event,n=e.name,r=e.progress,a=e.failed,i=e.cancelUpload,o=e.failReason;return null===t?null:zt.createElement(Ut,null,function(e){return zt.createElement(Nv,null,zt.createElement(om.m,null,zt.createElement(om.I,null,zt.createElement(zv,{ellipsis:!0,failed:a,flexFill:!0},n),a&&zt.createElement(om.r,{flexFit:!0,onClick:i},zt.createElement(om.l,null))),zt.createElement(Vv,null,zt.createElement(Mv,{progress:Math.floor(100*r)})),o&&zt.createElement(Rv,null,o)))})},t}(zt.Component),qv=Mt(function(e,t){var n=t.chatId,r=t.eventId,a=function(){e.updateEvent(n,r,{properties:{canceled:!0}})};return function(e){var t=e.getEvent(n,r);if(void 0===t)return{event:null};var i=t.properties;return{name:i.name,progress:i.progress,failed:i.failed,failReason:i.failReason,cancelUpload:a}}})(Dv),Lv=Object(om.S)("font-family:inherit;"),Fv=Object(om.V)("input",{target:"e10ozmh70"})("display:none;"),Uv=Object(om.V)("label",{target:"e10ozmh71"})("cursor:pointer;display:flex;align-items:center;margin-right:0.5em;"),Bv=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return(t=e.call.apply(e,[this].concat(r))||this).handleInputChange=Object(f.ib)(1500,t.props.setMessageDraft),t.handleFileChange=function(e){[].forEach.call(e.target.files,function(e){t.props.sendFile(e)})},t.handleMessageSend=function(e){t.props.sendMessage(e),t.props.onSendMessage(e)},t}return Object(Rt.a)(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.allowFileUpload,r=t.mobile,a=t.onFocus,i=t.onBlur,o=(t.onSendMessage,t.queued),c=t.reconnecting,s=(t.sendFile,t.sendMessage,t.setMessageDraft,Object(l.a)(t,["allowFileUpload","mobile","onFocus","onBlur","onSendMessage","queued","reconnecting","sendFile","sendMessage","setMessageDraft"])),u=!c&&!o;return zt.createElement(Ut,null,function(t){return zt.createElement(om.M,Object(d.a)({},s,{active:u,disabled:c,mobile:r,onSend:e.handleMessageSend,onValueChange:e.handleInputChange}),zt.createElement(om.I,{align:"center"},zt.createElement(om.N,{autoFocus:!r,className:Lv,disabled:c,flexFill:!0,minRows:2,onBlur:i,onFocus:a,placeholder:t("embedded_textarea_placeholder")}),n&&u&&zt.createElement(Uv,{flexFit:!0},zt.createElement(om.d,null),zt.createElement(Fv,{multiple:!0,onChange:e.handleFileChange,type:"file",value:""})),zt.createElement(om.K,{flexFit:!0})))})},t}(zt.PureComponent),Gv=Mt(function(e,t){var n=t.chatId,r=function(t){return e.sendEvent(n,{type:"file",properties:{name:t.name}},{file:t})},a=function(t){tr(e,n,t)},i=function(t){e.requestUpdateChat(n,{properties:{messageDraft:t}})};return function(e){var t=e.getChat(n),o=t.active,c=t.properties.queued,s=Tn(e);return{allowFileUpload:o&&!s&&_n("fileSharing",e).enabled,mobile:e.getApplicationState("mobile"),queued:c,reconnecting:s,sendFile:r,sendMessage:a,setMessageDraft:i}}})(Bv),Hv=function(e){return e.stopPropagation()},Wv=function(e,t,n){return function(r){e({button:n[r],event:t})}},Yv=function(e){var t=e.eventId,n=e.replies,r=e.onSelect;return zt.createElement(om.C,{onSelect:Wv(r,t,n)},n.map(function(e,t){var n=e.text;return zt.createElement(om.D,{key:t,onClick:Hv,value:t},n)}))},Jv=Object(om.V)("div",{target:"e1b9v3lg0"})("position:absolute;top:0;left:0;right:0;background:#f5a623;z-index:10;color:#fff;text-align:center;font-size:0.9em;line-height:2.8em;"),Qv=Object(om.V)("div",{target:"e1b9v3lg1"})("padding:1em;text-align:center;font-size:0.9em;"),Kv=Object(om.V)("div",{target:"e1b9v3lg2"})("position:absolute;bottom:0;left:0;right:0;z-index:4;"),Xv="cubic-bezier(0.000, 0.980, 0.405, 1.000)",Zv=Object(om.S)("&-enter,&-appear{opacity:0;transform:translateY(100%);}&-enter&-enter-active,&-appear&-appear-active{opacity:1;transform:translateY(0%);transition:opacity 200ms ",Xv," 100ms,transform 300ms ",Xv,";}&-exit{opacity:1;transform:translateY(0%);}&-exit&-exit-active{opacity:0;transform:translateY(100%);transition:opacity 300ms ",Xv,",transform 200ms ",Xv," 100ms;}"),$v=Object(om.V)("div",{target:"e1b9v3lg3"})("flex-grow:1;height:100%;position:relative;min-height:0;-webkit-overflow-scrolling:touch;"),eb=Object(om.V)("div",{displayName:"Divider",target:"e1b9v3lg4"})("border-top:1px solid rgba(0,0,0,0.05);margin:0 1em;margin-bottom:-1px;z-index:10;"),tb=Object(om.S)("z-index:1;"),nb=Object(om.V)("div",{displayName:"TypingIndicator",target:"e1b9v3lg5"})("text-align:center;font-size:0.8em;position:absolute;bottom:0;right:0;left:0;"),rb=Object(om.S)("background:transparent;"),ab=function(e){var t=e.chatId,n=e.events,r=e.listItemHandlers,a=e.radiusType,i=n.map(function(e,n){var i=zt.createElement(Av,{chatId:t,id:e.id,key:e.id,listItemHandlers:r,radiusType:a,showMetaOnClick:0!==n});return zt.createElement(km.CSSTransition,{appear:!0,classNames:Zv,key:e.id,timeout:300},i)});return zt.createElement(km.TransitionGroup,null,i)},ib=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return(t=e.call.apply(e,[this].concat(r))||this).listItemHandlers={handleActionButtonClick:function(e){var n=e.button,r=e.event;if("message"===n.type)return t.props.sendMessage(n.text,{type:"action_button",event:r,button:n}),void t.handleSendMessage();t.props.sendPostback(r,n.postback)},markAsSeen:t.props.markAsSeen},t.handleSendMessage=function(){t.listRef.scrollToBottom()},t.getListRef=function(e){t.listRef=e},t.handleMobileWindowResize=function(){t.listRef.scrollToBottom()},t.handleInputFocus=function(){t.props.mobile&&(t.listRef.scrollToBottom(),window.addEventListener("resize",t.handleMobileWindowResize))},t.handleInputBlur=function(){t.props.mobile&&window.removeEventListener("resize",t.handleMobileWindowResize)},t}Object(Rt.a)(t,e);var n=t.prototype;return n.componentWillUnmount=function(){window.removeEventListener("resize",this.handleMobileWindowResize)},n.render=function(){var e=this,t=this.props,n=t.activeQuickReply,r=t.id,a=t.timeline,i=t.agent,o=t.ended,c=t.showAvatar,s=t.focused,u=t.queued,d=t.reconnecting,l=t.requestPrechat,p=t.showPrechat,f=t.uploading,m=t.uploadingFiles,h=t.showStartAgain,v=t.startChatAgain,b=t.localize,g=t.typingText;return zt.createElement(zt.Fragment,null,i&&zt.createElement(om.m,{className:tb,flexFill:!0,noShrink:!0},zt.createElement(eb,null),zt.createElement(pv,{chatId:r})),zt.createElement($v,null,d&&zt.createElement(Jv,null,"Reconnecting\u2026"),zt.createElement(km.TransitionGroup,null,f?zt.createElement(km.CSSTransition,{appear:!0,classNames:Zv,timeout:300},zt.createElement(Kv,null,m.map(function(e){return zt.createElement(qv,{chatId:r,eventId:e,key:e})}))):null),zt.createElement(om.v,{active:s,className:rb,ref:this.getListRef},a.map(function(t,n){return zt.createElement(om.u,{avatar:c&&"carousel"!==t.type&&t.authorData.avatar?t.authorData.avatar:void 0,isOwn:t.own,key:n,onlyFirstWithMeta:!0},zt.createElement(ab,{chatId:r,events:t.events,listItemHandlers:e.listItemHandlers}))}),u&&zt.createElement(om.u,null,zt.createElement(kv,null,b("embedded_waiting_for_operator")+"...")),n&&zt.createElement(Yv,{eventId:n.id,onSelect:this.listItemHandlers.handleActionButtonClick,replies:n.properties.quickReplies})),g&&zt.createElement(nb,null,g)),l&&zt.createElement(Qv,null,zt.createElement(lh,{onClick:p},b("embedded_greeting_accept"))),h&&zt.createElement(Qv,null,zt.createElement(lh,{onClick:v},b("embedded_start_chat_again"))),!l&&!h&&!o&&zt.createElement(Gv,{chatId:r,onBlur:this.handleInputBlur,onFocus:this.handleInputFocus,onSendMessage:this.handleSendMessage}))},t}(zt.Component),ob=Object(H.a)([function(e,t){return e.getTimeline(t)},f.y],function(e,t){return e.map(function(e){return Object(d.a)({},e,{authorData:t.getUser(e.author)})})})(function(e,t){return t}),cb=Mt(function(e,t){var n=t.id,r=function(){ar(e)},a=function(){or(n,e)},i=e.localize,o=function(t){return e.requestUpdateEvent(n,t,{seen:!0}).catch(f.N)},c=function(t,r){tr(e,n,t,r)},s=function(t,r){e.sendEvent(n,{type:"rich_message_postback",properties:{eventId:t,id:r,toggled:!0}})};return function(e){var t=e.getChat(n),u=t.ended,d=t.properties,l=d.agentIsTyping,p=d.queued,f=gn(n,e),m=e.getView("Chat").inputMode,h=e.getView("uploadList").ids,v=l&&f&&i("operator_is_typing",{operator:f.name});return{activeQuickReply:kn(n,e),timeline:ob(e,n,e.getState()),agent:f,ended:u,showAvatar:_n("agentAvatar",e).showWithMessage,focused:e.getApplicationState("focused"),markAsSeen:o,mobile:e.getApplicationState("mobile"),sendMessage:c,queued:p,reconnecting:Tn(e),requestPrechat:"requestPrechat"===m,sendPostback:s,showStartAgain:"startChatAgain"===m,showPrechat:r,uploadingFiles:h,uploading:h.length>0,localize:i,startChatAgain:a,typingText:v}}})(ib),sb=Object(om.V)("div",{displayName:"View",section:!0,target:"e1u2umur0"})("flex-grow:1;display:flex;height:100%;min-height:0;padding-bottom:1em;"),ub=Object(om.V)("div",{displayType:"ViewContent",target:"e1u2umur1"})("overflow-y:auto;height:100%;padding:",function(e){return e.noPadding?"0":"1em 1em 0 1em"},";flex-grow:1;"),db=Object(om.S)("&-enter,&-appear{opacity:0;}&-enter&-enter-active,&-appear&-appear-active{opacity:1;transition:opacity ",200,"ms ","cubic-bezier(0.33, 0, 0, 1)",";}&-exit{opacity:1;}&-exit&-exit-active{opacity:0;transition:opacity ",200,"ms ","cubic-bezier(0.335, 0.520, 0.000, 1.000)",";}"),lb=Object(om.S)("width:100%;"),pb=function(e){var t=e.children,n=e.fullWidth,r=void 0!==n&&n;return zt.createElement(sb,null,zt.createElement(km.TransitionGroup,{className:lb},zt.createElement(km.CSSTransition,{appear:!0,classNames:db,timeout:200},zt.createElement(ub,{noPadding:r},t))))},fb=Object(om.U)("50%{opacity:0.0;}"),mb=Object(om.S)("background:currentColor;opacity:0.3;animation:",fb," 1.5s linear 0s infinite;"),hb=Object(om.S)(mb,";"),vb=Object(om.V)("div",{target:"e1ot76cd0"})("width:",function(e){return e.width||"10em"},";height:1em;margin:0.3em;border-radius:3px;",mb,";"),bb=Object(om.V)("div",{target:"e1ot76cd1"})("width:100%;"),gb=Object(om.V)("div",{target:"e1ot76cd2"})("padding:1em;"),_b=Object(om.V)("div",{target:"e1ot76cd3"})("width:100%;margin-top:0.5em;"),yb=Object(om.V)("div",{displayName:"Message",section:!0,target:"e1ot76cd4"})(),jb=function(){return zt.createElement(bb,null,zt.createElement(om.a,null,zt.createElement(om.e,{className:hb,letter:" "})),zt.createElement(gb,null,zt.createElement(_b,null,zt.createElement(om.I,null,zt.createElement(yb,null,zt.createElement(om.f,null,zt.createElement(om.y,null,zt.createElement(vb,null),zt.createElement(vb,{width:"7em"})))))),zt.createElement(_b,null,zt.createElement(om.I,{reverse:!0},zt.createElement(yb,null,zt.createElement(om.f,null,zt.createElement(om.y,null,zt.createElement(vb,null)))))),zt.createElement(_b,null,zt.createElement(om.I,null,zt.createElement(yb,null,zt.createElement(om.f,null,zt.createElement(om.y,null,zt.createElement(vb,null))))))))},Ob=n(117),wb=n.n(Ob),xb=n(191),Cb=n.n(xb),Eb=Object(om.V)("div",{target:"e19zt9dk0"})("overflow-y:auto;"),Ib=Object(om.S)("color:#2046ff;transform:scale(0.6);"),Sb=Object(om.S)("background:#fff;display:flex;flex-direction:column;padding:1.8em;font-size:14px;"),Tb=Object(om.V)("div",{target:"e19zt9dk1"})(Sb,";padding:2em;text-align:center;"),kb=Object(om.V)("div",{target:"e19zt9dk2"})(Sb,";border-radius:8px;background-color:#fff;margin-bottom:0.8em;border:1px solid rgba(0,0,0,0.05);border-top:4px solid ",function(e){return e.color},";box-shadow:0 4px 15px rgba(0,0,0,0.1);&:hover{cursor:pointer;}"),Pb=Object(om.V)("div",{displayName:"ChatSummary",section:!0,target:"e19zt9dk3"})(Sb,";min-height:5.5em;display:flex;flex-direction:row;align-items:center;padding:1.2em;border-radius:8px;background-color:#fff;margin-bottom:1em;border:1px solid rgba(0,0,0,0.05);border-top:4px solid #2046ff;box-shadow:0 4px 15px rgba(0,0,0,0.1);&:hover{cursor:pointer;}"),Ab=Object(om.V)("div",{target:"e19zt9dk4"})("display:flex;align-items:left;background:rgba(255,255,255,0.2);margin-top:0.5em;border-radius:5px;padding:0.7em;border:1px solid #bcc6d0;justify-content:space-between;align-items:center;"),Nb=Object(om.V)("div",{target:"e19zt9dk5"})("flex-grow:1;margin-left:1em;"),Vb=Object(om.V)("img",{target:"e19zt9dk6"})("margin-bottom:1em;"),Mb=Object(om.V)("span",{target:"e19zt9dk7"})("opacity:0.5;"),zb=Object(om.V)("span",{target:"e19zt9dk8"})("font-weight:bold;font-size:1.2em;opacity:0.9;"),Rb=Object(om.V)("p",{target:"e19zt9dk9"})("font-weight:normal;"),Db=function(e){function t(){return e.apply(this,arguments)||this}return Object(Rt.a)(t,e),t.prototype.render=function(){var e=this.props,t=e.homeScreenData,n=e.showChat,r=e.setCurrentView,a=Object(l.a)(e,["homeScreenData","showChat","setCurrentView"]),i=Vn(70,a.invitationText||a.minimizedText);return zt.createElement(Eb,null,zt.createElement(Tb,null,zt.createElement("div",null,zt.createElement(Vb,{alt:"LiveChat Support",src:wb.a,srcSet:wb.a+" 1x, "+Cb.a+" 2x"})),zt.createElement(Rb,null,t.header)),zt.createElement(pb,null,t.iframePlugins.map(function(e){return zt.createElement(kb,{color:e.color,key:e.id,onClick:r(e.id)},zt.createElement(zb,null,e.label),e.button&&"search"===e.button.type&&zt.createElement(Ab,null,zt.createElement(Mb,null,e.button.placeholder),zt.createElement(om.J,{className:Ib})))}),zt.createElement(Pb,{onClick:n},a.avatar?zt.createElement(om.e,{imgUrl:a.avatar,noShrink:!0,size:"40px"}):zt.createElement(om.i,null),zt.createElement(Nb,null,i),a.unseenCount>0?zt.createElement(dm,null,a.unseenCount):null,zt.createElement(om.r,null,zt.createElement(om.c,null)))))},t}(zt.Component),qb=Mt(function(e){var t=function(){e.setCurrentView("Chat")},n=function(t){return function(){return e.setCurrentView(t)}};return function(r){var a,i=r.getApplicationState("config").features.homeScreen,o=Pn("liveChatChatId",e);return Object(d.a)({},o,{homeScreenData:i,showChat:t,setCurrentView:n,logoPath:(a=_n("logo",r).path,"https://"+O(a))})}})(Db),Lb=Object(om.V)("iframe",{target:"eiuzq7i0"})("border:0;width:100%;height:100%;"),Fb=Object(om.V)("div",{target:"eiuzq7i1"})("width:100%;height:100%;display:",function(e){return e.active?"flex":"none"},";"),Ub=function(e){var t=e.active,n=e.url,r=e.title;return zt.createElement(Fb,{active:t},zt.createElement(Lb,{src:n,title:r}))},Bb=Object(om.V)("div",{target:"e1ip35rm0"})("padding-top:2em;"),Gb=Object(om.S)("display:block;max-width:600px;margin:0 auto;"),Hb=function(e){function t(){return e.apply(this,arguments)||this}return Object(Rt.a)(t,e),t.prototype.render=function(){var e=this.props,t=e.currentView,n=e.defaultView,r=e.currentViewData,a=void 0===r?{}:r,i=e.sendForm,o=e.mobile,c=e.iframePlugins;return zt.createElement(Ut,null,function(e){return zt.createElement(zt.Fragment,null,"homeScreen"===t&&zt.createElement(qb,null),c.map(function(e){return zt.createElement(Ub,{active:t===e.id,key:e.id,title:e.name,url:e.url})}),"Chat"===t&&"timeline"===n&&zt.createElement(cb,{id:"liveChatChatId"}),"Chat"===t&&"loader"===n&&zt.createElement(pb,{fullWidth:!0},zt.createElement(jb,null)),"Chat"===t&&"prechat"===n&&zt.createElement(pb,null,zt.createElement(om.f,{className:Gb},zt.createElement(Bh,Object(d.a)({},a,{localize:e,mobile:o,onSubmit:i,stickySubmit:!0,submitLabel:e("prechat_submit_label")})))),"Chat"===t&&"postchat"===n&&zt.createElement(pb,null,zt.createElement(om.f,{className:Gb},zt.createElement(Bh,Object(d.a)({},a,{localize:e,mobile:o,onSubmit:i,stickySubmit:!0,submitLabel:e("submit")})))),"Chat"===t&&"offline"===n&&zt.createElement(pb,null,zt.createElement(om.f,{className:Gb},zt.createElement(Bh,Object(d.a)({},a,{localize:e,mobile:o,onSubmit:i,stickySubmit:!0,submitLabel:e("offline_form_submit_label")})))),"Chat"===t&&"information"===n&&zt.createElement(pb,null,zt.createElement(om.f,{className:Gb},zt.createElement(om.y,null,a.text))),"Chat"===t&&"queue"===n&&zt.createElement(pb,null,zt.createElement(om.f,{className:Gb},zt.createElement(Bb,null,zt.createElement(Wh,null,zt.createElement(om.p,null))),zt.createElement(Bh,Object(d.a)({},a,{hideSubmit:!0,localize:e,mobile:o,onSubmit:f.N,stickySubmit:!0,submitLabel:""})))))})},t}(zt.Component);Hb.propTypes={currentView:sm.string,currentViewData:sm.shape(),sendForm:sm.func},Hb.defaultProps={currentViewData:{}};var Wb=Mt(function(e){var t=function(t,n){if("prechat"===e.getEvent("liveChatChatId",t).properties.formType){var r=n.name,a=n.email,i=Object(f.d)({name:r,email:a});Object(f.B)(i)||e.updateUser(e.getSessionUser().id,i)}return e.requestUpdateEvent("liveChatChatId",t,{properties:{answers:n}})};return function(e){var n=e.getCurrentView(),r=e.getApplicationState("config").features.homeScreen,a=n&&e.getDefaultView(n);return{currentView:n,iframePlugins:r.iframePlugins,currentViewData:a&&e.getView(n+"."+a)||n&&e.getView(n),defaultView:a,sendForm:t,mobile:e.getApplicationState("mobile")}}})(Hb),Yb=Object(om.V)("div",{target:"e5cxvfk0"})("display:flex;justify-content:center;font-size:0.9em;"),Jb=Object(om.V)("p",{target:"errpamd0"})("text-align:center;"),Qb=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return(t=e.call.apply(e,[this].concat(r))||this).state={opened:!1,submitting:!1},t.showModal=function(){t.setState({opened:!0})},t.closeModal=function(){t.setState({opened:!1})},t.handleCloseClick=function(){t.setState({submitting:!0}),t.props.closeChat().then(function(){t.setState({submitting:!1}),t.closeModal()}).catch(function(){t.setState({submitting:!1})})},t}return Object(Rt.a)(t,e),t.prototype.render=function(){var e=this.props.localize,t=this.state.submitting;return zt.createElement(zt.Fragment,null,zt.createElement(Kh,{label:e("close_chat")},zt.createElement(om.r,{onClick:this.showModal},zt.createElement(om.l,null))),this.state.opened&&zt.createElement(qm,{onClose:this.closeModal},zt.createElement(Wh,null,zt.createElement(om.o,null)),zt.createElement(Jb,null,e("leave_chat_confirm")),zt.createElement(Yb,null,zt.createElement(lh,{destructive:!0,disabled:t,onClick:this.handleCloseClick},e("close_chat"),t&&"..."))))},t}(zt.Component),Kb=27,Xb=Object(om.V)("div",{target:"ex40w5s0"})("position:absolute;background:#fff;box-shadow:0 0.2em 0.8em rgba(0,0,0,0.2);border-radius:8px;margin-top:2.2em;margin-left:0.8em;overflow:hidden;min-width:180px;"),Zb=Object(om.V)("div",{target:"ex40w5s1"})("z-index:999;position:absolute;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0);"),$b=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return(t=e.call.apply(e,[this].concat(r))||this).handleKeyDown=function(e){e.keyCode===Kb&&t.props.onClose()},t.stopPropagation=function(e){return e.stopPropagation()},t}Object(Rt.a)(t,e);var n=t.prototype;return n.componentDidMount=function(){document.addEventListener("keydown",this.handleKeyDown)},n.componentWillUnmount=function(){document.removeEventListener("keydown",this.handleKeyDown)},n.render=function(){var e=this.props.onClose;return Ta.a.createPortal(zt.createElement(Zb,{onClick:e},zt.createElement(Xb,{onClick:this.stopPropagation},this.props.children)),document.getElementById("app-modal"))},t}(zt.Component);$b.defaultProps={onClose:f.N};var eg=$b,tg=n(24),ng=Object(om.V)("button",{target:"ejny03d0"})("background:transparent;font-family:inherit;font-size:14px;border:0;display:flex;align-items:center;padding:1.3em;width:100%;&:hover{cursor:pointer;}&:active,&:focus{outline:black solid 0px;}"),rg=Object(om.V)("p",{target:"e6vnhqa0"})("text-align:center;"),ag=Object(om.S)("width:1.4em;margin-right:0.5em;&:hover{opacity:0.6;}"),ig=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return(t=e.call.apply(e,[this].concat(r))||this).state={opened:!1},t.showModal=function(){t.setState({opened:!0})},t.closeModal=function(){t.setState({opened:!1}),t.props.onClose()},t.handleSubmit=function(e,n){return t.props.onSubmit(n.email).catch(function(){var e;return(e={})[tg.a]=t.props.localize("lost_connection"),e})},t}return Object(Rt.a)(t,e),t.prototype.render=function(){var e=this.props,t=e.disabled,n=e.email,r=e.localize,a=e.sent;return zt.createElement(zt.Fragment,null,zt.createElement(ng,{disabled:t,onClick:this.showModal},zt.createElement(om.n,{className:ag}),r("send_transcript")),this.state.opened&&zt.createElement(qm,{onClose:this.closeModal},a?zt.createElement(zt.Fragment,null,zt.createElement(Wh,null,zt.createElement(om.n,null)),zt.createElement(rg,{textWrap:!0},r("chat_transcript_sent").replace("%s",n)),zt.createElement(Yb,null,zt.createElement(lh,{capitalize:!0,onClick:this.closeModal},r("hide")))):zt.createElement(zt.Fragment,null,zt.createElement(Wh,null,zt.createElement(om.n,null)),zt.createElement(rg,null,r("send_transcript_to_email")),zt.createElement(Bh,{fields:[{name:"email",type:"email",required:!0,defaultValue:n}],id:"transcript",localize:r,noPadding:!0,onSubmit:this.handleSubmit,submitLabel:r("send")}))))},t}(zt.Component),og=Object(om.V)("ul",{target:"e1qbuf310"})("list-style-type:none;margin:0;padding:0;& >:last-child{border-bottom:0;}"),cg=Object(om.V)("li",{target:"e1qbuf311"})("display:flex;border-bottom:1px solid #e9eef4;pointer-events:",function(e){return e.disabled?"none":"auto"},";&:hover{background-color:#427fe1;color:#fff;cursor:pointer;& > *{color:#fff;}}"),sg=Object(om.S)("width:1.4em;margin-right:0.5em;&:hover{opacity:0.6;}"),ug=Object(om.S)("&-appear,&-enter{opacity:0;",og,"{transform:translate3d(0,20%,0);}}&-enter-active,&-appear-active{opacity:1;transition:opacity 100ms ease-in-out;",og,"{transform:translate3d(0,0%,0);transition:transform 200ms;}}&-exit{opacity:1;",og,"{transform:translate3d(0,0%,0);}}&-exit-active{opacity:0;transition:opacity 200ms ease-in-out;",og,"{transform:translate3d(0,20%,0);transition:transform 200ms;}}"),dg=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return(t=e.call.apply(e,[this].concat(r))||this).state={opened:!1},t.showMenu=function(){t.setState({opened:!0})},t.closeMenu=function(){t.setState({opened:!1})},t.handleTranscriptEmail=function(e){return t.closeMenu(),t.props.sendTranscript(e)},t}return Object(Rt.a)(t,e),t.prototype.render=function(){var e=this.props,t=e.muted,n=e.transcriptSentTo,r=e.enableTranscript,a=e.localize,i=e.showTranscript,o=e.toggleSounds,c=e.customerEmail,s=!!n;return zt.createElement(zt.Fragment,null,zt.createElement(Kh,{label:a("theme_options")},zt.createElement(om.r,{onClick:this.showMenu},zt.createElement(om.s,null))),this.state.opened&&zt.createElement(km.TransitionGroup,null,zt.createElement(km.CSSTransition,{appear:!0,classNames:ug,timeout:200},zt.createElement(eg,{onClose:this.closeMenu},zt.createElement(og,null,i&&zt.createElement(cg,{disabled:!r},zt.createElement(ig,{disabled:!r,email:s?n:c,localize:a,onClose:this.closeMenu,onSubmit:this.handleTranscriptEmail,sent:s})),zt.createElement(cg,null,zt.createElement(ng,{onClick:o},t?zt.createElement(om.R,{className:sg}):zt.createElement(om.B,{className:sg}),a(t?"unmute":"mute"))))))))},t}(zt.Component),lg=Mt(function(e){var t=function(t){return e.requestUpdateChat("liveChatChatId",{properties:{transcriptSentTo:t}})},n=function(){e.setApplicationState({muted:!e.getApplicationState("muted")})};return function(e){var r=e.getChat("liveChatChatId"),a=r.active,i=r.properties,o=i.transcriptSentTo;return{muted:e.getApplicationState("muted"),sendTranscript:t,transcriptSentTo:o,enableTranscript:a||i.ended,showTranscript:_n("emailTranscript",e).enabled,toggleSounds:n,customerEmail:e.getSessionUser().email}}})(dg),pg=function(e){return Object(om.S)("flex-grow:0;text-align:left;padding:0 0.8em;font-weight:700;display:flex;align-items:stretch;transition:0.3s background-color;",e&&"\n\t\tbackground-color: "+e+";\n\t\tcolor: "+(Nn(e)?"inherit":"#fff")+";\n\t",";")},fg=Object(om.V)("div",{displayName:"IconPlaceholder",target:"e7bf83j0"})("width:25px;"),mg=function(e){return Object(f.X)(e-1).map(function(e){return zt.createElement(fg,{key:"placeholder_"+e})})},hg=function(e){function t(){return e.apply(this,arguments)||this}return Object(Rt.a)(t,e),t.prototype.render=function(){var e=this.props,t=e.showCloseButton,n=e.closeChat,r=e.localize,a=e.showMinimizedButton,i=e.showBackButton,o=e.showHomeScreen,c=e.title,s=e.backgroundColor,u=e.onMinimize,d=function(e,t){var n=e.filter(Boolean),r=t.filter(Boolean);return n.length===r.length?{leftIcons:n,rightIcons:r}:n.length>r.length?{leftIcons:n,rightIcons:mg(n.length-r.length).concat(r)}:{leftIcons:n.concat(mg(r.length-n.length)),rightIcons:r}}([i&&zt.createElement(Kh,{key:"back",label:"Back"},zt.createElement(om.r,{onClick:o},zt.createElement(om.b,null))),zt.createElement(lg,{key:"menu",localize:r})],[a&&zt.createElement(Kh,{key:"minimize",label:r("embedded_minimize_window")},zt.createElement(om.r,{onClick:u},zt.createElement(om.A,null))),t&&zt.createElement(Qb,{closeChat:n,key:"close",localize:r})]),l=d.leftIcons,p=d.rightIcons;return zt.createElement(om.Q,{className:pg(s),leftIcons:l,noShrink:!0,rightIcons:p,title:c})},t}(zt.Component);hg.propTypes={minimize:sm.func,showCloseButton:sm.bool};var vg,bg,gg=Mt(function(e){var t=function(){return e.requestUpdateChat("liveChatChatId",{active:!1})},n=e.getApplicationState("embedded"),r=function(){e.setCurrentView("homeScreen")};return function(e){var a=e.getCurrentView(),i=e.getView(a);return{showBackButton:_n("homeScreen",e).enabled&&"homeScreen"!==a,embedded:n,closeChat:t,showHomeScreen:r,title:Object(f.v)(e.localize("welcome_title"),"title",i),backgroundColor:Object(f.u)("titleBarColor",i),showCloseButton:e.getChat("liveChatChatId").active&&"Chat"===e.getCurrentView(),localize:e.localize}}})(hg),_g=Object(om.V)("div",{displayName:"Footer",target:"egii5nj0"})("position:absolute;right:0;bottom:0;font-size:0.6em;color:#fff;text-align:right;padding:0em 2em 1.5em 1em;text-shadow:0 0.1rem 0.6rem rgba(0,0,0,0.7);"),yg=Object(om.V)("a",{target:"egii5nj1"})("text-decoration:none;color:inherit;font-weight:bold;visibility:",function(e){return e.hidden?"hidden":"inherit"},";"),jg=document.referrer&&O(b(document.referrer)),Og=function(e){function t(){return e.apply(this,arguments)||this}return Object(Rt.a)(t,e),t.prototype.render=function(){var e=jg||"lc"+this.props.license;return zt.createElement(_g,null,zt.createElement(yg,{hidden:this.props.hidden,href:"https://www.livechatinc.com/powered-by-livechat/?partner="+e+"&utm_source=chat_window&utm_medium=referral&utm_campaign="+e,rel:"noreferrer",target:"blank"},this.props.children))},t}(zt.PureComponent),wg=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return t.forEach(function(e){e.apply(void 0,n)})}},xg=Object(om.V)("div",{displayName:"Maximized",target:"e903lsu0"})("display:flex;flex-direction:column;min-width:0;height:100%;box-shadow:0 0.2em 1em rgba(0,0,0,0.25);overflow:hidden;background:#fff;",function(e){return{borderRadius:e.mobile||!e.embedded?"0":"10px"}},";& > *{will-change:tranform,opacity;backface-visibility:hidden;}"),Cg=Object(om.S)("&-enter{opacity:0;transform:translate3d(0,100%,0);}&-enter&-enter-active{opacity:1;transform:translate3d(0,0%,0);transition:opacity 140ms ease 200ms,transform 140ms ease 200ms;}&-exit{opacity:1;transform:translate3d(0,0%,0);}&-exit&-exit-active{opacity:0;transform:translate3d(0,100%,0);transition:opacity 140ms ease,transform 140ms ease;}"),Eg=Object(om.V)("div",{displayName:"ApplicationWrapper",target:"e903lsu1"})("position:absolute;top:0;left:auto;right:0;bottom:0;width:100%;height:100%;will-change:tranform,opacity;backface-visibility:hidden;"),Ig=Object(om.S)("position:relative;height:100%;"),Sg=Object(om.S)("z-index:100;"),Tg=Mt(function(e,t){var n=function(t){e.setApplicationState({maximized:t})};return function(e){var r=e.getApplicationState("mobile");return Object(d.a)({},t,{mobile:r,embedded:e.getApplicationState("embedded"),maximized:e.getApplicationState("maximized"),setMaximizedState:n,license:e.getApplicationState("license"),hideTrademark:_n("hideTrademark",e).enabled,showMinimized:r?_n("mobileMinimized",e).enabled:_n("minimized",e).enabled,screenPosition:En(e),rtl:e.getApplicationState("rtl")})}})((bg=vg=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return(t=e.call.apply(e,[this].concat(r))||this).enhanceToggle=function(e){return wg(t.props.embedded?e:f.N,t.props.onClick)},t.handleAnimationEnd=function(){t.props.onAnimationEnd()},t}return Object(Rt.a)(t,e),t.prototype.render=function(){var e=this,t=this.props.rtl?"rtl":"ltr";return zt.createElement(um.a,{on:this.props.maximized,onToggle:this.props.setMaximizedState},function(n){var r,a=n.on,i=n.toggle,o=e.enhanceToggle(i);return zt.createElement(km.TransitionGroup,null,a&&zt.createElement(km.CSSTransition,{classNames:(r=e.props.screenPosition,Object(om.S)("&-enter{transform:translate3d(","right"===r?"":"-","40%,40%,0) scale(0.1);",xg," > *{opacity:0;transform:translate3d(0,20%,0);}}&-enter&-enter-active{transform:translate3d(0%,0%,0) scale(1);transition:transform ",430,"ms ","cubic-bezier(0.33, 0, 0, 1)",";",xg," > *{opacity:1;transform:translate3d(0,0%,0);transition:opacity 160ms ","cubic-bezier(0.33, 0, 0, 1)"," 270ms,transform 160ms ","cubic-bezier(0.33, 0, 0, 1)"," 270ms;}}&-exit{transform:translate3d(0%,0%,0) scale(1);opacity:1;",xg," > *{opacity:1;transform:translate3d(0,0%,0);}}&-exit&-exit-active{opacity:0;transform:translate3d(","right"===r?"":"-","40%,40%,0) scale(0.1);transition:transform ",430,"ms ","cubic-bezier(0.335, 0.520, 0.000, 1.000)",",opacity 300ms ease;",xg," > *{opacity:0;transform:translate3d(0,10%,0);transition:opacity 160ms ","cubic-bezier(0.335, 0.520, 0.000, 1.000)",",transform 160ms ","cubic-bezier(0.335, 0.520, 0.000, 1.000)",";}}")),onExited:e.handleAnimationEnd,timeout:430},zt.createElement(Eg,{dir:t,expandToEdge:e.props.mobile||!e.props.embedded},zt.createElement("div",{className:Ig},zt.createElement(xg,{embedded:e.props.embedded,mobile:e.props.mobile},zt.createElement("div",{className:Sg,id:"app-modal"}),zt.createElement(gg,{onMinimize:o,showMinimizedButton:e.props.showMinimizedButton}),zt.createElement(Wb,null),!e.props.mobile&&zt.createElement(Og,{hidden:e.props.hideTrademark,license:e.props.license},"Powered by LiveChat"))))),!a&&e.props.showMinimized&&zt.createElement(km.CSSTransition,{classNames:Cg,onExited:e.handleAnimationEnd,timeout:430},zt.createElement(wm,{dir:t,innerRef:e.props.onMinimizedRef,onMaximize:o,onResize:e.props.onMinimizedResize})))})},t}(zt.Component),vg.propTypes={maximized:sm.bool.isRequired,onAnimationEnd:sm.func,onClick:sm.func,setMaximizedState:sm.func.isRequired},vg.defaultProps={onAnimationEnd:f.N,onClick:f.N},bg)),kg=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return(t=e.call.apply(e,[this].concat(r))||this).state={crashed:!1},t}Object(Rt.a)(t,e);var n=t.prototype;return n.componentDidCatch=function(e,t){this.setState({crashed:!0}),this.props.onError(e,t)},n.render=function(){return this.state.crashed?null:this.props.children},t}(zt.Component);kg.defaultProps={onError:f.N};var Pg={vars:{"secondary-color":"#ffffff","tertiary-color":"#E9EEF4"},ApplicationWrapper:{css:{padding:{default:"1em 1em 2em 1em",expandToEdge:"0"}}},AgentBar:{Avatar:{size:"40px"},IconButton:{active:{Icon:{color:"#fff"}},css:{background:{default:"var(--tertiary-color)",active:"var(--primary-color)"},borderRadius:"50%",width:"40px",height:"40px",textAlign:"center",display:"flex",justifyContent:"center",alignItems:"center",opacity:{default:"1",disabled:"0.15"}}},Title:{css:{fontSize:".9em",fontWeight:"bold"}},SubTitle:{css:{fontSize:"0.9em",opacity:"1"}},css:{backgroundColor:"#fff",zIndex:"1",color:"#424d57",padding:"1.2em"}},Avatar:{size:"20px",css:{border:0}},Bubble:{sharpBorderRadius:"6px",ovalBorderRadius:"6px",css:{boxShadow:"0 1px 2px rgba(0, 0, 0, 0.1)",border:"0"}},Button:{css:{backgroundColor:{destructive:"#EB4736"}}},IconButton:{css:{padding:"0 .5em"}},Footer:{css:{position:"absolute",bottom:"-3.5em"}},Form:{IconButton:{css:{color:{default:"#8f8f8f",active:"#000"},backgroundColor:"#ececec"}}},MessageButtons:{css:{color:"#3e7ce4"}},MessageText:{css:{fontSize:"14px"}},MessageList:{css:{position:"absolute",top:"0",bottom:"0",left:"0",right:"0"}},Message:{css:{animation:{default:"none",sending:Object(om.U)("100%{opacity:0.3;}")+" 2s 2s forwards"},width:{system:"100%"},display:{system:"block"},opacity:{default:"1",failed:"0.7"},color:"#424d57"},Bubble:{sharpBorderRadius:"6px",ovalBorderRadius:"6px",css:{boxShadow:"0 1px 2px rgba(0, 0, 0, 0.1)",border:"0"}},system:{Bubble:{css:{background:"transparent",textAlign:"center",border:"0",width:"100%",boxShadow:"none"}},MessageText:{css:{padding:"0 1em"}}},fullWidth:{Content:{css:{width:"100%"}}}},MinimizedBar:{Icon:{color:"var(--primary-color)"},css:{position:"relative"}},MinimizedBubble:{Icon:{color:"#fff"},css:{position:"relative",background:{default:"var(--primary-color)",hasAvatar:"transparent"}}},Minimized:{Avatar:{css:{border:"0",backgroundColor:"transparent"}}},Invitation:{IconButton:{css:{visibility:{default:"hidden",mobile:"visible"}}},Bubble:{sharpBorderRadius:"6px",ovalBorderRadius:"6px",css:{border:"0"}}},TitleBar:{css:{backgroundColor:"#fff",color:"#424d57",fontWeight:"700!important",fontSize:"1em",textAlign:"center",height:"50px"}},TextComposer:{css:{fontSize:{default:"14px",mobile:"16px"},padding:"1em",boxShadow:"0 -1em 1em rgba(0, 0, 0, 0.03)",zIndex:"1",background:{disabled:"#fdedd3"}},TextInput:{css:{background:{disabled:"#fdedd3"}}}},View:{css:{color:"#424d57"},Bubble:{sharpBorderRadius:"6px",ovalBorderRadius:"6px",css:{boxShadow:"0 1px 2px rgba(0, 0, 0, 0.1)",border:"0"}}}},Ag={TitleBar:{css:{fontWeight:"700!important",fontSize:"1.1em",textAlign:"center!important",height:"46px",justifyContent:"flex-start"}},IconButton:{css:{padding:"0 .5em"}},MessageList:{css:{backgroundColor:"#fff"}},Maximized:{css:{borderRadius:"3px 3px 0 0"}},Footer:{css:{position:"relative",backgroundColor:"#f5f5f5",textShadow:"none",color:"#b4b4b4",padding:"1em"}},ApplicationWrapper:{css:{padding:{default:"1em 1em 0 1em",expandToEdge:"0"}}},AgentBar:{css:{padding:"0.6em"},Avatar:{size:"60px",css:{borderRadius:"0"}},SubTitle:{css:{fontSize:".8em"}},Title:{css:{fontSize:"1em",fontWeight:"bold"}},IconButton:{css:{color:{default:"inherit"},opacity:{default:"0.3",disabled:"0.15",active:"0.6"},padding:"0 1em 0 0"}}},Button:{css:{backgroundColor:{default:"#aecf5f",destructive:"#EB4736"},boxShadow:"0 2px 0 rgba(0, 0, 0, .1), inset 0 -3px 0 rgba(129, 163, 48, .3)"}},Message:{own:{Content:{css:{alignItems:"flex-start"}}},system:{MessageText:{css:{fontSize:".9em",opacity:"0.6"}}},css:{flexDirection:"row"},Status:{css:{opacity:"0.6"}},Bubble:{sharpBorderRadius:"0px",ovalBorderRadius:"0px",css:{border:"0",padding:"0",background:"transparent",boxShadow:"none"}},MessageButtons:{css:{borderRadius:"6px !important",overflow:"hidden",border:"1px solid rgba(0, 0, 0, 0.2)"}},Button:{css:{borderTop:"0!important"}}},MessageText:{css:{padding:"0",fontSize:"14px"}},MessageGroup:{css:{marginBottom:".5em"}},MinimizedBar:{css:{borderRadius:"3px 3px 0 0",height:"40px"},Icon:{css:{transform:"scale(0.8)"}}},View:{Bubble:{css:{border:"0",padding:"0",background:"transparent",boxShadow:"none"}},ViewContent:{css:{paddingTop:".5em"}},css:{paddingBottom:"0"}},TextInput:{css:{lineHeight:"1.1em"}},MessageMeta:{css:{opacity:"0.6"}},Form:{css:{fontSize:"0.9em"},IconButton:{css:{color:{default:"#8f8f8f",active:"#000"},backgroundColor:"#ececec"}}},Tooltip:{css:{padding:"0.5em 0.8em",fontSize:".7em"}},TooltipArrow:{css:{marginTop:"-1em"}},IconPlaceholder:{css:{width:"0"}},Invitation:{Bubble:{sharpBorderRadius:"6px",ovalBorderRadius:"6px",css:{padding:".5em"}}},InformationField:{css:{fontSize:"1.1em"}}},Ng=function(e){function t(t){var n;(n=e.call(this,t)||this).id="widget-global-"+Object(f.s)(),Object(om.T)("#",n.id,"{font-family:'Noto Sans',sans-serif;}#",n.id," *{box-sizing:border-box;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;-webkit-tap-highlight-color:transparent;}#",n.id," p{margin:1em 0;}");var r="https://fonts.googleapis.com/css?family=Noto+Sans:400,700&subset=latin-ext",a=document.querySelector("head"),i=a.querySelectorAll("link");if(Object(f.k)(function(e){return e.href===r},i))return Object(im.a)(n);var o=document.createElement("link");return o.setAttribute("href",r),o.setAttribute("rel","stylesheet"),a.appendChild(o),n}return Object(Rt.a)(t,e),t.prototype.render=function(){return zt.createElement("div",{id:this.id},this.props.children)},t}(zt.Component),Vg=function(e,t){var n=t.store,r=t.onError,a=Object(l.a)(t,["store","onError"]);Sa.render(zt.createElement(kg,{onError:r},zt.createElement(Bt,{store:n},zt.createElement(cm,{prop:"theme"},function(e){return zt.createElement(Ng,null,zt.createElement(om.O,{theme:Object(f.L)((t=e.name,"modern"===t?Ag:Pg),e)},zt.createElement(Tg,a)));var t}))),e)};var Mg=_(window.location.search),zg=parseInt(function(){var e=String(window.location).match(/licen(?:s|c)e\/g?(\d+)/);return e?e[1]:null}()||Mg.license,10),Rg=function(e){if(Object(f.x)("group",e)){var t=parseInt(e.group,10);if(t>-1)return t}if(Object(f.x)("groups",e)){var n=parseInt(e.groups,10);if(n>-1)return n}return null}(Mg),Dg="1"===Mg.unique_groups;if(!zg)throw new Error("No license found in the URL.");var qg=zg+(Dg?":"+Rg:"")+":state";!function(){var e=tn({application:{license:zg,group:Rg}},{persistKey:qg});(Mg.embedded?ha:function(e,t){var n=t.license,r=t.group,a=t.uniqueGroups;return e.on("protocol_upgraded",function(){window.location.reload()}),e.setApplicationState({embedded:!1,maximized:!0,page:{title:document.title,url:String(document.location),referrer:document.referrer}}),e.updateUser(e.getSessionUser().id,Ea()),window.performance&&"function"===typeof window.performance.mark&&window.performance.mark("lc_config_request"),Ca({license:n,group:r,uniqueGroups:a}).then(function(t){window.performance&&"function"===typeof window.performance.mark&&window.performance.mark("lc_server_config");var r=t.visitor.groups,i=t.region;e.setApplicationState({group:r,rtl:fa(t)});var o=e.getApplicationState("mobile"),c={data:{license:n,group:r,uniqueGroups:a,region:i,mobile:o},props:{}};return ya()&&(c.props.onClick=function(){return e.emit("mobile_wrapper_minimize_intent")},c.props.showMinimizedButton=!0),[c,t]})})(e,{license:zg,group:Rg,uniqueGroups:Dg}).then(function(t){return function(e,t,n,r){var a=t.data,i=t.props,o=i.onError,c=void 0===o?f.N:o,s=Object(l.a)(i,["onError"]),u=t.onBootstrap,p=void 0===u?f.N:u;return new Promise(function(t){("3"===n.license_properties.lc_version?zf:Hl)(a,e,n),e.on("set_application_state",function n(a){if(a.ready){window.performance&&"function"===typeof window.performance.mark&&window.performance.mark("lc_sdk_ready"),e.off("set_application_state",n),am(e),ja(e),Df(e,r);var i=document.getElementById("root");Vg(i,Object(d.a)({},s,{onError:function(e,t){var n=t.componentStack;x("react_error",e,"componentStack",n),Sa.render(null,i),c()},store:e})),window.performance&&"function"===typeof window.performance.mark&&window.performance.mark("lc_bootstrap_end"),p(),t()}})})}.apply(void 0,[e].concat(t))})}()}},[[277,2,1]]]);